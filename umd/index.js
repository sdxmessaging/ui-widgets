/* @preserve built on: 2021-11-15T10:47:57.591Z */
(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?t(exports,require("lodash"),require("mithril"),require("luxon"),require("mithril/stream"),require("signature_pad")):typeof define==="function"&&define.amd?define(["exports","lodash","mithril","luxon","mithril/stream","signature_pad"],t):(e=typeof globalThis!=="undefined"?globalThis:e||self,t(e.uiWidgets={},e._,e.m,e.luxon,e.m.stream,e.SignaturePad))})(this,(function(e,t,a,l,n,s){"use strict";function i(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}var r=i(t);var u=i(a);var d=i(n);var c=i(s);const o={layoutType:"default",imageMaxSize:1280,imageDispHeight:"16rem",thumbDispHeight:"6rem",addFileTxt:"Upload...",addFilesTxt:"Add file(s)...",remFileTtl:"Remove",openFileTxt:"Open file",showPassTxt:"Show Password",requiredLblPost:"",signOpts:[{label:"",value:"draw"},{label:"",value:"type"},{label:"",value:"stamp"}],signMaxSize:640,signHeightPct:25,signFont:"sans-serif",signDrawTxt:"Draw",signTypeTxt:"Type",signStampTxt:"Accept",stampTxt:"Accept",stampBtnClass:"",stampBtnContext:"default",stampSetTxt:"Accepted",applyTtl:"Apply",resetTtl:"Reset",cancelTtl:"Cancel",drawIcn:"fas fa-signature",typeIcn:"fas fa-keyboard",stampIcn:"fas fa-check",applyIcn:"fas fa-check",resetIcn:"fas fa-eraser",cancelIcn:"fas fa-times",checkIcn:"far fa-check-square",uncheckIcn:"far fa-square",toggleOnIcn:"fas fa-toggle-on",toggleOffIcn:"fas fa-toggle-off",showPassIcn:"fas fa-eye",hidePassIcn:"fas fa-eye-slash",uploadIcn:"fas fa-file-upload",downloadIcn:"fas fa-file-download",deleteIcn:"fas fa-trash-alt",cameraIcn:"fas fa-camera",imageIcn:"fas fa-image",emailIcn:"fas fa-envelope",telIcn:"fas fa-phone",linkIcn:"fas fa-link",wordDocIcn:"fas fa-file-word",videoFileIcn:"fas fa-file-video",pdfFileIcn:"fas fa-file-pdf",musicFileIcn:"fas fa-file-audio",excelFileIcn:"fas fa-file-excel",fileIcn:"fas fa-file",codeFileIcn:"fas fa-file-code"};const f=o;function p(e){r["default"].assign(o,e)}function h(){return{"max-height":f.imageDispHeight}}function m(){return{"max-height":f.thumbDispHeight}}const g={wrapper:"",label:"silver",inputWrapper:"ba br2 b--silver pa2 ma0 dark-gray",input:"dark-gray fw2",button:"pa2 bn br2",navButton:"dark-gray",textarea:"dark-gray fw2",radio:"dark-gray pa2 br2",radioChecked:"bg-light-blue",radioUnchecked:"o-60",fileInputWrapper:"ba bw1 br3 b--black-30 b--dashed dark-gray",fileHover:"blue b--blue",displayLabel:"silver",displayValue:"dark-gray",requiredLabel:"",disabledWrapper:"o-40",invalidInputWrapper:"ba b--red"};const b=g;function v(e){r["default"].assign(g,e)}const y={default:"bg-light-blue dark-gray"};function x(e){r["default"].assign(y,e)}function w(e="default"){if(e&&e in y){return y[e]}else{return""}}function I({wrapper:e="",merge:t=true},a){return`${e} ${t?b.wrapper:""} ${a?b.disabledWrapper:""}`}function $({label:e="",merge:t=true},a){return`${e} ${t?b.label:""} ${a?b.requiredLabel:""}`}function k({inputWrapper:e="",merge:t=true},a){return`${e} ${t?b.inputWrapper:""} ${a?b.invalidInputWrapper:""}`}function T({input:e="",merge:t=true}){return`${e} ${t?b.input:""}`}function S(e,t,a){return`${T(e)} ${F(t,a)}`}function C({input:e="",merge:t=true}){return`${e} ${t?b.textarea:""}`}function P({input:e="",merge:t=true},a,l,n){return`${e} ${t?b.radio:""} ${a?b.radioChecked:b.radioUnchecked} ${F(l,n)}`}function q(e){return`${e?b.fileHover:""}`}function D({inputWrapper:e="",merge:t=true},a,l){return`${e} ${t?b.fileInputWrapper:""} ${l?b.invalidInputWrapper:""} ${q(a)}`}function F(e,t){return e||t?"":"pointer"}function U(e){return(e+256).toString(16).substr(1)}function O(){const e=new Uint8Array(16);const t=window.crypto;t.getRandomValues(e);return[U(e[0]),U(e[1]),U(e[2]),U(e[3]),"-",U(e[4]),U(e[5]),"-",U(e[6]),U(e[7]),"-",U(e[8]),U(e[9]),"-",U(e[10]),U(e[11]),U(e[12]),U(e[13]),U(e[14]),U(e[15])].join("")}function B(){return Math.max(window.devicePixelRatio,1)}function A(e,t){return t?`${e}${f.requiredLblPost}`:e}function L(e,t){return t?t:e}function W(e){return e?u["default"]("span.mr2.truncate",{title:e,class:b.displayLabel},e):null}function M(e,t,a,l){return a?u["default"]("label.mb1.db",{title:a,for:e,class:$(t,l)},A(a,l)):null}function H(e,t,a){return[e?u["default"]("i.fa-fw",{class:`${t?"mr2":""} ${e}`}):null,t,a?u["default"]("i.fa-fw",{class:`${t?"ml2":""} ${a}`}):null]}function R(e){return function({target:{value:t}}){e(t)}}function z(e){return function({target:{checked:t}}){e(t)}}function N(e){switch(e){case"day":return"dd";case"month":return"mm";case"year":return"yyyy"}}function j(e,t,a){const l=e.querySelector(`#${t}-${a}`);l.focus()}function V(e,t,a){if(e!==t()){const l=e.querySelector("input");_(l,a,"Invalid Date");t(e)}}function _(e,t,a){t.map(t=>{const l=t?"":`${a}`;e.setCustomValidity(l)})}function E(e,t,a,l,n){const s=parseInt(t.getAttribute("maxlength"));if(l.length===s&&a){const t=n.querySelector(`#${e}-${a}`);t.focus();t.select()}}function Y(e,t,a,l,n){const s=l.querySelector(`#${e}-${t}`);if((n.key==="Backspace"||n.key==="Delete")&&a.length===0&&s){s.focus();s.select();n.preventDefault()}}function Z(e){const t=e();if(t.length===1)e(`0${t}`)}function G(e,t,a,n){const s=l.DateTime.fromObject({year:Number(e),month:Number(t),day:Number(a)});const i=!e&&!t&&!a;return s.isValid&&Number(e)>=1900||i&&!n}function J(e,t,a){const l=!e&&!t;return t.length===2&&Number(t)<=12&&Number(t)>0&&e.length===2||l&&!a}function K(e,t,a,l,n){const s=l.querySelector(`#${t}-${a}`);const i=e()?e():"";const r=s.value;const u=/^\d*$/.test(r);if((u||r==="")&&r.length<=4){e(r)}else{e(i)}E(t,s,n,e(),l)}function Q(e){const t=e.lastIndexOf(".");if(t===-1){return[e,""]}else{return[e.substr(0,t),e.substr(t)]}}function X(e){const t=e.split(",");const a=t[0].indexOf("base64")>=0?atob(t[1]):unescape(t[1]);const l=t[0].split(":")[1].split(";")[0];const n=a.length;const s=new Uint8Array(n);for(let e=0;e<n;e++){s[e]=a.charCodeAt(e)}return new Blob([s],{type:l})}function ee(e,t){const a=(new Date).valueOf();const l=e;l.name=t;l.lastModified=a;return e}function te(e,t,a){const l=ee(X(e),t);return{guid:O(),name:l.name,path:"not_set",file:l,dataUrl:e,metadata:a}}function ae(e){const[,t]=Q(e.name);switch(t.toLowerCase()){case".doc":case".docx":case".dot":case".wbk":case".docm":case".dotx":case".dotm":case".docb":case".txt":return f.wordDocIcn;case".webm":case".mkv":case".flv":case".vob":case".ogv":case".drc":case".gifv":case".mng":case".avi":case".mts":case".m2ts":case".mov":case".qt":case".wmv":case".yuv":case".rm":case".rmvb":case".viv":case".asf":case".amv":case".mp4":case".m4p":case".m4v":case".mpg":case".mp2":case".mpeg":case".mpe":case".mpv":case".m2v":case".svi":case".3gp":case".mxf":case".roq":case".nsv":case".f4v":case".f4p":case".f4a":case".f4b":return f.videoFileIcn;case".pdf":return f.pdfFileIcn;case".pcm":case".wav":case".aiff":case".mp3":case".aac":case".ogg":case".wma":case".flac":case".alac":return f.musicFileIcn;case".xls":case".xlt":case".xlm":case".xlsx":case".xlsm":case".xltx":case".xltm":case".xlsb":case".xla":case".xlam":case".xll":case".xlw":return f.excelFileIcn;case".html":case".js":case".css":case".scss":case".java":return f.codeFileIcn;case".jpg":case".jpeg":case".png":case".tiff":case".gif":case".svg":case".webp":return f.imageIcn;default:return f.fileIcn}}function le(e){return e&&e.includes("image")}function ne(e){const t=Math.min(e.byteLength,64*1024);const a=new DataView(e,0,t);if(a.getUint16(0,false)!==65496){return-2}const l=a.byteLength;let n=2;while(n<l){const e=a.getUint16(n,false);n+=2;if(e===65505){n+=2;if(a.getUint32(n,false)!==1165519206){return-1}n+=6;const e=a.getUint16(n,false)===18761;n+=a.getUint32(n+4,e);const t=a.getUint16(n,e);n+=2;for(let l=0;l<t;l++){if(a.getUint16(n+l*12,e)===274){return a.getUint16(n+l*12+8,e)}}}else if((e&65280)!==65280){break}else{n+=a.getUint16(n,false)}}return-1}function se(e){return new Promise(t=>{const a=new FileReader;a.onload=()=>{t(a.result)};a.readAsArrayBuffer(e)})}function ie(e){return se(e).then(ne)}function re(e,t,a,l){if(!l||l>8){return}switch(l){case 2:e.translate(t,0);e.scale(-1,1);return;case 3:e.translate(t,a);e.rotate(Math.PI);return;case 4:e.translate(0,a);e.scale(1,-1);return;case 5:e.rotate(.5*Math.PI);e.scale(1,-1);return;case 6:e.rotate(.5*Math.PI);e.translate(0,-a);return;case 7:e.rotate(.5*Math.PI);e.translate(t,-a);e.scale(-1,1);return;case 8:e.rotate(-.5*Math.PI);e.translate(-t,0);return}}function ue(e,t,a){if(e>t){if(e>a){return[a,Math.round(t*a/e)]}}else if(t>a){return[Math.round(e*a/t),a]}return[e,t]}function de(e,t,a){if(!e.type.match(/image.*/)){return Promise.reject(new Error("File must be an image"))}return ie(e).then(l=>new Promise(n=>{const s=new Image;s.onload=()=>{const e=document.createElement("canvas");const[i,r]=ue(s.width,s.height,t);if(l>4){e.width=r;e.height=i}else{e.width=i;e.height=r}const u=e.getContext("2d");re(u,i,r,l);u.drawImage(s,0,0,i,r);n(e.toDataURL(a))};const i=new FileReader;i.onload=()=>s.src=i.result;i.readAsDataURL(e)}))}function ce(e,t){return new Promise(a=>{const l=new Image;l.onload=()=>{const e=document.createElement("canvas");const[n,s]=ue(l.width,l.height,t);e.width=n;e.height=s;const i=e.getContext("2d");i.drawImage(l,0,0,n,s);a(e.toDataURL())};l.src=e})}function oe(e,t,a,l){const n=document.createElement("canvas");n.width=t;n.height=a;const s=.56*n.height;const i=n.getContext("2d");i.textBaseline="middle";i.font=`${s}px ${l}`;i.fillText(e,n.height*.05,s);return n.toDataURL()}function fe(e,t){const a=f.signMaxSize;const l=.01*t*a;return oe(e,a,l,f.signFont)}class pe{view({attrs:{label:e,classes:t="bg-red"},children:a}){return u["default"](".relative.dib",[a,e?u["default"]("span.absolute.ph1.nt1.nr1.top-0.right-0.br-pill.tc.f5.white.o-80",{class:t,style:{minWidth:"0.65rem"}},e):null])}}class he{view({attrs:{label:e,type:t="button",title:a=e,icon:l,rightIcon:n,context:s,classes:i="",style:r,disabled:d,onclick:c}}){return u["default"]("button.button-reset",{type:t,title:a,disabled:d,class:`${i} ${d?b.disabledWrapper:"pointer"} ${w(s)} ${b.button}`,style:r,onclick:c},H(l,e,n))}}class me{view({attrs:{label:e,title:t=e,icon:a,rightIcon:l,href:n,rel:s,target:i,download:r,context:d,classes:c="",style:o}}){return u["default"]("a.link.flex.items-center",{href:n,rel:s,target:i,download:r,title:t,class:`${c} ${w(d)} ${b.button}`,style:o},H(a,e,l))}}class ge{view({attrs:{label:e,title:t=e,icon:a,rightIcon:l,classes:n="",style:s,disabled:i,onclick:r}}){return u["default"](".mh2.pa2.truncate",{title:t,disabled:i,class:`${n} ${i?b.disabledWrapper:"pointer"} ${b.navButton}`,style:s,onclick:r},H(a,e,l))}}class be{view({attrs:{label:e,title:t=e,icon:a,rightIcon:l,href:n,rel:s,target:i,download:r,classes:d="",style:c}}){return u["default"]("a.link.mh2.pa2.truncate",{href:n,rel:s,target:i,download:r,title:t,class:`${d} ${b.navButton}`,style:c},H(a,e,l))}}class ve{view({attrs:{value:e}}){return u["default"](".pa2",{},u["default"].trust(e()))}}class ye{view({attrs:{field:e,value:t}}){const{label:a,uiClass:l={}}=e;return u["default"](".pa2.flex.flex-wrap",{class:I(l)},[W(a),u["default"]("span.ws-normal",{title:t(),class:b.displayValue},t())])}}class xe{formatter(e){return e?new Date(String(e)).toLocaleDateString():e}oninit({attrs:{value:e}}){this.formatted=e.map(this.formatter)}onremove(){this.formatted.end(true)}view({attrs:{field:e}}){return u["default"](ye,{field:e,value:this.formatted})}}function we(e,t){if(e==="email"){return{href:`mailto:${t}`,class:b.displayValue}}else if(e==="tel"){return{href:`tel:${t}`,class:b.displayValue}}else{return{href:t,target:"_blank",class:b.displayValue}}}const Ie={email:f.emailIcn,tel:f.telIcn};class $e{view({attrs:{field:e,value:t}}){const{label:a,type:l="url",uiClass:n={}}=e;return u["default"](".pa2.flex.flex-wrap",{class:I(n)},[W(a),u["default"]("a.link.dim.pointer.ws-normal",we(l,t()),u["default"]("i.mr2",{class:Ie[l]||f.linkIcn}),t())])}}class ke{view({attrs:{field:e,value:t}}){const{options:a=[]}=e;const l=r["default"].find(a,r["default"].matches({value:t()||false}));return l?u["default"]("span.ml2",l.label):null}}class Te{constructor(){this.onIcon="checkIcn";this.offIcon="uncheckIcn"}view({attrs:{field:e,value:t}}){const{label:a,uiClass:l={}}=e;return u["default"](".pa2.flex.items-center",{class:I(l)},[W(a),u["default"]("i",{class:`${b.displayValue} ${f[t()?this.onIcon:this.offIcon]}`}),u["default"](ke,{field:e,value:t})])}}class Se extends Te{constructor(){super(...arguments);this.onIcon="toggleOnIcn";this.offIcon="toggleOffIcn"}}function Ce(e,t){if(e.required&&!t){return true}if(e.pattern!=null){if(qe(e.pattern,String(t)))return true}if(Pe(e,t))return true;return false}function Pe(e,t){let a=false;let l=false;if(e.min!=null){l=Number.parseInt(String(t))<e.min}if(e.max!=null){a=Number.parseInt(String(t))>e.max}if(e.minlength!=null){l=String(t).length<e.minlength}if(e.maxlength!=null){a=String(t).length>e.maxlength}return l||a}function qe(e,t){return!new RegExp(e).test(t)}function De(e,t){if(e.required){return t.length<1}return false}function Fe(e){return t=>{t.preventDefault();if(t.dataTransfer){t.dataTransfer.dropEffect="copy"}if(e()){t.redraw=false}e(true)}}function Ue(e){return t=>{t.preventDefault();e(false)}}function Oe(e,t){return a=>{a.preventDefault();e(false);if(a.dataTransfer){t(a.dataTransfer.files)}}}function Be(e){return({target:{files:t}})=>e(t)}class Ae{constructor(){this.showLabel=true}oncreate({dom:e,attrs:{value:t}}){t.map(t=>{if(t.length===0){e.firstChild.value=""}})}view({attrs:{field:e,defaultAccept:t="*",multiple:a=true,dragging:l,onSet:n},children:s}){const{label:i,id:d,name:c=d,title:o=i,required:f,readonly:p,disabled:h,autofocus:m,accept:g=t,uiClass:b={}}=e;return u["default"]("label.db",r["default"].extend({for:d,title:o,class:F(h,p),"data-input-id":d},h||p?{}:{ondragover:Fe(l),ondragleave:Ue(l),ondrop:Oe(l,n)}),[u["default"]("input.clip[type=file].bg-transparent.bn.outline-0",{id:d,name:c,multiple:a,accept:g,required:f,autofocus:m,disabled:h||p,onchange:Be(n)}),this.showLabel&&i?u["default"]("span.db.mb1",{class:$(b,f)},A(i,f)):null,s])}}function Le(e,t=false){return a=>{const l=t?[]:e();r["default"].each(a,e=>{l.push({guid:O(),name:e.name,path:"not_set",file:e})});e(l)}}function We(e,t){return a=>{a.preventDefault();const l=e();r["default"].remove(l,{guid:t});e(l)}}class Me{constructor(){this.dragging=d["default"](false)}view({attrs:{field:e,value:t}}){const{disabled:a,uiClass:l={}}=e;return u["default"]("div",{class:I(l,a)},[u["default"](Ae,{field:e,dragging:this.dragging,onSet:Le(t),value:t},u["default"](".pa2",{class:D(l,this.dragging(),De(e,t()))},[u["default"]("i.mr2",{class:f.uploadIcn}),u["default"]("span",f.addFilesTxt)])),u["default"](".flex.flex-column.mt1.nb1",r["default"].map(t(),e=>u["default"]("span.pa2.mv1.ba.b--black-20.hide-child.dim.pointer",[u["default"]("i.mr2",{class:f.downloadIcn}),e.name,u["default"]("i.child.fr",{title:`${f.remFileTtl} ${e.name}`,class:f.deleteIcn,onclick:We(t,e.guid)})])))])}}class He{view({children:e,attrs:t}){return u["default"](".relative.w-third.w-25-m.w-20-l.pa1.tc.hide-child",[t.src&&t.src!=="not_set"?u["default"]("img.contain",{src:t.src}):null,t.data&&t.data.file&&(t.src==="not_set"||!t.src)?u["default"]("div.contain.tc.br5.6rem",{class:`${ae(t.data)} fa-2x`,tooltip:t.data.file.type}):null,e])}}class Re{view({attrs:e}){return u["default"]("i.pa1",{class:ae(e),title:f.openFileTxt,onclick:e.path!=="not_set"?()=>window.open(e.path,"_blank"):undefined})}}class ze{view({attrs:{displayType:e="thumbnail",value:t}}){return e==="thumbnail"?u["default"](".flex.flex-row.flex-wrap.mt1.nr1.nb1.nl1",r["default"].map(t(),e=>u["default"](He,{src:L(e.path,e.dataUrl),data:e,style:m()},u["default"](".absolute.top-0.right-0.child",u["default"](he,{title:`Remove ${e.name}`,icon:f.deleteIcn,onclick:We(t,e.guid)}))))):u["default"](".pa2.flex.flex-column",r["default"].map(t(),e=>u["default"](".flex.items-center.pa1.ba.b--black-20",[u["default"]("i.pa1",{class:f.uploadIcn}),u["default"]("span.ma1.flex-auto",{title:e.name},e.name),u["default"](Re,e),u["default"]("i.pa1.pointer.dim",{title:`Remove ${e.name}`,class:f.cancelIcn,onclick:We(t,e.guid)})])))}}class Ne{view({attrs:{field:e,value:t}}){const{label:a,uiClass:l={}}=e;const n=r["default"].find(e.options,{value:t()});const s=n?n.label||n.value:t();return u["default"](".pa2.flex.flex-wrap",{class:I(l)},[W(a),u["default"]("span.ws-normal",{title:s,class:b.displayValue},s)])}}class je{view({attrs:{field:e,value:t}}){const{label:a,uiClass:l={}}=e;return u["default"](".pa2.flex.flex-column",{class:I(l)},[W(a),u["default"](".flex.flex-column.mt1.nb1",r["default"].map(t(),({name:e,path:t})=>u["default"]("a.pa2.mv1.link.ba.b--black-20.dim.dib.pointer[target=_blank]",{class:b.displayValue,href:t},u["default"]("i.mr2",{class:f.downloadIcn}),e)))])}}class Ve{view({attrs:{field:e,value:t}}){const{label:a,uiClass:l={}}=e;return u["default"](".pa2.flex.flex-column",{class:I(l)},[W(a),u["default"](".flex.flex-row.flex-wrap.mt1.nr1.nb1.nl1",r["default"].map(t(),({name:e,path:t,dataUrl:a})=>u["default"](He,{title:e,src:L(t,a),style:m()})))])}}class _e{view({attrs:{field:e,value:t}}){const{label:a,uiClass:l={}}=e;const n=r["default"].head(t());return u["default"](".pa2.flex.flex-column",{class:I(l)},[W(a),n?u["default"]("img.img.h-100.mt2.contain.self-center",{title:n.name,src:L(n.path,n.dataUrl),style:h()}):u["default"]("i.mt2",{class:`${b.displayValue} ${f.imageIcn}`})])}}function Ee(e,t){return(e.match(t)||[]).length}function Ye(e){let t=0;if(e.length>=8){t=1;if(e.length>=24){t=t+1}if(Ee(e,/[A-Z]/g)>1&&Ee(e,/[a-z]/g)>2){t=t+1}if(Ee(e,/[\d]/g)>1){t=t+1}if(Ee(e,/[!"Â£%^@#$&*]/g)>0){t=t+1}}return t}function Ze(e){switch(e){case 0:{return"Invalid"}case 1:{return"Very Weak"}case 2:{return"Weak"}case 3:{return"Average"}case 4:{return"Strong"}case 5:{return"Very Strong"}}return""}const Ge=[{value:1,background:"bg-dark-red"},{value:2,background:"bg-orange"},{value:3,background:"bg-yellow"},{value:4,background:"bg-light-green"},{value:5,background:"bg-green"}];class Je{oninit({attrs:{value:e}}){this.passwordScore=e.map(e=>Ye(String(e)))}onremove(){this.passwordScore.end()}view({attrs:{field:e}}){const{label:t}=e;return u["default"](".flex.flex-column",[W(t),u["default"](".flex.mt1",r["default"].map(Ge,e=>u["default"](".h1.w-20",{class:this.passwordScore()>=e.value?e.background:"bg-transparent"}))),u["default"]("span.f5.truncate",Ze(this.passwordScore()))])}}class Ke{view({attrs:{field:{label:e="",title:t=e,required:a,uiClass:l={}}}}){return u["default"]("div",{class:I(l)},u["default"]("label",{title:t,class:$(l)},A(e,a)))}}class Qe{constructor(){this.invalid=false;this.selector="input"}onupdate({dom:e,attrs:{field:t,value:a}}){const l=e.querySelector(this.selector);const n=Ce(t,a())||(l?!l.checkValidity():false);if(n!==this.invalid){this.invalid=n;u["default"].redraw()}}}class Xe{view({attrs:e,children:t}){const{field:a,invalid:l}=e;const{label:n,id:s,type:i="text",required:r,disabled:d,uiClass:c={}}=a;return u["default"]("div",{class:i==="hidden"?"clip":I(c,d)},[M(s,c,n,r),u["default"]("fieldset.bn",{class:k(c,l)},t)])}}const et="0.7em";const tt="0.3s ease-in-out";class at{constructor(){this.focus=false;this.focusIn=()=>{this.focus=true};this.focusOut=()=>{this.focus=false};this.wrapperHeight=0}oncreate({dom:e}){this.inputWrapper=e.firstElementChild;this.calcHeight()}onupdate(){this.calcHeight()}calcHeight(){if(this.inputWrapper.clientHeight!==this.wrapperHeight){this.wrapperHeight=this.inputWrapper.clientHeight;u["default"].redraw()}}shouldFloat(e,t){return e==="floatAlways"||t||this.focus}labelTranslateY(){return`calc(${this.wrapperHeight*.5}px - 1.5ex)`}view({attrs:e,children:t}){const{field:a,invalid:l,value:n,xform:s=n}=e;const{label:i,id:r,type:d="text",placeholder:c,required:o,disabled:p,layout:h=f.layoutType,uiClass:m={}}=a;const g=this.shouldFloat(h,c||s());return u["default"]("div",{class:d==="hidden"?"clip":I(m,p),style:i?{paddingTop:"0.5rem"}:{},onfocusin:this.focusIn,onfocusout:this.focusOut},u["default"]("fieldset.relative.pa0.ma0.flex.w-100",{class:k(m,l)},[i&&this.wrapperHeight?[u["default"]("legend.db",{class:$(m,o),style:{visibility:"hidden",height:"0.5ch",transition:`max-width ${tt}`,maxWidth:g?"100%":"0.01px"}},u["default"]("span",{style:{fontSize:et}},A(i,o))),u["default"](".absolute.top-0",{class:$(m,o),style:{transition:`transform ${tt}`,transform:`translateY(${g?"-1ch":this.labelTranslateY()})`}},u["default"]("label.db",{for:r,title:i,style:{transition:`font-size ${tt}`,fontSize:g?et:"1em",cursor:g?"default":"text"}},A(i,o)))]:null,t]))}}class lt{constructor(){this.layout=at}view({attrs:e,children:t}){const{field:{layout:a=f.layoutType}}=e;return u["default"](a==="default"?Xe:this.layout,e,t)}}class nt extends at{shouldFloat(){return true}}class st extends lt{constructor(){super(...arguments);this.layout=nt}}const it=new Set(["date","datetime-local","color","range"]);class rt extends Qe{view({attrs:e}){const{field:t,value:a,xform:l=a}=e;const{label:n,id:s,type:i="text",name:r=s,title:d=n,placeholder:c,max:o,maxlength:f,min:p,minlength:h,step:m,required:g,readonly:b,disabled:v,autofocus:y,autocomplete:x,pattern:w,inputmode:I,spellcheck:$,instant:k,uiClass:S={}}=t;const C=it.has(i)?st:lt;return u["default"](C,{field:t,value:a,xform:l,invalid:this.invalid},u["default"]("input.w-100.bg-transparent.bn.outline-0",{id:s,type:i,name:r,title:d,placeholder:c,max:o,maxlength:f,min:p,minlength:h,step:m,required:g,readonly:b,disabled:v,autofocus:y,autocomplete:x,pattern:w,inputmode:I,spellcheck:$,class:T(S),value:l(),[k?"oninput":"onchange"]:R(a)}))}}class ut{view({attrs:e}){const{field:t,value:a,xform:l=a}=e;const{label:n,id:s,name:i=s,title:d=n,placeholder:c,max:o,maxlength:f,min:p,minlength:h,step:m,required:g,readonly:b,disabled:v,autofocus:y,autocomplete:x,pattern:w,inputmode:I,spellcheck:$,instant:k,uiClass:S={},options:C}=t;const P=C&&C.length?C[0].value:"$";return u["default"](st,{field:t,value:a,invalid:Ce(t,a())},u["default"](".flex.flex-row.w-100",u["default"]("span.mr1.self-center",{class:T(S)},P),u["default"]("input.w-100.bg-transparent.bn.outline-0",{id:s,type:"text",name:i,title:d,placeholder:c,max:o,maxlength:f,min:p,minlength:h,step:m,required:g,readonly:b,disabled:v,autofocus:y,autocomplete:x,pattern:w,inputmode:I,spellcheck:$,class:T(S),onfocus:({target:e})=>e.select(),value:r["default"].isUndefined(l())?null:ot(dt(l())),[k?"oninput":"onchange"]:pt(a)})))}}function dt(e){return r["default"].isString(e)?r["default"].parseInt(e):Number(e)}function ct(e){const t=e.replace(/[^\d.]/g,"");let a;let l=0;if(t.indexOf(".")>-1){const e=t.indexOf(".");const n=t.substring(0,e);a=r["default"].parseInt(r["default"].padStart(n,1,"0"));const s=t.substring(e+1,Math.min(e+3,t.length));l=r["default"].parseInt(r["default"].padEnd(s,2,"0"))}else{a=r["default"].parseInt(t)||0}return a*100+l}function ot(e){const t=ft(e);if(t){return`${t[0]}.${t[1]}`}else{return t}}function ft(e){if(!r["default"].isFinite(e)){return undefined}const t=String(Math.abs(e));let a="0";let l="";if(t.length>2){const e=t.length-2;a=t.substring(0,e);l=t.substring(e)}else{l=r["default"].padStart(t,2,"0")}return[a,l]}function pt(e){return({target:{value:t}})=>e(ct(t))}class ht{view({attrs:e}){const{id:t}=e.field;return u["default"]("input",{style:{display:"none"},id:t})}}class mt{constructor(){this.month=d["default"]("");this.year=d["default"]("");this.date=d["default"]("");this.valid=d["default"](true);this.dom=d["default"]();this.focusedInput=d["default"]("mm")}buildDate(e,t){this.date(`${this.month()}/${this.year()}`);const a=J(this.year(),this.month(),e);this.valid(a);if(a&&t){t(this.date())}}oninit({attrs:{value:e,field:t}}){e.map(e=>{const[a,l=""]=String(e).split("/");if(a.length===2&&l.length===2){this.month(a);this.year(l);this.buildDate(Boolean(t.required))}else if(!e&&this.date()){this.month("");this.year("");this.date("")}})}oncreate({dom:e}){V(e,this.dom,this.valid)}onupdate({dom:e}){V(e,this.dom,this.valid)}onremove(){this.date.end(true);this.year.end(true);this.month.end(true)}view({attrs:e}){const{field:t,value:a}=e;const{id:l,name:n=l,required:s,readonly:i,disabled:d,uiClass:c={}}=t;const o=T(c);return u["default"](st,{value:a,field:t,invalid:!this.valid()&&Boolean(s)||!this.valid()},u["default"](".flex",{onclick:()=>j(this.dom(),l,this.focusedInput()),style:{padding:"1px 2px"}},u["default"]("span",[u["default"]("input.w-100.bg-transparent.bn.outline-0.tc",{id:`${l}-mm`,name:`${n}-mm`,type:"text",placeholder:"MM",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:s,readonly:i,disabled:d,value:this.month(),class:o,style:{maxWidth:"calc(2.8ch + 4px)",padding:"0px"},onfocus:r["default"].partial(this.focusedInput,"mm"),oninput:()=>{K(this.month,l,"mm",this.dom(),"yy");this.buildDate(Boolean(s),e.value)},onblur:r["default"].partial(Z,this.month)})]),u["default"]("span",{style:{padding:"0px",marginRight:"2px"}},"/"),u["default"]("span",[u["default"]("input.w-100.bg-transparent.bn.outline-0.tc",{id:`${l}-yy`,name:`${n}-yy`,type:"text",placeholder:"YY",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:s,readonly:i,disabled:d,value:this.year(),class:o,style:{maxWidth:"calc(2.7ch + 4px)",padding:"0px"},onfocus:r["default"].partial(this.focusedInput,"yy"),onkeydown:e=>Y(l,"mm",this.year(),this.dom(),e),oninput:()=>{K(this.year,l,"yy",this.dom());this.buildDate(Boolean(s),e.value)}}),u["default"](ht,e)])))}}class gt{constructor(){this.day=d["default"]("");this.month=d["default"]("");this.year=d["default"]("");this.date=d["default"]();this.valid=d["default"](true);this.dom=d["default"]();this.focusedInput=d["default"](undefined);this.locale=d["default"](undefined)}buildDate(e,t){this.date(`${this.year()}-${this.month()}-${this.day()}`);const a=G(this.year(),this.month(),this.day(),e);this.valid(a);if(a&&t){t(this.date())}}findNextInput(e){const t=this.dateInputAdvanceOrder.indexOf(e);return t!==this.dateInputAdvanceOrder.length&&N(this.dateInputAdvanceOrder[this.dateInputAdvanceOrder.indexOf(e)+1])}findPrevInput(e){const t=this.dateInputAdvanceOrder.indexOf(e);return t!==0&&N(this.dateInputAdvanceOrder[this.dateInputAdvanceOrder.indexOf(e)-1])}setDateInputs(e){const t=new Intl.DateTimeFormat(e).formatToParts();this.dateParts=t;const a=t[0].type;const l=N(a);this.focusedInput(l);this.dateInputAdvanceOrder=r["default"](this.dateParts).map(({type:e})=>e).filter(e=>e!=="literal").value()}setLocale(e){const{options:t}=e;const a=t&&t.length?t[0].value:undefined;if(a!==this.locale()){this.locale(a)}}oninit({attrs:{value:e,field:t}}){e.map(e=>{const a=new Date(String(e));if(r["default"].isDate(a)&&!isNaN(a.getTime())){const e=r["default"].padStart(String(a.getDate()),2,"0");const l=r["default"].padStart(String(1+a.getMonth()),2,"0");const n=String(a.getFullYear());this.day(e);this.month(l);this.year(n);this.buildDate(Boolean(t.required))}else if(!e&&this.date()){this.day("");this.month("");this.year("");this.date("")}});this.locale.map(e=>{this.setDateInputs(e)});this.valid(!t.required);this.setLocale(t)}oncreate({dom:e}){V(e,this.dom,this.valid)}onbeforeupdate({attrs:{field:e}}){this.setLocale(e)}onupdate({dom:e}){V(e,this.dom,this.valid)}onremove(){this.date.end(true);this.year.end(true);this.month.end(true);this.day.end(true)}view({attrs:e}){const{id:t,name:a=t,required:l,readonly:n,disabled:s,uiClass:i={}}=e.field;const d=T(i);const{field:c}=e;const o=({type:i,value:c})=>{switch(i){case"literal":return u["default"]("span",{style:{padding:"0px",marginRight:"2px"}},c);case"day":return u["default"]("span",u["default"]("input.w-100.bg-transparent.bn.outline-0.tc",{id:`${t}-dd`,name:`${a}-dd`,type:"text",placeholder:"DD",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:l,readonly:n,disabled:s,value:this.day(),class:d,onfocus:r["default"].partial(this.focusedInput,"dd"),onkeydown:e=>Y(t,this.findPrevInput("day"),this.day(),this.dom(),e),oninput:()=>{K(this.day,t,"dd",this.dom(),this.findNextInput("day"));this.buildDate(Boolean(l),e.value)},onblur:r["default"].partial(Z,this.day),style:{maxWidth:"calc(2.3ch + 4px)",padding:"0px"}}));case"month":return u["default"]("span",u["default"]("input.w-100.bg-transparent.bn.outline-0.tc",{id:`${t}-mm`,name:`${a}-mm`,type:"text",placeholder:"MM",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:l,readonly:n,disabled:s,value:this.month(),class:d,onkeydown:e=>Y(t,this.findPrevInput("month"),this.month(),this.dom(),e),oninput:()=>{K(this.month,t,"mm",this.dom(),this.findNextInput("month"));this.buildDate(Boolean(l),e.value)},onfocus:r["default"].partial(this.focusedInput,"mm"),onblur:r["default"].partial(Z,this.month),style:{maxWidth:"calc(2.8ch + 4px)",padding:"0px"}}));case"year":return u["default"]("span",u["default"]("input.w-100.bg-transparent.bn.outline-0.tc",{id:`${t}-yyyy`,name:`${a}-yyyy`,type:"text",placeholder:"YYYY",minlength:"4",maxlength:"4",pattern:"[0-9]*",inputmode:"numeric",required:l,readonly:n,disabled:s,value:this.year(),class:d,onfocus:r["default"].partial(this.focusedInput,"yyyy"),onkeydown:e=>Y(t,this.findPrevInput("year"),this.year(),this.dom(),e),oninput:()=>{K(this.year,t,"yyyy",this.dom(),this.findNextInput("year"));this.buildDate(Boolean(l),e.value)},style:{maxWidth:"calc(4.2ch + 4px)",padding:"0px"}}))}};return u["default"](st,{value:e.value,field:c,invalid:!this.valid()&&Boolean(l)||!this.valid()},u["default"](".flex",{onclick:()=>j(this.dom(),t,this.focusedInput()),style:{padding:"1px 2px"}},this.dateParts.map(e=>o(e)),u["default"](ht,e)))}}class bt{constructor(){this.showPassword=d["default"](false)}view({attrs:e}){const{field:t,value:a}=e;const{label:l,id:n,name:s=n,title:i=l,placeholder:r,maxlength:d,minlength:c,required:o,readonly:p,disabled:h,autofocus:m,autocomplete:g,pattern:b,inputmode:v,instant:y,uiClass:x={}}=t;return u["default"](lt,{field:t,value:a,invalid:Ce(t,a())},u["default"](".flex.flex-row.w-100",[u["default"]("input.w-100.bg-transparent.bn.outline-0",{id:n,name:s,title:i,placeholder:r,type:this.showPassword()?"text":"password",maxlength:d,minlength:c,required:o,readonly:p,disabled:h,autofocus:m,autocomplete:g,pattern:b,inputmode:v,class:T(x),value:a(),autocorrect:"off",[y?"oninput":"onchange"]:R(a)}),u["default"]("i.ml1.pa1.fa-fw.pointer.dim",{title:f.showPassTxt,class:this.showPassword()?f.hidePassIcn:f.showPassIcn,onclick:()=>this.showPassword(!this.showPassword())})]))}}class vt extends at{labelTranslateY(){return"0.5ex"}}class yt extends lt{constructor(){super(...arguments);this.layout=vt}}class xt extends Qe{constructor(){super(...arguments);this.selector="textarea"}view({attrs:e}){const{field:t,value:a,xform:l=a}=e;const{label:n,id:s,name:i=s,title:r=n,placeholder:d,required:c,readonly:o,disabled:f,autofocus:p,autocomplete:h,spellcheck:m,instant:g,uiClass:b={}}=e.field;return u["default"](yt,{field:t,value:a,xform:l,invalid:this.invalid},u["default"]("textarea.w-100.bg-transparent.bn.outline-0.h-100",{id:s,name:i,title:r,placeholder:d,required:c,readonly:o,disabled:f,autofocus:p,autocomplete:h,spellcheck:m,class:C(b),value:a(),style:{resize:"none"},[g?"oninput":"onchange"]:R(a)}))}}class wt{constructor(){this.onIcon="checkIcn";this.offIcon="uncheckIcn"}view({attrs:{field:e,value:t}}){const{label:a="",id:l,name:n=l,title:s=a,required:i,readonly:r,disabled:d,autocomplete:c,uiClass:o={}}=e;return u["default"]("div",{class:I(o,d)},u["default"]("fieldset.w-100.bn",{class:k(o)},[u["default"]("label.flex.items-center",{title:s,class:S(o,d,r),"data-input-id":l},u["default"]("input.clip[type=checkbox]",{id:l,name:n,checked:t(),required:i,autocomplete:c,disabled:d||r,onchange:z(t)}),u["default"]("i.mr2",{class:f[t()?this.onIcon:this.offIcon]}),A(a,i),u["default"](ke,{field:e,value:t}))]))}}class It extends wt{constructor(){super(...arguments);this.onIcon="toggleOnIcn";this.offIcon="toggleOffIcn"}}class $t{view({attrs:e}){const{field:t,value:a}=e;const{id:l,name:n=l,required:s,readonly:i,disabled:d,autocomplete:c,uiClass:o={},options:f}=t;return u["default"](st,{field:t,value:a,invalid:Ce(t,a())},u["default"](".w-100.flex.justify-center",{onchange:R(a),style:{padding:"1px 2px"}},r["default"].map(f,({value:e,label:t=e,icon:r})=>{const f=a()===e;return u["default"]("label.dib",{title:t,class:P(o,f,d,i),"data-input-id":l},u["default"]("input.clip[type=radio]",{name:n,value:e,checked:f,required:s,autocomplete:c,disabled:d||i}),r?u["default"]("i.fa-fw",{class:r}):t)})))}}class kt{view({attrs:e}){const{field:t,value:a}=e;const{label:l,id:n,name:s=n,title:i=l,required:d,readonly:c,disabled:o,autofocus:f,autocomplete:p,uiClass:h={},placeholder:m="--- Select one ---",options:g}=t;return u["default"](st,{field:t,value:a,invalid:Ce(t,a())},u["default"]("select.w-100.bg-transparent.bn.outline-0",{id:n,name:s,title:i,required:d,readonly:c,disabled:o,autofocus:f,autocomplete:p,class:T(h),value:a()?a():"",onchange:R(a)},u["default"]("option",{disabled:true,value:""},m),r["default"].map(g,({value:e,label:t=e})=>u["default"]("option",{value:e,disabled:o||c},t))))}}class Tt{constructor(){this.dragging=d["default"](false)}view({attrs:{field:e,value:t,displayType:a}}){const l=r["default"].head(t());const{disabled:n,uiClass:s={}}=e;const i=a==="none"||!l?f.addFileTxt:l.name;return u["default"]("div",{class:I(s,n)},u["default"](Ae,{field:e,multiple:false,dragging:this.dragging,onSet:Le(t,true),value:t},u["default"](".flex.items-center.pa1",{class:D(s,this.dragging(),De(e,t()))},[u["default"]("i.pa1",{class:f.uploadIcn}),u["default"]("span.ma1.flex-auto",i),l&&a!=="none"?[u["default"](Re,l),u["default"]("i.pa1.pointer.dim",{title:`Remove ${l.name}`,class:f.cancelIcn,onclick:We(t,l.guid)})]:null])))}}function St(e,t,a=false){return l=>{const n=a?[]:e();return Promise.all(r["default"].map(l,e=>de(e,t,e.type).then(t=>{const a=ee(X(t),e.name);n.push({guid:O(),name:a.name,path:"not_set",file:a,dataUrl:t})}))).then(()=>{e(n);u["default"].redraw()})}}class Ct{constructor(){this.dragging=d["default"](false)}view({attrs:{field:e,value:t}}){const{disabled:a,uiClass:l={}}=e;return u["default"]("div",{class:I(l,a)},[u["default"](Ae,{field:e,defaultAccept:"image/*",dragging:this.dragging,onSet:St(t,f.imageMaxSize),value:t},u["default"](".w-100.pa1.dt.tc",{class:D(l,this.dragging(),De(e,t()))},u["default"]("i.fa-2x.dtc.v-mid",{class:f.cameraIcn}))),u["default"](".flex.flex-row.flex-wrap.mt1.nr1.nb1.nl1",r["default"].map(t(),e=>u["default"](He,{src:L(e.path,e.dataUrl),style:m()},u["default"](".absolute.top-0.right-0.child",u["default"](he,{title:`Remove ${e.name}`,icon:f.deleteIcn,onclick:We(t,e.guid)})))))])}}class Pt{constructor(){this.dragging=d["default"](false)}view({attrs:{field:e,value:t}}){const a=r["default"].head(t());const{disabled:l,uiClass:n={}}=e;return u["default"]("div",{class:I(n,l)},u["default"](Ae,{field:e,defaultAccept:"image/*",multiple:false,dragging:this.dragging,onSet:St(t,f.imageMaxSize,true),value:t},u["default"](".pa1",{class:D(n,this.dragging(),De(e,t()))},u["default"](".relative.w-100.dt.tc",a?[u["default"]("img.img.contain",{title:a.name,src:L(a.path,a.dataUrl),style:h()}),u["default"](".absolute.top-0.right-0.pa1.pointer.dim",{title:`Remove ${a.name}`,onclick:We(t,a.guid)},u["default"]("i.pa1",{class:f.cancelIcn}))]:u["default"]("i.fa-2x.dtc.v-mid",{class:f.cameraIcn})))))}}class qt{oncreate({dom:e}){const t=e.children[0];const a=B();this.signaturePad=new c["default"](t,{minWidth:.5*a,maxWidth:1.5*a});const l=()=>{const e=B();t.width=t.offsetWidth*e;t.height=t.offsetHeight*e;const a=t.getContext("2d");a.scale(e,e);this.resetCanvas()};this.resizeHandler=r["default"].debounce(l,250);window.addEventListener("resize",this.resizeHandler);window.addEventListener("orientationchange",this.resizeHandler);l()}onremove(){this.resizeHandler.cancel();window.removeEventListener("resize",this.resizeHandler);window.removeEventListener("orientationchange",this.resizeHandler)}view({attrs:{style:e,onSet:t,onCancel:a}}){return[u["default"](".aspect-ratio.bg-white.ba.bw1.br3.b--dashed.b--black-30",{style:e},u["default"]("canvas.aspect-ratio--object")),u["default"](".absolute.top-0.right-0.z-999",{style:{transform:"translateY(-100%)"}},[u["default"](he,{title:f.applyTtl,icon:f.applyIcn,classes:"ma1",onclick:()=>{if(!this.signaturePad.isEmpty()){t(this.signaturePad.toDataURL("image/png"))}}}),u["default"](he,{title:f.resetTtl,icon:f.resetIcn,classes:"ma1",onclick:()=>this.resetCanvas()}),u["default"](he,{title:f.cancelTtl,icon:f.cancelIcn,classes:"ma1",onclick:a})])]}resetCanvas(){this.signaturePad.clear()}}function Dt(e,t,a){return()=>{if(e()){a(fe(e(),t),{text:e(),heightPct:t})}return false}}class Ft{constructor(){this.text=d["default"]("")}oncreate({dom:e}){const t=e.children[0];t.focus({preventScroll:false});this.scaleText(e)}onupdate({dom:e}){this.scaleText(e)}view({attrs:{heightPct:e,style:t,onSet:a,onCancel:l}}){return[u["default"]("form.aspect-ratio.ba.bw1.br3.b--dashed.b--black-30",{style:t,onsubmit:Dt(this.text,e,a)},u["default"]("input.aspect-ratio--object.pa2.ba.bw0[type=text]",{oninput:R(this.text),value:this.text(),style:{"font-family":f.signFont}})),u["default"](".absolute.top-0.right-0.z-999",{style:{transform:"translateY(-100%)"}},[u["default"](he,{title:f.applyTtl,icon:f.applyIcn,classes:"ma1",onclick:Dt(this.text,e,a)}),u["default"](he,{title:f.resetTtl,icon:f.resetIcn,classes:"ma1",onclick:()=>this.text("")}),u["default"](he,{title:f.cancelTtl,icon:f.cancelIcn,classes:"ma1",onclick:l})])]}scaleText(e){const t=e.clientHeight;e.style.fontSize=`${.56*t}px`}}function Ut(e,t,a){return()=>a(fe(t,e),{text:t,heightPct:e})}class Ot{view({attrs:{heightPct:e,stampTxt:t,stampSetTxt:a,onSet:l}}){return[u["default"]("span.clip",{style:{"font-family":f.signFont}},a),u["default"](".flex",u["default"](he,{label:t,classes:`flex-auto ${f.stampBtnClass}`,context:f.stampBtnContext,onclick:Ut(e,a,l)}))]}}const Bt={["draw"]:qt,["type"]:Ft,["stamp"]:Ot};function At(e,t,a){return(l,n)=>ce(l,a).then(a=>{e([te(a,`sign-${t}.png`,n)]);u["default"].redraw()})}class Lt{oninit({attrs:{value:e}}){this.valUpdate=e.map(()=>this.setSignType())}onremove(){this.valUpdate.end()}view({attrs:{field:e,value:t}}){const{label:a,id:l,readonly:n,disabled:s,uiClass:i={},options:d=f.signOpts,heightPct:c=f.signHeightPct,stampTxt:o=f.stampTxt,stampSetTxt:p=f.stampSetTxt}=e;const h={paddingBottom:`${c}%`};const m=r["default"].head(t());const g=r["default"](d).map(({value:e})=>{if(e==="draw"){return{type:e,icon:f.drawIcn,label:f.signDrawTxt}}else if(e==="type"){return{type:e,icon:f.typeIcn,label:f.signTypeTxt}}else if(e==="stamp"){return{type:e,icon:f.stampIcn,label:f.signStampTxt}}return null}).compact().value();if(g.length===1&&!m){this.setSignType(g[0].type)}return u["default"]("div.relative",{class:I(i,s)},[M(l,i,a),n||s?u["default"](".aspect-ratio",{id:l,style:h},m?u["default"](".aspect-ratio--object",{style:{"pointer-events":"none"}},u["default"]("img.img.w-100.absolute",{src:L(m.path,m.dataUrl)})):null):this.signType?u["default"](Bt[this.signType],{heightPct:c,stampTxt:o,stampSetTxt:p,style:h,onSet:At(t,l,f.signMaxSize),onCancel:r["default"].bind(this.setSignType,this,undefined)}):u["default"](".aspect-ratio.pointer",{id:l,class:b.fileInputWrapper,style:h},m?u["default"](".aspect-ratio--object.hide-child.dim",{onclick:r["default"].bind(t,this,[])},[u["default"]("img.img.w-100.absolute",{src:L(m.path,m.dataUrl)}),u["default"](".pa3.absolute.top-0.right-0.child",u["default"]("i.fa-2x",{class:f.resetIcn}))]):u["default"](".aspect-ratio--object.flex",r["default"].map(g,({type:e,icon:t,label:a})=>u["default"](".flex-auto.flex.items-center.justify-center.dim",{title:a,onclick:r["default"].bind(this.setSignType,this,e)},u["default"]("i.fa-2x.ma1",{class:t}),u["default"]("span.ma1.dn.db-ns.truncate",a)))))])}setSignType(e){this.signType=e}}function Wt(e,t){return a=>{const l=t?[]:e();return Promise.all(r["default"].map(a,e=>{if(le(e.type)){return de(e,f.imageMaxSize,e.type).then(t=>{const a=ee(X(t),e.name);l.push({guid:O(),name:a.name,path:"not_set",file:a,dataUrl:t})})}else{l.push({guid:O(),name:e.name,path:"not_set",file:e});return Promise.resolve()}})).then(()=>{e(l);u["default"].redraw()})}}class Mt{constructor(){this.dragging=d["default"](false)}view({attrs:{field:e,value:t}}){const a=r["default"].head(t());const{disabled:l,uiClass:n={}}=e;return u["default"]("div",{class:I(n,l)},u["default"](Ae,{field:e,defaultAccept:"*",multiple:false,dragging:this.dragging,onSet:Wt(t,true),value:t},u["default"](".flex.items-center.pa1",{class:D(n,this.dragging(),De(e,t()))},a?a.dataUrl?[u["default"](".relative.w-100.dt.tc",u["default"]("img.img.contain",{title:a.name,src:L(a.path,a.dataUrl),style:h()}),u["default"](".absolute.top-0.right-0.pa1.pointer.dim",{title:`Remove ${a.name}`,onclick:We(t,a.guid)},u["default"]("i.pa1",{class:f.cancelIcn})))]:[u["default"](Re,a),u["default"]("span.ma1.flex-auto",{title:a.name},a.name),u["default"]("i.pa1.pointer.dim",{title:`Remove ${a.name}`,class:f.cancelIcn,onclick:We(t,a.guid)})]:[u["default"]("i.pa1",{class:f.uploadIcn}),u["default"]("span.ma1.flex-auto",f.addFileTxt)])))}}class Ht{constructor(){this.dragging=d["default"](false)}view({attrs:{field:e,value:t,displayType:a,showDisplay:l=true}}){const{disabled:n,uiClass:s={}}=e;return u["default"]("div",{class:I(s,n)},[u["default"](Ae,{field:e,defaultAccept:"*",dragging:this.dragging,onSet:Wt(t,false),value:t},u["default"](".flex.items-center.pa1.dt",{class:D(s,this.dragging(),De(e,t()))},[u["default"]("i.pa1",{class:f.uploadIcn}),u["default"]("span.ma1.flex-auto",f.addFileTxt)])),l?u["default"](ze,{displayType:a,value:t}):null])}}class Rt extends Ae{constructor(){super(...arguments);this.showLabel=false}}class zt{constructor(){this.dragging=d["default"](false)}view({attrs:{field:e,value:t}}){const{label:a="Add File",required:l,uiClass:n={}}=e;return[a?u["default"]("span.db.mb1",{class:$(n,l)},A(a,l)):null,u["default"]("div",{class:`${D(n,this.dragging(),De(e,t()))} ${w()} ${b.button}`},u["default"](Rt,{field:e,multiple:false,dragging:this.dragging,onSet:Le(t,true),value:t},u["default"](".flex.items-center",H(f.uploadIcn,a))))]}}e.Badge=pe;e.BaseInput=rt;e.BaseText=ye;e.Button=he;e.ButtonLink=me;e.CardDateInput=mt;e.Checkbox=Te;e.CheckboxInput=wt;e.CurrencyInput=ut;e.DateInput=gt;e.DateText=xe;e.DisplayTypeComponent=ze;e.FileButtonSelect=zt;e.FileList=je;e.FileMulti=Me;e.FileSelect=Tt;e.ImageList=Ve;e.ImageMulti=Ct;e.ImagePreview=_e;e.ImageSelect=Pt;e.Label=Ke;e.Link=$e;e.MultiOmniFileInput=Ht;e.NavButton=ge;e.NavLink=be;e.OmniFileInput=Mt;e.PasswordInput=bt;e.PasswordStrength=Je;e.RadioInput=$t;e.SelectInput=kt;e.SelectText=Ne;e.SignBuilder=Lt;e.TextareaInput=xt;e.Toggle=Se;e.ToggleInput=It;e.Trusted=ve;e.createStamp=fe;e.currencyStrToNumber=ct;e.dataURItoBlob=X;e.dataUrlToFile=te;e.fileConstructor=ee;e.fileNameExtSplit=Q;e.getOrientation=ne;e.guid=O;e.iconMap=Ie;e.linkAttrs=we;e.numberToCurrencyStr=ot;e.numberToCurrencyTuple=ft;e.pxRatio=B;e.readArrayBuffer=se;e.readOrientation=ie;e.resizeImage=de;e.scaleDataUrl=ce;e.scaleRect=ue;e.textToImage=oe;e.theme=b;e.updateButtonContext=x;e.updateClasses=v;e.updateConfig=p;Object.defineProperty(e,"__esModule",{value:true})}));
