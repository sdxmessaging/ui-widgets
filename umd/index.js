/* @preserve built on: 2023-08-22T10:08:52.355Z */
(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?t(exports,require("lodash"),require("mithril"),require("mithril/stream"),require("luxon"),require("flatpickr"),require("signature_pad")):typeof define==="function"&&define.amd?define(["exports","lodash","mithril","mithril/stream","luxon","flatpickr","signature_pad"],t):(e=typeof globalThis!=="undefined"?globalThis:e||self,t(e.uiWidgets={},e._,e.m,e.m.stream,e.luxon,e.flatpickr,e.SignaturePad))})(this,(function(e,t,a,n,l,i,s){"use strict";function r(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}var o=r(t);var d=r(a);var c=r(n);var u=r(i);var f=r(s);const h={wrapper:"",label:"silver",inputWrapper:"ba br2 b--silver pa2 ma0 dark-gray",input:"dark-gray fw2",button:"pa2 bn br2",navButton:"dark-gray",textarea:"dark-gray fw2",fileInputWrapper:"ba bw1 br3 b--black-30 b--dashed dark-gray",fileHover:"blue b--blue",displayLabel:"silver",displayValue:"dark-gray",requiredLabel:"",disabledWrapper:"o-40",invalidInputWrapper:"ba b--red",altLabel:"ml1 o-70",floatLabelPlaceholder:"",invalidCheckboxWrapper:"red",tooltipWrapper:"dib relative mh2",tooltipIconBackground:"bg-black h2 w2 relative br-100 ",tooltipIcon:"white f6",tooltipMessage:"white bg-black w5 f6 pa2 absolute br2 z-max",redNumber:"red fw2"};const p=h;function m(e){o["default"].assign(h,e)}const g={default:"bg-light-blue dark-gray"};function b(e){o["default"].assign(g,e)}function v(e="default"){if(e&&e in g){return g[e]}else{return""}}function y(e){return o["default"].compact(e).join(" ")}function x(e,t){if(e in t){return t.merge===false?[t[e]]:[t[e],p[e]]}else{return[p[e]]}}function w(e,t){return y([...x("wrapper",e),t?p.disabledWrapper:""])}function I(e,t){return y([...x("label",e),t?p.requiredLabel:""])}function k(e,t,a){return y([I(e,a),t?"f-07em cursor-default":`${p.floatLabelPlaceholder} cursor-text`])}function S(e,t){return y([...x("inputWrapper",e),...t?x("invalidInputWrapper",e):[""]])}function P(e){return y(x("input",e))}function T(e,t,a){return y([P(e),q(t,a)])}function $({input:e="",merge:t=true}){return y([e,t?p.textarea:""])}function C(e){return e?p.fileHover:""}function D({inputWrapper:e="",merge:t=true},a,n){return y([e,t?p.fileInputWrapper:"",n?p.invalidInputWrapper:"",C(a)])}function q(e,t){return e||t?"":"pointer"}const L={layoutType:"default",tooltipIcon:"fas fa-info",imageMaxSize:1280,addFileTxt:"Upload...",addFilesTxt:"Add file(s)...",remFileTtl:"Remove",openFileTxt:"Open file",showPassTxt:"Show Password",requiredLblPost:"",optionalLblPost:"",dateLocale:"default",datePickerIcn:"fas fa-calendar",signOpts:["draw","type","stamp"],signMaxSize:640,signHeightPct:25,signFont:"sans-serif",signDrawTxt:"Draw",signTypeTxt:"Type",signStampTxt:"Accept",stampTxt:"Accept",stampBtnClass:"",stampBtnContext:"default",stampSetTxt:"Accepted",applyTtl:"Apply",resetTtl:"Reset",cancelTtl:"Cancel",drawIcn:"fas fa-signature",typeIcn:"fas fa-keyboard",stampIcn:"fas fa-check",applyIcn:"fas fa-check",resetIcn:"fas fa-eraser",cancelIcn:"fas fa-times",badgePosition:"left",currencySymbol:"$",negativeStyle:"default",selectionLayout:["icon","label"],selectionOnLabel:"",selectionOffLabel:"",selectionOnActive:"",selectionOffActive:"",selectionOnInactive:"dn",selectionOffInactive:"dn",checkIcn:"far fa-check-square",uncheckIcn:"far fa-square",toggleOnWrapper:"br-pill bg-light-blue",toggleOffWrapper:"br-pill bg-silver",toggleOnIcn:"br-100 bg-white",toggleOffIcn:"br-100 bg-white",radioOnIcn:"fas fa-circle-dot",radioOffIcn:"fas fa-circle",showPassIcn:"fas fa-fw fa-eye",hidePassIcn:"fas fa-fw fa-eye-slash",uploadIcn:"fas fa-file-upload",downloadIcn:"fas fa-file-download",deleteIcn:"fas fa-trash-alt",cameraIcn:"fas fa-camera",imageIcn:"fas fa-image",emailIcn:"fas fa-envelope",telIcn:"fas fa-phone",linkIcn:"fas fa-link",wordDocIcn:"fas fa-file-word",videoFileIcn:"fas fa-file-video",pdfFileIcn:"fas fa-file-pdf",musicFileIcn:"fas fa-file-audio",excelFileIcn:"fas fa-file-excel",fileIcn:"fas fa-file",codeFileIcn:"fas fa-file-code"};const O=L;function F(e){o["default"].assign(L,e)}function A(e,t){return t&&e in t?t[e]:O[e]}const E={};function M(e,t){if(e in E){throw new Error(`Function ${e} already registered.`)}E[e]=t}function B(e){if(!(e in E)){throw new Error(`Function ${e} not registered.`)}return E[e]}function R(e,t){if(typeof e==="string"){return d["default"]("i",{class:y([t,e])})}else{return B(e.name)(e.data,t)}}function U(e){return(e+256).toString(16).substring(1)}function _(){const e=new Uint8Array(16);const t=window.crypto;t.getRandomValues(e);return[U(e[0]),U(e[1]),U(e[2]),U(e[3]),"-",U(e[4]),U(e[5]),"-",U(e[6]),U(e[7]),"-",U(e[8]),U(e[9]),"-",U(e[10]),U(e[11]),U(e[12]),U(e[13]),U(e[14]),U(e[15])].join("")}function N(){return Math.max(window.devicePixelRatio,1)}function W(e){return e&&(typeof e==="string"?e:e.text)}function V(e,t){const a=typeof e==="string"?e:e.text;const n=t?O.requiredLblPost:O.optionalLblPost;return n?a+n:a}function z({alt:e}){return e?d["default"]("span",{class:p.altLabel},e):null}function j(e,t){return t?t:e}function H(e,t,a,n){return d["default"](t,a,[e.icon?R(e.icon,""):null,d["default"]("span",V(e,n)),z(e),e.rightIcon?R(e.rightIcon,""):null,e.href?d["default"]("a.link.dim.pointer.ws-normal.mh1",{onclick:e.onclick},[d["default"]("i",{class:O.linkIcn}),e.href]):null])}function Y(e,t="mr2 truncate"){if(e){if(typeof e==="string"){return d["default"]("span",{title:e,class:y([t,p.displayLabel])},e)}else{return H(e,"span",{title:e.text,class:y([t,p.displayLabel])})}}return null}function G(e,t,a,n){if(a){if(typeof a==="string"){return d["default"]("label.mb1.db",{title:a,for:e,class:I(t,n)},V(a,n))}else{return H(a,"label.mb1.db",{title:a.text,for:e,class:I(t,n)},n)}}return null}function Z(e){return[e.icon&&R(e.icon,"fa-fw"),e.text&&d["default"]("span",e.text),e.rightIcon&&R(e.rightIcon,"fa-fw")]}function K(e){return function({target:{value:t}}){e(t)}}function J(e,t){return t!=null?function({target:{checked:a}}){e(a?t:false)}:function({target:{checked:t}}){e(t)}}function Q(e,t){if(e()!==t){e(t)}}function X({target:e}){e.select()}function ee({key:e}){if(e==="Enter"&&document.activeElement){document.activeElement.click()}}function te(e){const t=e.lastIndexOf(".");if(t===-1){return[e,""]}else{return[e.substring(0,t),e.substring(t)]}}function ae(e){const[t,a]=e.split(",");const n=t.indexOf("base64")>=0?atob(a):unescape(a);const l=t.substring(t.indexOf("data:")+5).split(";");const i=l[0];const s=n.length;const r=new Uint8Array(s);for(let e=0;e<s;e++){r[e]=n.charCodeAt(e)}return new Blob([r],{type:i})}function ne(e,t){return new File([e],t,{type:e.type})}function le(e,t,a){const n=ne(ae(e),t);return{guid:_(),name:n.name,path:"not_set",file:n,dataUrl:e,metadata:a}}function ie(e){const[,t]=te(e.name);switch(t.toLowerCase()){case".doc":case".docx":case".dot":case".wbk":case".docm":case".dotx":case".dotm":case".docb":case".txt":return O.wordDocIcn;case".webm":case".mkv":case".flv":case".vob":case".ogv":case".drc":case".gifv":case".mng":case".avi":case".mts":case".m2ts":case".mov":case".qt":case".wmv":case".yuv":case".rm":case".rmvb":case".viv":case".asf":case".amv":case".mp4":case".m4p":case".m4v":case".mpg":case".mp2":case".mpeg":case".mpe":case".mpv":case".m2v":case".svi":case".3gp":case".mxf":case".roq":case".nsv":case".f4v":case".f4p":case".f4a":case".f4b":return O.videoFileIcn;case".pdf":return O.pdfFileIcn;case".pcm":case".wav":case".aiff":case".mp3":case".aac":case".ogg":case".wma":case".flac":case".alac":return O.musicFileIcn;case".xls":case".xlt":case".xlm":case".xlsx":case".xlsm":case".xltx":case".xltm":case".xlsb":case".xla":case".xlam":case".xll":case".xlw":return O.excelFileIcn;case".html":case".js":case".css":case".scss":case".java":return O.codeFileIcn;case".jpg":case".jpeg":case".png":case".tiff":case".gif":case".svg":case".webp":return O.imageIcn;default:return O.fileIcn}}function se(e){return e&&e.includes("image")}function re(e){const t=Math.min(e.byteLength,64*1024);const a=new DataView(e,0,t);if(a.getUint16(0,false)!==65496){return-2}const n=a.byteLength;let l=2;while(l<n){const e=a.getUint16(l,false);l+=2;if(e===65505){l+=2;if(a.getUint32(l,false)!==1165519206){return-1}l+=6;const e=a.getUint16(l,false)===18761;l+=a.getUint32(l+4,e);const t=a.getUint16(l,e);l+=2;for(let n=0;n<t;n++){if(a.getUint16(l+n*12,e)===274){return a.getUint16(l+n*12+8,e)}}}else if((e&65280)!==65280){break}else{l+=a.getUint16(l,false)}}return-1}function oe(e){return new Promise(t=>{const a=new FileReader;a.onload=()=>{t(a.result)};a.readAsArrayBuffer(e)})}function de(e){return oe(e).then(re)}function ce(e,t,a,n){if(!n||n>8){return}switch(n){case 2:e.translate(t,0);e.scale(-1,1);return;case 3:e.translate(t,a);e.rotate(Math.PI);return;case 4:e.translate(0,a);e.scale(1,-1);return;case 5:e.rotate(.5*Math.PI);e.scale(1,-1);return;case 6:e.rotate(.5*Math.PI);e.translate(0,-a);return;case 7:e.rotate(.5*Math.PI);e.translate(t,-a);e.scale(-1,1);return;case 8:e.rotate(-.5*Math.PI);e.translate(-t,0);return}}function ue(e,t,a){if(e>t){if(e>a){return[a,Math.round(t*a/e)]}}else if(t>a){return[Math.round(e*a/t),a]}return[e,t]}function fe(e,t,a){if(!e.type.match(/image.*/)){return Promise.reject(new Error("File must be an image"))}return de(e).then(n=>new Promise(l=>{const i=new Image;i.onload=()=>{const e=document.createElement("canvas");const[s,r]=ue(i.width,i.height,t);if(n>4){e.width=r;e.height=s}else{e.width=s;e.height=r}const o=e.getContext("2d");ce(o,s,r,n);o.drawImage(i,0,0,s,r);l(e.toDataURL(a))};const s=new FileReader;s.onload=()=>i.src=s.result;s.readAsDataURL(e)}))}function he(e,t){return new Promise(a=>{const n=new Image;n.onload=()=>{const e=document.createElement("canvas");const[l,i]=ue(n.width,n.height,t);e.width=l;e.height=i;const s=e.getContext("2d");s.drawImage(n,0,0,l,i);a(e.toDataURL())};n.src=e})}function pe(e,t,a,n){const l=document.createElement("canvas");l.width=t;l.height=a;const i=.56*l.height;const s=l.getContext("2d");s.textBaseline="middle";s.font=`${i}px ${n}`;s.fillText(e,l.height*.05,i);return l.toDataURL()}function me(e,t,a){const n=A("signMaxSize",a);const l=.01*t*n;return pe(e,n,l,A("signFont",a))}class ge{view({attrs:{label:e,classes:t="bg-red"},children:a}){return d["default"](".relative.dib",[a,e?d["default"]("span.absolute.minw-65rem.ph1.nt1.nr1.top-0.right-0.br-pill.tc.f5.white.o-80",{class:t},e):null])}}class be{view({attrs:{label:e="",type:t="button",title:a=e,icon:n,rightIcon:l,context:i,classes:s="",style:r,disabled:o,onclick:c,tabindex:u}}){return d["default"]("button.button-reset",{type:t,title:a,disabled:o,class:`${s} ${o?p.disabledWrapper:"pointer"} ${v(i)} ${p.button}`,style:r,tabindex:u,onclick:c},Z({text:e,icon:n,rightIcon:l}))}}class ve{view({attrs:{label:e="",title:t=e,icon:a,rightIcon:n,href:l,rel:i,target:s,download:r,context:o,classes:c="",style:u}}){return d["default"]("a.link.flex.items-center",{href:l,rel:i,target:s,download:r,title:t,class:`${c} ${v(o)} ${p.button}`,style:u},Z({text:e,icon:a,rightIcon:n}))}}class ye{view({attrs:{label:e="",title:t=e,icon:a,rightIcon:n,classes:l="",style:i,disabled:s,onclick:r}}){return d["default"](".mh2.pa2.truncate",{title:t,disabled:s,class:`${l} ${s?p.disabledWrapper:"pointer"} ${p.navButton}`,style:i,onclick:r},Z({text:e,icon:a,rightIcon:n}))}}class xe{view({attrs:{label:e="",title:t=e,icon:a,rightIcon:n,href:l,rel:i,target:s,download:r,classes:o="",style:c}}){return d["default"]("a.link.mh2.pa2.truncate",{href:l,rel:i,target:s,download:r,title:t,class:`${o} ${p.navButton}`,style:c},Z({text:e,icon:a,rightIcon:n}))}}function we(e){switch(e){case"left":return{left:"initial",top:"initial",right:"calc(100% + 0.25rem)",bottom:"initial"};case"top":return{left:"initial",top:"initial",right:"initial",bottom:"calc(100% + 0.25rem)"};case"topRight":return{left:"calc(100%)",top:"initial",right:"initial",bottom:"calc(100%)"};case"topLeft":return{left:"initial",top:"initial",right:"calc(100%)",bottom:"calc(100%)"};case"bottom":return{left:"initial",top:"calc(100% + 0.25rem)",right:"initial",bottom:"initial"};case"bottomRight":return{left:"calc(100%)",top:"calc(100%)",right:"initial",bottom:"initial"};case"bottomLeft":return{left:"initial",top:"calc(100%)",right:"calc(100%)",bottom:"initial"};default:return{left:"calc(100% + 0.25rem)",top:"initial",right:"initial",bottom:"initial"}}}class Ie{constructor(){this.show=false}view({attrs:{message:e,direction:t="right",icon:a=O.tooltipIcon}}){return d["default"]("div",{class:p.tooltipWrapper},[d["default"](".flex.items-center.justify-center",{class:p.tooltipIconBackground,onmouseenter:()=>this.show=true,onmouseleave:()=>this.show=false},[d["default"]("i",{class:y([a,p.tooltipIcon])}),this.show&&d["default"]("div",{class:p.tooltipMessage,style:we(t)},e.map(e=>d["default"]("p.mv2",e)))])])}}class ke{view({attrs:{value:e}}){return d["default"](".pa2",{},d["default"].trust(e()))}}class Se{view({attrs:{field:e,value:t}}){const{label:a,uiClass:n={}}=e;return d["default"](".pa2.flex.flex-wrap",{class:w(n)},[Y(a),d["default"]("span.ws-normal",{title:t(),class:p.displayValue},t())])}}class Pe{formatter(e){return e?new Date(String(e)).toLocaleDateString():e}oninit({attrs:{value:e}}){this.formatted=e.map(this.formatter)}onremove(){this.formatted.end(true)}view({attrs:{field:e}}){return d["default"](Se,{field:e,value:this.formatted})}}function Te(e,t){if(e==="email"){return{href:`mailto:${t}`,class:p.displayValue}}else if(e==="tel"){return{href:`tel:${t}`,class:p.displayValue}}else{return{href:t,target:"_blank",class:p.displayValue}}}const $e={email:O.emailIcn,tel:O.telIcn};function Ce(e,t){if(e==="email"){return A("emailIcn",t)}else if(e==="tel"){return A("telIcn",t)}else{return A("linkIcn",t)}}class De{view({attrs:{field:e,value:t}}){const{label:a,type:n="url",uiClass:l={},config:i}=e;return d["default"](".pa2.flex.flex-wrap",{class:w(l)},[Y(a),d["default"]("a.link.dim.pointer.ws-normal",Te(n,t()),d["default"]("i.mr2",{class:Ce(n,i)}),t())])}}class qe{view({attrs:{selected:e,label:t,onIcon:a,offIcon:n,config:l}}){return d["default"](".flex.items-center.h-100",A("selectionLayout",l).map(i=>{switch(i){case"label":return t;case"icon":return R(e?a:n,"mh1");case"on":return d["default"]("span.mh1",{class:A(e?"selectionOnActive":"selectionOnInactive",l)},A("selectionOnLabel",l));case"off":return d["default"]("span.mh1",{class:A(e?"selectionOffInactive":"selectionOffActive",l)},A("selectionOffLabel",l))}}))}}class Le{constructor(){this.onIcon="checkIcn";this.offIcon="uncheckIcn"}view({attrs:{field:e,value:t}}){const{label:a,uiClass:n={},config:l}=e;return d["default"](".pa2",{class:w(n)},d["default"](qe,{selected:Boolean(t()),label:Y(a,"mh1 truncate"),onIcon:A(this.onIcon,l),offIcon:A(this.offIcon,l),config:l}))}}class Oe extends Le{constructor(){super(...arguments);this.onIcon="toggleOnIcn";this.offIcon="toggleOffIcn"}}function Fe(e,t){if(e.required){return t.length<1}return false}function Ae(e){return t=>{t.preventDefault();if(t.dataTransfer){t.dataTransfer.dropEffect="copy"}if(e()){t.redraw=false}e(true)}}function Ee(e){return t=>{t.preventDefault();e(false)}}function Me(e,t){return a=>{a.preventDefault();e(false);if(a.dataTransfer){t(a.dataTransfer.files)}}}function Be(e){return({target:{files:t}})=>e(t)}class Re{constructor(){this.showLabel=true}oncreate({dom:e,attrs:{value:t}}){t.map(t=>{if(t.length===0){e.firstChild.value=""}})}view({attrs:{field:e,defaultAccept:t="*",multiple:a=true,dragging:n,onSet:l},children:i}){const{label:s,id:r,name:c=r,title:u=W(s),required:f,readonly:h,disabled:p,autofocus:m,tabindex:g="0",accept:b=t,uiClass:v={}}=e;const y=this.showLabel&&s?G(r,v,s,f):null;return d["default"]("label.db",o["default"].extend({for:r,title:u,"aria-labelled-by":r,class:q(p,h),"data-input-id":r,tabindex:g,onkeydown:e=>{var t;if(e.key===" "){((t=document.activeElement)===null||t===void 0?void 0:t.firstElementChild).click()}}},p||h?{}:{ondragover:Ae(n),ondragleave:Ee(n),ondrop:Me(n,l)}),[d["default"]("input.clip[type=file].bg-transparent.bn.outline-0",{id:r,name:c,multiple:a,accept:b,required:f,autofocus:m,disabled:p||h,tabindex:-1,onchange:Be(l)}),y,i])}}function Ue(e,t=false){return a=>{const n=t?[]:e();o["default"].each(a,e=>{n.push({guid:_(),name:e.name,path:"not_set",file:e})});e(n)}}function _e(e,t){return a=>{a.preventDefault();const n=e();o["default"].remove(n,{guid:t});e(n)}}class Ne{constructor(){this.dragging=c["default"](false)}view({attrs:{field:e,value:t}}){const{disabled:a,uiClass:n={},config:l,readonly:i}=e;return d["default"]("div",{class:w(n,a)},[d["default"](Re,{field:e,dragging:this.dragging,onSet:Ue(t),value:t},d["default"](".pa2",{class:D(n,this.dragging(),Fe(e,t()))},[R(A("uploadIcn",l),"db mr2"),d["default"]("span",A("addFilesTxt",l))])),d["default"](".flex.flex-column.mt1.nb1",o["default"].map(t(),e=>d["default"]("span.pa2.mv1.ba.b--black-20.hide-child.dim.pointer",[R(A("downloadIcn",l),"db mr2"),e.name,!(i||a)&&d["default"]("i.child.fr",{title:`${A("remFileTtl",l)} ${e.name}`,onclick:_e(t,e.guid)},R(A("deleteIcn",l),"db"))])))])}}class We{view({children:e,attrs:t}){return d["default"](".relative.w-third.w-25-m.w-20-l.pa1.tc.hide-child",{tabindex:0,onkeydown:({key:e})=>{var t;if(e==="Enter"&&document.activeElement){(t=document.activeElement.querySelector("button"))===null||t===void 0?void 0:t.click()}}},[t.src&&t.src!=="not_set"?d["default"]("img.contain",{src:t.src}):null,t.data&&t.data.file&&(t.src==="not_set"||!t.src)?d["default"]("div.contain.tc.br5.6rem",{class:`${ie(t.data)} fa-2x`,tooltip:t.data.file.type}):null,e])}}class Ve{view({attrs:e}){return d["default"]("i.pa1",{class:ie(e),title:O.openFileTxt,onclick:e.path!=="not_set"?()=>window.open(e.path,"_blank"):undefined})}}class ze{view({attrs:{displayType:e="thumbnail",value:t,readonlyOrDisabled:a,config:n}}){return e==="thumbnail"?d["default"](".flex.flex-row.flex-wrap.mt1.nr1.nb1.nl1.max-h-thumb",o["default"].map(t(),e=>d["default"](We,{src:j(e.path,e.dataUrl),data:e},!a&&d["default"](".absolute.top-0.right-0.child",d["default"](be,{title:`Remove ${e.name}`,icon:A("deleteIcn",n),onclick:_e(t,e.guid),tabindex:-1}))))):d["default"](".pa2.flex.flex-column",o["default"].map(t(),e=>d["default"](".flex.items-center.pa1.ba.b--black-20",[R(A("uploadIcn",n),"pa1"),d["default"]("span.ma1.flex-auto",{title:e.name},e.name),d["default"](Ve,e),!a&&d["default"]("i.pa1.pointer.dim",{title:`Remove ${e.name}`,class:A("cancelIcn",n),onclick:_e(t,e.guid)})])))}}class je{view({attrs:{field:e,value:t}}){const{label:a,options:n,uiClass:l={}}=e;const i=o["default"].find(n,{value:t()});const s=i?i.label||i.value:t();return d["default"](".pa2.flex.flex-wrap",{class:w(l)},[Y(a),d["default"]("span.ws-normal",{title:s,class:p.displayValue},s)])}}class He{view({attrs:{field:e,value:t}}){const{label:a,uiClass:n={},config:l}=e;return d["default"](".pa2.flex.flex-column",{class:w(n)},[Y(a),d["default"](".flex.flex-column.mt1.nb1",o["default"].map(t(),({name:e,path:t})=>d["default"]("a.pa2.mv1.link.ba.b--black-20.dim.dib.pointer[target=_blank]",{class:p.displayValue,href:t},[R(A("downloadIcn",l),"db mr2"),e])))])}}class Ye{view({attrs:{field:e,value:t}}){const{label:a,uiClass:n={}}=e;return d["default"](".pa2.flex.flex-column",{class:w(n)},[Y(a),d["default"](".flex.flex-row.flex-wrap.mt1.nr1.nb1.nl1.max-h-thumb",o["default"].map(t(),({name:e,path:t,dataUrl:a})=>d["default"](We,{title:e,src:j(t,a)})))])}}class Ge{view({attrs:{field:e,value:t}}){const{label:a,uiClass:n={},config:l}=e;const i=o["default"].head(t());return d["default"](".pa2.flex.flex-column",{class:w(n)},[Y(a),i?d["default"]("img.img.h-100.max-h-img.mt2.contain.self-center",{title:i.name,src:j(i.path,i.dataUrl)}):d["default"]("i.mt2",{class:`${p.displayValue} ${A("imageIcn",l)}`})])}}function Ze(e,t){return(e.match(t)||[]).length}function Ke(e){let t=0;if(e.length>=8){t=1;if(e.length>=24){t=t+1}if(Ze(e,/[A-Z]/g)>1&&Ze(e,/[a-z]/g)>2){t=t+1}if(Ze(e,/\d/g)>1){t=t+1}if(Ze(e,/[!"£%^@#$&*]/g)>0){t=t+1}}return t}function Je(e){switch(e){case 0:{return"Invalid"}case 1:{return"Very Weak"}case 2:{return"Weak"}case 3:{return"Average"}case 4:{return"Strong"}case 5:{return"Very Strong"}}return""}const Qe=[{value:1,background:"bg-dark-red"},{value:2,background:"bg-orange"},{value:3,background:"bg-yellow"},{value:4,background:"bg-light-green"},{value:5,background:"bg-green"}];class Xe{oninit({attrs:{value:e}}){this.passwordScore=e.map(e=>Ke(String(e)))}onremove(){this.passwordScore.end()}view({attrs:{field:e}}){const{label:t}=e;return d["default"](".flex.flex-column",[Y(t),d["default"](".flex.mt1",o["default"].map(Qe,e=>d["default"](".h1.w-20",{class:this.passwordScore()>=e.value?e.background:"bg-transparent"}))),d["default"]("span.f5.truncate",Je(this.passwordScore()))])}}class et{view({attrs:{field:{label:e="",id:t,required:a,uiClass:n={}}}}){return d["default"]("div",{class:w(n)},G(t,n,e,a))}}class tt{constructor(){this._valueValid=true;this.selector="input"}get invalid(){return!this._valueValid}checkValidity(){const e=this._inputElement.checkValidity();if(e!==this._valueValid){this._valueValid=e;d["default"].redraw()}}oncreate({dom:e}){this._inputElement=e.querySelector(this.selector);this.checkValidity()}onupdate(){this.checkValidity()}}class at{view({attrs:e,children:t}){const{field:a,invalid:n}=e;const{label:l,id:i,type:s="text",required:r,disabled:o,uiClass:c={}}=a;return d["default"]("div",{class:s==="hidden"?"clip":w(c,o)},[G(i,c,l,r),d["default"]("fieldset.bn",{class:S(c,n)},t)])}}class nt{constructor(){this.focus=false;this.focusIn=()=>{this.focus=true};this.focusOut=()=>{this.focus=false}}shouldFloat(e,t,a=false){return e==="floatAlways"||this.focus||Boolean(t)||a}labelTranslateY(){return"calc(50% + 0.175ch - 1.5ex)"}labelContent(e,t){return typeof e==="string"?V(e,t):[V(e,t),z(e)]}view({attrs:e,children:t}){const{field:a,invalid:n,value:l,xform:i=l}=e;const{label:s,id:r,type:o="text",placeholder:c,required:u,disabled:f,readonly:h,uiClass:p={},config:m,layout:g=A("layoutType",m)}=a;const b=this.shouldFloat(g,c||i()!=null&&String(i()),h);return d["default"]("div",{class:`${o==="hidden"?"clip":w(p,f)} ${s?"pt2":""}`,onfocusin:this.focusIn,onfocusout:this.focusOut},d["default"]("fieldset.relative.pa0.ma0.w-100",{class:S(p,n)},[s?[d["default"]("legend.db.hidden.h-05ch.transition-mw",{class:`${I(p,u)} ${b?"mw-100":"mw-001px"}`},d["default"]("span.f-07em",this.labelContent(s,u))),d["default"](".absolute.h-100.top-0.transition-transform.pe-none",{style:{transform:`translateY(${b?"-1ch":this.labelTranslateY()})`}},d["default"]("label.db.transition-f",{for:r,title:typeof s==="string"?s:s.text,class:k(p,b,u)},this.labelContent(s,u)))]:null,t]))}}class lt{constructor(){this.layout=nt}view({attrs:e,children:t}){const{field:{config:a,layout:n=A("layoutType",a)}}=e;return d["default"](n==="default"?at:this.layout,e,t)}}class it extends nt{shouldFloat(){return true}}class st extends lt{constructor(){super(...arguments);this.layout=it}}const rt=new Set(["date","datetime-local","color","range"]);class ot extends tt{view({attrs:e}){const{field:t,value:a,xform:n=a}=e;const{label:l,id:i,type:s="text",name:r=i,title:o=W(l),placeholder:c,max:u,maxlength:f,min:h,minlength:p,step:m,required:g,readonly:b,disabled:v,autofocus:y,autocomplete:x,tabindex:w,pattern:I,inputmode:k,spellcheck:S,instant:T,uiClass:$={}}=t;const C=rt.has(s)?st:lt;return d["default"](C,{field:t,value:a,xform:n,invalid:this.invalid},d["default"]("input.w-100.bg-transparent.bn.outline-0",{id:i,type:s,name:r,title:o,placeholder:c,max:u,maxlength:f,min:h,minlength:p,step:m,required:g,readonly:b,disabled:v,autofocus:y,autocomplete:x,tabindex:w,pattern:I,inputmode:k,spellcheck:S,class:P($),value:n(),[T?"oninput":"onchange"]:K(a)}))}}class dt extends tt{view({attrs:e}){const{field:t,value:a,xform:n=a}=e;const{label:l,id:i,name:s=i,title:r=W(l),placeholder:c,max:u,maxlength:f,min:h,minlength:m,step:g,required:b,readonly:v,disabled:x,autofocus:w,autocomplete:I,tabindex:k,pattern:S,inputmode:T,spellcheck:$,uiClass:C={},config:D}=t;const q=A("currencySymbol",D);const L=A("negativeStyle",D);const O=A("badgePosition",D);const F=ut(n());return d["default"](st,{field:t,value:a,invalid:this.invalid},d["default"](".flex.flex-row.w-100",[d["default"]("span.self-center",{class:y([O==="left"?"order-0 mr1":"order-last ml1",P(C)])},q),d["default"]("input.w-100.bg-transparent.bn.outline-0",{id:i,type:"text",name:s,title:r,placeholder:c,max:u,maxlength:f,min:h,minlength:m,step:g,required:b,readonly:v,disabled:x,autofocus:w,autocomplete:I,tabindex:k,pattern:S,inputmode:T,spellcheck:$,class:y([O==="right"?"tr":"",L.includes("red")&&F<0?p.redNumber:null,P(C)]),onfocus:X,value:o["default"].isUndefined(n())?null:ct(F,L),onchange:mt(a)})]))}}function ct(e,t){const a=ht(e);if(e<0){if(t.toLowerCase().includes("parentheses")){return`(${a})`}else if(t!=="red"){return`-${a}`}}return a}function ut(e){return o["default"].isString(e)?o["default"].parseInt(e):Number(e)}function ft(e){const t=e.replace("(-","-").replace("(","-").replace(")","").replace(/[^\d.-]/g,"");let a;let n=0;if(t.indexOf(".")>-1){const e=t.indexOf(".");const l=t.substring(0,e);a=o["default"].parseInt(o["default"].padStart(l,1,"0"));const i=t.substring(e+1,Math.min(e+3,t.length));n=o["default"].parseInt(o["default"].padEnd(i,2,"0"))}else{a=o["default"].parseInt(t)||0}return a*100+n}function ht(e){const t=pt(e);if(t){return`${t[0]}.${t[1]}`}else{return t}}function pt(e){if(!o["default"].isFinite(e)){return undefined}const t=String(Math.abs(e));let a="0";let n="";if(t.length>2){const e=t.length-2;a=t.substring(0,e);n=t.substring(e)}else{n=o["default"].padStart(t,2,"0")}return[a,n]}function mt(e){return({target:{value:t}})=>e(ft(t))}class gt extends tt{view({attrs:e}){const{field:t,value:a,xform:n=a}=e;const{label:l,id:i,name:s=i,title:r=W(l),placeholder:o,max:c,maxlength:u,min:f,minlength:h,step:p,required:m,readonly:g,disabled:b,autofocus:v,autocomplete:x,tabindex:w,pattern:I,inputmode:k,spellcheck:S,instant:T,uiClass:$={},config:C}=t;const D=A("badgePosition",C);return d["default"](st,{field:t,value:a,invalid:this.invalid},d["default"](".flex.flex-row.w-100",[d["default"]("span.self-center",{class:y([D==="left"?"order-0 mr1":"order-last ml1",P($)])},"%"),d["default"]("input.w-100.bg-transparent.bn.outline-0",{id:i,type:"number",name:s,title:r,placeholder:o,max:c,maxlength:u,min:f,minlength:h,step:p,required:m,readonly:g,disabled:b,autofocus:v,autocomplete:x,tabindex:w,pattern:I,inputmode:k,spellcheck:S,class:y([D==="right"?"tr":"",P($)]),onfocus:X,value:n(),[T?"oninput":"onchange"]:K(a)})]))}}function bt(e){switch(e){case"day":return"dd";case"month":return"mm";case"year":return"yyyy"}}function vt(e,t,a){const n=e.querySelector(`#${t}-${a}`);n.focus()}function yt(e){const t=e?e.toLocaleLowerCase():"";if(t.includes("month")){return"mm"}else if(t.includes("day")){return"dd"}else if(t.includes("year")){return"yy"}else{return null}}function xt(e,t,a){const n=e.querySelector(`#${t}-${a}`);n.focus();n.select()}function wt(e){return parseInt(e.getAttribute("maxlength"))}function It(e,t,a,n,l,i,{next:s,prev:r}){const o=n.querySelector(`#${e}-${t}`);const d=wt(o);if((l.key==="Backspace"||l.key==="Delete")&&a.length===0&&r){xt(n,e,r);l.preventDefault()}else if(i.charCodeAt(0)===l.key.charCodeAt(0)&&s&&a.length!==0&&a.length<d){xt(n,e,s);l.preventDefault()}}function kt(e,t,a,n,l,i){if(Pt(a,n,l)&&e){i(t)}else{i("")}}function St(e){const t=String(e());if(t.length===1&&t!=="0"){e(`0${t}`)}}function Pt(e,t,a){const n=!a?2:4;return e.length===n&&t.length===2&&(!a||a.length===2)}function Tt(e){if(e.includes("month")){return"month"}else if(e.includes("day")){return"day"}return"date"}function $t(e,t,a){if(e.invalidExplanation){if(a){return""}else{return`Please check the ${Tt(e.invalidExplanation)}.`}}else if(!e.year||Number(t)<1900){return"Year must be greater than 1900."}return""}function Ct(e,t,a){if(!a){if(!t&&!e){return""}else if(t.length!==2||Number(t)>12){return`Please check the month.`}else if(e.length!==2){return`Please check the year.`}}return""}function Dt(e,t){if(t){const a=yt(e);t.querySelectorAll("input").forEach(t=>{if(a&&t.id.substring(t.id.length-2)===a&&e){t.setCustomValidity(e)}else{t.setCustomValidity("")}})}}function qt(e,t,a,n){const l=t.length===2&&e.length===2&&Number(t)<=12&&Number(t)>0||!e&&!t&&!a;Dt(Ct(e,t,l),n);return l}function Lt(e,t,a,n,i){const s=l.DateTime.fromObject({year:Number(e),month:Number(t),day:Number(a)});const r=!e&&!t&&!a;Dt($t(s,e,r),i);return s.isValid&&Number(e)>=1900||r&&!n}function Ot(e,t,a,n,l){const i=n.querySelector(`#${t}-${a}`);const s=e()||"";const r=i.value;const o=/^\d*$/.test(r);if((o||r==="")&&r.length<=4){e(r)}else{e(s)}if(String(e()).length===wt(i)&&l){xt(n,t,l)}}class Ft{view({attrs:e}){const{id:t}=e.field;return d["default"]("input.dn",{id:t})}}class At{constructor(){this.dom=c["default"]();this.valid=c["default"]();this.focusedInput=c["default"]("mm");this.month=c["default"]("");this.year=c["default"]("");this.date=c["default"]("")}buildDate(e,t){this.date(`${this.month()}/${this.year()}`);const a=qt(this.year(),this.month(),e,this.dom());kt(a,this.date(),this.year(),this.month(),"",t)}oninit({attrs:{value:e,field:t}}){this.valid(!t.required);e.map(e=>{if(e){this.date("");const[t,a]=String(e).split("/");this.month(t);this.year(a)}else if(!this.date()){this.month("");this.year("")}this.valid(qt(this.year(),this.month(),Boolean(t.required),this.dom()))})}oncreate({dom:e}){Q(this.dom,e)}onupdate({dom:e}){Q(this.dom,e)}onremove(){this.date.end(true);this.year.end(true);this.month.end(true)}view({attrs:e}){const{field:t,value:a}=e;const{id:n,name:l=n,required:i,readonly:s,disabled:r,tabindex:c,uiClass:u={}}=t;const f=P(u);return d["default"](st,{value:a,field:t,invalid:!this.valid()},d["default"](".flex.ph-2px.pv-1px",{onclick:()=>vt(this.dom(),n,this.focusedInput())},d["default"]("span",[d["default"]("input.w-100.mw-mm.pa0.bg-transparent.bn.outline-0.tc",{id:`${n}-mm`,name:`${l}-mm`,type:"text",placeholder:"MM",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:i,readonly:s,disabled:r,tabindex:c,"aria-label":`${l}: Month`,value:this.month(),class:f,onfocus:o["default"].partial(this.focusedInput,"mm"),oninput:()=>{Ot(this.month,n,"mm",this.dom(),"yy");this.buildDate(Boolean(t.required),e.value)},onkeydown:e=>{It(n,"mm",this.month(),this.dom(),e,"/",{next:"yy"})},onblur:()=>{St(this.month);this.buildDate(Boolean(t.required),e.value)}})]),d["default"]("span.pa0.mr-2px","/"),d["default"]("span",[d["default"]("input.w-100.mw-yy.pa0.bg-transparent.bn.outline-0.tc",{id:`${n}-yy`,name:`${l}-yy`,type:"text",placeholder:"YY",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:i,readonly:s,disabled:r,tabindex:c,"aria-label":`${l}: Year`,value:this.year(),class:f,onfocus:o["default"].partial(this.focusedInput,"yy"),onkeydown:e=>{It(n,"yy",this.year(),this.dom(),e,"/",{prev:"mm"})},oninput:()=>{Ot(this.year,n,"yy",this.dom());this.buildDate(Boolean(t.required),e.value)}}),d["default"](Ft,e)])))}}function Et(e){return[String(e.getFullYear()),o["default"].padStart(String(1+e.getMonth()),2,"0"),o["default"].padStart(String(e.getDate()),2,"0")]}class Mt{oncreate({dom:e,attrs:{field:{max:t,min:a},value:n}}){this.flatpickr=u["default"](e,{position:"below right",disableMobile:true,minDate:a,maxDate:t,onChange:([e])=>{if(e){n(Et(e).join("-"));d["default"].redraw()}}});this.valueChange=n.map(e=>{const t=new Date(String(e));if(isNaN(t.valueOf())){this.flatpickr.clear()}else{this.flatpickr.setDate(t,false)}})}onremove(){this.flatpickr.destroy();this.valueChange.end(true)}view({attrs:{field:{config:e}}}){return R(A("datePickerIcn",e),"ph-2px pv-1px")}}class Bt{constructor(){this.dom=c["default"]();this.valid=c["default"]();this.focusedInput=c["default"](undefined);this.locale=c["default"](undefined);this.literalKey=c["default"]("/");this.day=c["default"]("");this.month=c["default"]("");this.year=c["default"]("");this.date=c["default"]()}buildDate(e,t=false){this.date(`${this.year()}-${this.month()}-${this.day()}`);const a=Lt(this.year(),this.month(),this.day(),t,this.dom());kt(a,this.date(),this.year(),this.month(),this.day(),e)}findNextInput(e){const t=this.dateInputAdvanceOrder.indexOf(e);return t!==this.dateInputAdvanceOrder.length&&bt(this.dateInputAdvanceOrder[this.dateInputAdvanceOrder.indexOf(e)+1])}findPrevInput(e){const t=this.dateInputAdvanceOrder.indexOf(e);return t!==0&&bt(this.dateInputAdvanceOrder[this.dateInputAdvanceOrder.indexOf(e)-1])}setDateInputs(e){const t=new Intl.DateTimeFormat(e).formatToParts();this.dateParts=t;const a=t[0].type;this.literalKey(t[1].value);const n=bt(a);this.focusedInput(n);this.dateInputAdvanceOrder=o["default"](this.dateParts).map(({type:e})=>e).filter(e=>e!=="literal").value()}setLocale(e){const t=A("dateLocale",e);if(t!==this.locale()){this.locale(t)}}createDateInputs({type:e,value:t},{attrs:{field:{id:a,name:n=a,required:l,readonly:i,disabled:s,tabindex:r,uiClass:c={}},value:u}}){const f=P(c);switch(e){case"literal":return d["default"]("span.pa0.mr-2px",t);case"day":return d["default"]("span",d["default"]("input.w-100.mw-dd.pa0.bg-transparent.bn.outline-0.tc",{id:`${a}-dd`,name:`${n}-dd`,type:"text",placeholder:"DD",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:l,readonly:i,disabled:s,tabindex:r,value:this.day(),"aria-label":`${n}: Day`,class:`${f} maxw-dd p-0px`,onfocus:o["default"].partial(this.focusedInput,"dd"),onkeydown:e=>{It(a,"dd",this.day(),this.dom(),e,this.literalKey(),{next:this.findNextInput("day"),prev:this.findPrevInput("day")})},oninput:()=>{Ot(this.day,a,"dd",this.dom(),this.findNextInput("day"));this.buildDate(u,l)},onblur:()=>{St(this.day);this.buildDate(u,l)}}));case"month":return d["default"]("span",d["default"]("input.w-100.mw-mm.pa0.bg-transparent.bn.outline-0.tc",{id:`${a}-mm`,name:`${n}-mm`,type:"text",placeholder:"MM",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:l,readonly:i,disabled:s,tabindex:r,value:this.month(),"aria-label":`${n}: Month`,class:`${f} maxw-mm p-0px`,onkeydown:e=>{It(a,"mm",this.month(),this.dom(),e,this.literalKey(),{next:this.findNextInput("month"),prev:this.findPrevInput("month")})},oninput:()=>{Ot(this.month,a,"mm",this.dom(),this.findNextInput("month"));this.buildDate(u,l)},onfocus:o["default"].partial(this.focusedInput,"mm"),onblur:()=>{St(this.month);this.buildDate(u,l)}}));case"year":return d["default"]("span",d["default"]("input.w-100.mw-yyyy.pa0.bg-transparent.bn.outline-0.tc",{id:`${a}-yyyy`,name:`${n}-yyyy`,type:"text",placeholder:"YYYY",minlength:"4",maxlength:"4",pattern:"[0-9]*",inputmode:"numeric",required:l,readonly:i,disabled:s,tabindex:r,value:this.year(),"aria-label":`${n}: Year`,class:`${f} maxw-yyyy p-0px`,onfocus:o["default"].partial(this.focusedInput,"yyyy"),onkeydown:e=>{It(a,"yyyy",this.year(),this.dom(),e,this.literalKey(),{next:this.findNextInput("year"),prev:this.findPrevInput("year")})},oninput:()=>{Ot(this.year,a,"yyyy",this.dom(),this.findNextInput("year"));this.buildDate(u,l)}}))}}resetDateParts(){this.day("");this.month("");this.year("")}oninit({attrs:{value:e,field:{required:t,config:a}}}){this.valid(!t);this.valueChange=e.map(e=>{if(e){const t=new Date(String(e));this.date("");if(isNaN(t.valueOf())){this.resetDateParts()}else{const[e,a,n]=Et(t);this.day(n);this.month(a);this.year(e)}}else if(!this.date()){this.resetDateParts()}this.valid(Lt(this.year(),this.month(),this.day(),Boolean(t),this.dom()))});this.locale.map(e=>{this.setDateInputs(e)});this.setLocale(a)}oncreate({dom:e}){Q(this.dom,e)}onbeforeupdate({attrs:{field:{required:e,config:t}}}){this.setLocale(t);this.valid(Lt(this.year(),this.month(),this.day(),Boolean(e),this.dom()))}onupdate({dom:e}){Q(this.dom,e)}onremove(){this.valueChange.end(true);this.date.end(true);this.year.end(true);this.month.end(true);this.day.end(true);this.locale.end(true)}view(e){const{attrs:{field:t,value:a}}=e;const{id:n,disabled:l,readonly:i}=t;return d["default"](st,{value:a,field:t,invalid:!this.valid()},d["default"](".flex",[d["default"](".flex-auto.ph-2px.pv-1px",{onclick:()=>vt(this.dom(),n,this.focusedInput())},this.dateParts.map(t=>this.createDateInputs(t,e)),d["default"](Ft,e.attrs)),!(l||i)&&d["default"](Mt,{field:t,value:a})]))}}class Rt extends tt{constructor(){super(...arguments);this.showPassword=c["default"](false)}view({attrs:e}){const{field:t,value:a}=e;const{label:n,id:l,name:i=l,title:s=W(n),placeholder:r,maxlength:o,minlength:c,required:u,readonly:f,disabled:h,autofocus:p,autocomplete:m,tabindex:g,pattern:b,inputmode:v,instant:y,uiClass:x={},config:w}=t;return d["default"](lt,{field:t,value:a,invalid:this.invalid},d["default"](".flex.flex-row.w-100",[d["default"]("input.w-100.bg-transparent.bn.outline-0",{id:l,name:i,title:s,placeholder:r,type:this.showPassword()?"text":"password",maxlength:o,minlength:c,required:u,readonly:f,disabled:h,autofocus:p,autocomplete:m,tabindex:g,pattern:b,inputmode:v,class:P(x),value:a(),autocorrect:"off",[y?"oninput":"onchange"]:K(a)}),d["default"](".ml1.pointer.dim",{title:A("showPassTxt",w),onclick:()=>this.showPassword(!this.showPassword()),tabindex:0,onkeydown:ee},R(A(this.showPassword()?"hidePassIcn":"showPassIcn",w),"db pa1"))]))}}class Ut extends nt{labelTranslateY(){return"0.5ex"}}class _t extends lt{constructor(){super(...arguments);this.layout=Ut}}class Nt extends tt{constructor(){super(...arguments);this.selector="textarea"}view({attrs:e}){const{field:t,value:a,xform:n=a}=e;const{label:l,id:i,name:s=i,title:r=W(l),placeholder:o,required:c,readonly:u,disabled:f,autofocus:h,autocomplete:p,minlength:m,maxlength:g,tabindex:b,spellcheck:v,rows:y,cols:x,wrap:w,instant:I,uiClass:k={}}=e.field;return d["default"](_t,{field:t,value:a,xform:n,invalid:this.invalid},d["default"]("textarea.w-100.bg-transparent.bn.outline-0.h-100.resize-none",{id:i,name:s,title:r,placeholder:o,required:c,readonly:u,disabled:f,autofocus:h,autocomplete:p,minlength:m,maxlength:g,tabindex:b,spellcheck:v,rows:y,cols:x,wrap:w,class:$(k),value:a(),[I?"oninput":"onchange"]:K(a)}))}}class Wt{constructor(){this.onIcon="checkIcn";this.offIcon="uncheckIcn"}view({attrs:{field:e,value:t}}){const{label:a,id:n,name:l=n,value:i,title:s=W(a),required:r,readonly:o,disabled:c,autocomplete:u,tabindex:f="0",uiClass:h={},config:m}=e;return d["default"]("div",{class:w(h,c)},d["default"]("fieldset.w-100.bn",{class:S(h)},[d["default"]("input.clip[type=checkbox]",{id:n,name:l,value:i,checked:t(),required:r,autocomplete:u,disabled:c||o,tabindex:-1,"aria-hidden":"true",onchange:J(t,i)}),d["default"]("label.db",{class:y([T(h,c,o),r&&!t()?p.invalidCheckboxWrapper:""]),for:n,title:s,"data-input-id":n,"aria-label":a,tabindex:f,onkeydown:e=>{if(e.key===" "){t(!t())}}},d["default"](qe,{selected:Boolean(t()),label:a?d["default"]("span.mh1",V(a,r)):null,onIcon:A(this.onIcon,m),offIcon:A(this.offIcon,m),config:m}))]))}}class Vt{constructor(){this.onIcon="toggleOnIcn";this.offIcon="toggleOffIcn"}view({attrs:{field:e,value:t}}){const{label:a,id:n,name:l=n,value:i,title:s=W(a),required:r,readonly:o,disabled:c,autocomplete:u,tabindex:f="0",uiClass:h={},config:m}=e;const g=Boolean(t());return d["default"]("div",{class:w(h,c)},d["default"]("fieldset.w-100.bn",{class:S(h)},[d["default"]("input.clip[type=checkbox]",{id:n,name:l,value:i,checked:t(),required:r,autocomplete:u,disabled:c||o,tabindex:-1,"aria-hidden":"true",onchange:J(t,i)}),d["default"]("label.db.flex.justify-content.items-center",{class:y([T(h,c,o),r&&!t()?p.invalidCheckboxWrapper:""]),for:n,title:s,"data-input-id":n,"aria-label":a,tabindex:f,onkeydown:e=>{if(e.key===" "){t(!t())}}},[d["default"](".toggle-outer.relative.dib.transition-bg",{class:g?A("toggleOnWrapper",m):A("toggleOffWrapper",m)},R(A(g?this.onIcon:this.offIcon,m),y(["toggle-inner absolute tc transition-transform",g?"toggle-on":null]))),a?d["default"]("span.mh1",V(a,r)):null])]))}}class zt{view({attrs:e}){const{field:t,value:a}=e;const{label:n,id:l,name:i,value:s,title:r=W(n),required:o,readonly:c,disabled:u,autocomplete:f,tabindex:h="0",uiClass:p={},config:m}=t;const g=a()===s;return d["default"]("div",{class:w(p,u)},d["default"]("fieldset.w-100.bn",{class:S(p)},[d["default"]("input.clip[type=radio]",{id:l,name:i,value:s,checked:g,required:o,autocomplete:f,disabled:u||c,tabindex:-1,"aria-hidden":"true",onchange:K(a)}),d["default"]("label.db",{class:T(p,u,c),for:l,title:r,"data-input-id":l,"aria-label":n,tabindex:h,onkeydown:e=>{var t;if(e.key===" "){((t=document.activeElement)===null||t===void 0?void 0:t.firstElementChild).click()}}},d["default"](qe,{selected:g,label:n?d["default"]("span.mh1",V(n,o)):null,onIcon:A("radioOnIcn",m),offIcon:A("radioOffIcn",m),config:m}))]))}}class jt extends tt{constructor(){super(...arguments);this.selector="select"}view({attrs:e}){const{field:t,value:a}=e;const{label:n,id:l,name:i=l,title:s=n,required:r,readonly:c,disabled:u,autofocus:f,autocomplete:h,tabindex:p,uiClass:m={},placeholder:g="--- Select one ---",options:b=[]}=t;return d["default"](st,{field:t,value:a,invalid:this.invalid},[n?null:d["default"]("legend.screenreader",{id:`${l}-legend`},"Select one"),d["default"]("select.w-100.bg-transparent.bn.outline-0",{id:l,name:i,title:s,required:r,autofocus:f,autocomplete:h,tabindex:p,disabled:u||c,class:P(m),value:a()?a():"",onchange:K(a),"aria-labelledby":`${l}-legend`},[o["default"].some(b,({value:e})=>!e)?null:d["default"]("option",{disabled:true,value:""},g),o["default"].map(b,({value:e,label:t=e})=>d["default"]("option",{value:e,disabled:u||c},t))])])}}class Ht{constructor(){this.dragging=c["default"](false)}view({attrs:{field:e,value:t,displayType:a}}){const n=o["default"].head(t());const{disabled:l,uiClass:i={},config:s,readonly:r}=e;const c=a==="none"||!n?A("addFileTxt",s):n.name;return d["default"]("div",{class:w(i,l)},d["default"](Re,{field:e,multiple:false,dragging:this.dragging,onSet:Ue(t,true),value:t},d["default"](".flex.items-center.pa1",{class:D(i,this.dragging(),Fe(e,t()))},[R(A("uploadIcn",s),"pa1"),d["default"]("span.ma1.flex-auto",c),n&&a!=="none"?[d["default"](Ve,n),!(r||l)&&d["default"]("i.pa1.pointer.dim",{title:`Remove ${n.name}`,class:A("cancelIcn",s),onclick:_e(t,n.guid)})]:null])))}}function Yt(e,t,a=false){return n=>{const l=a?[]:e();return Promise.all(o["default"].map(n,e=>fe(e,t,e.type).then(t=>{const a=ne(ae(t),e.name);l.push({guid:_(),name:a.name,path:"not_set",file:a,dataUrl:t})}))).then(()=>{e(l);d["default"].redraw()})}}class Gt{constructor(){this.dragging=c["default"](false)}view({attrs:{field:e,value:t}}){const{disabled:a,uiClass:n={},config:l,readonly:i}=e;return d["default"]("div",{class:w(n,a)},[d["default"](Re,{field:e,defaultAccept:"image/*",dragging:this.dragging,onSet:Yt(t,A("imageMaxSize",l)),value:t},d["default"](".w-100.pa1.dt.tc",{class:D(n,this.dragging(),Fe(e,t()))},d["default"]("i.fa-2x.dtc.v-mid",{class:A("cameraIcn",l)}))),d["default"](".flex.flex-row.flex-wrap.mt1.nr1.nb1.nl1.max-h-thumb",o["default"].map(t(),e=>d["default"](We,{src:j(e.path,e.dataUrl)},!(i||a)&&d["default"](".absolute.top-0.right-0.child",d["default"](be,{title:`Remove ${e.name}`,icon:A("deleteIcn",l),onclick:_e(t,e.guid)})))))])}}class Zt{constructor(){this.dragging=c["default"](false)}view({attrs:{field:e,value:t}}){const a=o["default"].head(t());const{disabled:n,uiClass:l={},config:i,readonly:s}=e;return d["default"]("div",{class:w(l,n)},d["default"](Re,{field:e,defaultAccept:"image/*",multiple:false,dragging:this.dragging,onSet:Yt(t,A("imageMaxSize",i),true),value:t},d["default"](".pa1",{class:D(l,this.dragging(),Fe(e,t()))},d["default"](".relative.w-100.dt.tc",a?[d["default"]("img.img.contain.max-h-img",{title:a.name,src:j(a.path,a.dataUrl)}),!(s||n)&&d["default"](".absolute.top-0.right-0.pa1.pointer.dim",{title:`Remove ${a.name}`,onclick:_e(t,a.guid)},d["default"]("i.pa1",{class:A("cancelIcn",i)}))]:d["default"]("i.fa-2x.dtc.v-mid",{class:A("cameraIcn",i)})))))}}class Kt{oncreate({dom:e}){const t=e.children[0];const a=N();this.signaturePad=new f["default"](t,{minWidth:.5*a,maxWidth:1.5*a});const n=()=>{const e=N();t.width=t.offsetWidth*e;t.height=t.offsetHeight*e;const a=t.getContext("2d");a.scale(e,e);this.resetCanvas()};this.resizeHandler=o["default"].debounce(n,250);window.addEventListener("resize",this.resizeHandler);window.addEventListener("orientationchange",this.resizeHandler);n()}onremove(){this.resizeHandler.cancel();window.removeEventListener("resize",this.resizeHandler);window.removeEventListener("orientationchange",this.resizeHandler)}view({attrs:{style:e,config:t,onSet:a,onCancel:n}}){return[d["default"](".aspect-ratio.bg-white.ba.bw1.br3.b--dashed.b--black-30",{style:e},d["default"]("canvas.aspect-ratio--object")),d["default"](".absolute.top-0.right-0.z-999.translate-up-100",[d["default"](be,{title:A("applyTtl",t),icon:A("applyIcn",t),classes:"ma1",onclick:()=>{if(!this.signaturePad.isEmpty()){a(this.signaturePad.toDataURL("image/png"))}}}),d["default"](be,{title:A("resetTtl",t),icon:A("resetIcn",t),classes:"ma1",onclick:()=>this.resetCanvas()}),d["default"](be,{title:A("cancelTtl",t),icon:A("cancelIcn",t),classes:"ma1",onclick:n})])]}resetCanvas(){this.signaturePad.clear()}}class Jt{constructor(){this.text=c["default"]("")}oncreate({dom:e}){const t=e.children[0];t.focus({preventScroll:false});this.scaleText(e)}onupdate({dom:e}){this.scaleText(e)}view({attrs:{heightPct:e,style:t,config:a,onSet:n,onCancel:l}}){const i=o["default"].flow([o["default"].partial(me,this.text(),e,a),o["default"].partialRight(n,{text:this.text(),heightPct:e}),o["default"].stubFalse]);return[d["default"]("form.aspect-ratio.ba.bw1.br3.b--dashed.b--black-30",{style:t,onsubmit:i},d["default"]("input.aspect-ratio--object.pa2.ba.bw0[type=text]",{oninput:K(this.text),style:{fontFamily:A("signFont",a)},value:this.text()})),d["default"](".absolute.top-0.right-0.z-999.translate-up-100",[d["default"](be,{title:A("applyTtl",a),icon:A("applyIcn",a),classes:"ma1",onclick:i}),d["default"](be,{title:A("resetTtl",a),icon:A("resetIcn",a),classes:"ma1",onclick:()=>this.text("")}),d["default"](be,{title:A("cancelTtl",a),icon:A("cancelIcn",a),classes:"ma1",onclick:l})])]}scaleText(e){const t=e.clientHeight;e.style.fontSize=`${.56*t}px`}}class Qt{view({attrs:{heightPct:e,stampTxt:t,stampSetTxt:a,config:n,onSet:l}}){return[d["default"]("span.clip",{style:{fontFamily:A("signFont",n)}},a),d["default"](".flex",d["default"](be,{label:t,classes:`flex-auto ${A("stampBtnClass",n)}`,context:A("stampBtnContext",n),onclick:o["default"].flow([o["default"].partial(me,a,e,n),o["default"].partialRight(l,{text:a,heightPct:e})])}))]}}const Xt={["draw"]:Kt,["type"]:Jt,["stamp"]:Qt};function ea(e,t,a){return(n,l)=>he(n,a).then(a=>{e([le(a,`sign-${t}.png`,l)]);d["default"].redraw()})}class ta{oninit({attrs:{value:e}}){this.valUpdate=e.map(()=>this.setSignType())}onremove(){this.valUpdate.end()}view({attrs:{field:e,value:t}}){const{label:a,id:n,readonly:l,disabled:i,tabindex:s="0",uiClass:r={},config:c,options:u,heightPct:f=A("signHeightPct",c),stampTxt:h=A("stampTxt",c),stampSetTxt:m=A("stampSetTxt",c)}=e;const g={paddingBottom:`${f}%`};const b=o["default"].head(t());const v=u?o["default"](u).map(({value:e})=>String(e)in Xt?e:null).compact().value():A("signOpts",c);const y=o["default"].map(v,e=>{switch(e){case"draw":return{type:e,icon:A("drawIcn",c),label:A("signDrawTxt",c)};case"type":return{type:e,icon:A("typeIcn",c),label:A("signTypeTxt",c)};case"stamp":return{type:e,icon:A("stampIcn",c),label:A("signStampTxt",c)}}});if(y.length===1&&!b){this.setSignType(y[0].type)}return d["default"]("div.relative",{class:w(r,i)},[G(n,r,a),l||i?d["default"](".aspect-ratio",{id:n,style:g},b?d["default"](".aspect-ratio--object",{class:"pe-none"},d["default"]("img.img.w-100.absolute",{src:j(b.path,b.dataUrl)})):null):this.signType?d["default"](Xt[this.signType],{heightPct:f,stampTxt:h,stampSetTxt:m,style:g,config:c,onSet:ea(t,n,A("signMaxSize",c)),onCancel:o["default"].bind(this.setSignType,this,undefined)}):d["default"](".aspect-ratio.pointer",{id:n,class:p.fileInputWrapper,style:g},b?d["default"](".aspect-ratio--object.dim",{onclick:o["default"].bind(t,this,[])},[d["default"]("img.img.w-100.absolute",{src:j(b.path,b.dataUrl)}),d["default"](".absolute.top-1.right-1",d["default"]("i.fa-2x",{class:A("resetIcn",c),tabindex:0,onkeydown:ee}))]):d["default"](".aspect-ratio--object.flex",o["default"].map(y,({type:e,icon:t,label:a})=>d["default"](".flex-auto.flex.items-center.justify-center.dim",{title:a,tabindex:s,onkeydown:ee,onclick:o["default"].bind(this.setSignType,this,e)},R(t,"fa-2x ma1"),d["default"]("span.ma1.dn.db-ns.truncate",a)))))])}setSignType(e){this.signType=e}}function aa(e,t){return a=>{const n=t?[]:e();return Promise.all(o["default"].map(a,e=>{if(se(e.type)){return fe(e,O.imageMaxSize,e.type).then(t=>{const a=ne(ae(t),e.name);n.push({guid:_(),name:a.name,path:"not_set",file:a,dataUrl:t})})}else{n.push({guid:_(),name:e.name,path:"not_set",file:e});return Promise.resolve()}})).then(()=>{e(n);d["default"].redraw()})}}class na{constructor(){this.dragging=c["default"](false)}view({attrs:e}){const{field:t,value:a}=e;const{disabled:n,uiClass:l={}}=t;return d["default"]("div",{class:w(l,n)},d["default"](Re,{field:t,value:a,multiple:false,dragging:this.dragging,onSet:aa(a,true)},d["default"](".flex.items-center.pa1",{class:D(l,this.dragging(),Fe(t,a()))},this.innerComponent(e))))}innerComponent({field:{disabled:e,config:t,readonly:a},value:n}){const l=o["default"].head(n());if(l){if(l.dataUrl){return d["default"](".relative.w-100.dt.tc",d["default"]("img.img.contain.max-h-img",{title:l.name,src:j(l.path,l.dataUrl)}),!(a||e)&&d["default"](".absolute.top-0.right-0.pa1.pointer.dim",{title:`Remove ${l.name}`,onclick:_e(n,l.guid)},d["default"]("i.pa1",{class:A("cancelIcn",t)})))}else{return[d["default"](Ve,l),d["default"]("span.ma1.flex-auto",{title:l.name},l.name),!(a||e)&&d["default"]("i.pa1.pointer.dim",{title:`Remove ${l.name}`,class:A("cancelIcn",t),onclick:_e(n,l.guid),onkeydown:ee,tabindex:0})]}}else{return[R(A("uploadIcn",t),"pa1"),d["default"]("span.ma1",A("addFileTxt",t))]}}}class la{constructor(){this.dragging=c["default"](false)}view({attrs:{field:e,value:t,displayType:a,showDisplay:n=true}}){const{disabled:l,uiClass:i={},config:s,readonly:r}=e;return d["default"]("div",{class:w(i,l)},[d["default"](Re,{field:e,value:t,dragging:this.dragging,onSet:aa(t,false)},d["default"](".flex.items-center.pa1.dt",{class:D(i,this.dragging(),Fe(e,t()))},[R(A("uploadIcn",s),"pa1"),d["default"]("span.ma1.flex-auto",A("addFileTxt",s))])),n?d["default"](ze,{displayType:a,value:t,readonlyOrDisabled:l||r,config:s}):null])}}class ia extends Re{constructor(){super(...arguments);this.showLabel=false}}class sa{constructor(){this.dragging=c["default"](false)}view({attrs:{field:e,value:t}}){const{id:a,required:n,uiClass:l={},config:i,label:s={text:"Add File",icon:A("uploadIcn",i)}}=e;return[G(a,l,s,n),d["default"]("div",{class:`${D(l,this.dragging(),Fe(e,t()))} ${v()} ${p.button}`},d["default"](ia,{field:e,multiple:false,dragging:this.dragging,onSet:Ue(t,true),value:t},d["default"](".flex.items-center",typeof s==="string"?Z({text:s,icon:A("uploadIcn",i)}):Z(s))))]}}class ra{oncreate({dom:e}){this.container=e}onbeforeupdate({attrs:{visible:e}},{attrs:{visible:t}}){if(e===t){return e}else{this.container.style.height=e?"auto":this.container.getBoundingClientRect().height+"px";return true}}view({attrs:{items:e,idx:t,visible:a,component:n}}){return d["default"]("div",{"data-idx":t},a?e.map(e=>d["default"](n,e)):null)}}class oa{constructor(){this.scrollHandler=o["default"].throttle(e=>{const t=e.scrollTop/e.scrollHeight||0;this.controller.updateScroll(t)},50,{leading:false})}oninit({attrs:{controller:e}}){this.controller=e}view({attrs:{classes:e,component:t}}){return d["default"](".overflow-y-auto",{class:e,onscroll:e=>{e.redraw=false;this.scrollHandler(e.target)}},this.controller.render(({items:e,idx:a,visible:n})=>d["default"](ra,{items:e,idx:a,visible:n,component:t})))}}class da{static clampRange(e,t,a){return Math.max(e,Math.min(t,a))}static single(e){const t=new da(()=>e().then(e=>{t.updateDataStore(e);d["default"].redraw()}));return t}static paging(e){const t=da.PAGE_SIZE*4;const a=new da(n=>e(n,t+1).then(e=>{if(e.length>t){a.updateDataStore(e.slice(0,t),true)}else{a.updateDataStore(e)}d["default"].redraw()}));return a}get data(){return this.dataStore}get sortedData(){return this.sortedDataStore}get filteredData(){return this.filteredDataStore}get loading(){return this.isLoading}setSort(e){this.sortFn=e}applySort(){this.sortedDataStore=this.sortFn(this.dataStore);this.applyFilter()}setFilter(e){this.filterFn=e}applyFilter(){this.filteredDataStore=this.filterFn(this.sortedDataStore);this.invalidate();this.updatePageRange()}reload(){this.dataStore.splice(0,this.dataStore.length);this.invalidate();this.load()}updateScroll(e){if(this.dataStore.length>0){this.scrollPct=e;this.updatePageRange()}}updateDataStore(e,t=false){this.loadMore=t;this.dataStore.push(...e);this.updatePageRange()}render(e){return this.pageStore.map((t,a)=>e({items:t,idx:a,visible:a>=this.startPage&&a<=this.endPage}))}debug(){return{data:this.data.length,filtered:this.filteredData.length,pages:this.pageStore.length,start:this.startPage,end:this.endPage}}constructor(e){this.dataLoader=e;this.dataStore=[];this.sortFn=o["default"].identity;this.sortedDataStore=this.dataStore;this.filterFn=o["default"].identity;this.filteredDataStore=this.sortedDataStore;this.pageStore=[];this.scrollPct=0;this.startPage=-1;this.endPage=-1;this.loadMore=false;this.isLoading=false;this.load()}invalidate(){this.startPage=-1;this.endPage=-1;this.pageStore.splice(0,this.pageStore.length)}load(){if(!this.loading){this.isLoading=true;this.dataLoader(this.data.length).catch(console.error).then(()=>this.isLoading=false)}}updatePageRange(){const e=da.clampRange(0,Math.floor(this.scrollPct*this.pageStore.length)-1,Math.ceil(this.filteredDataStore.length/da.PAGE_SIZE)-da.PAGE_RANGE);if(e!==this.startPage){this.startPage=e;this.endPage=e+da.PAGE_RANGE;let t=this.pageStore.length*da.PAGE_SIZE;const a=this.endPage*da.PAGE_SIZE;while(t<a){const e=t+da.PAGE_SIZE;this.pageStore.push(this.filteredDataStore.slice(t,e));t=e}if(this.loadMore&&a>=this.dataStore.length){this.load()}d["default"].redraw()}}}da.PAGE_SIZE=25;da.PAGE_RANGE=3;e.Badge=ge;e.BaseInput=ot;e.BaseText=Se;e.Button=be;e.ButtonLink=ve;e.CardDateInput=At;e.Checkbox=Le;e.CheckboxInput=Wt;e.CurrencyInput=dt;e.DateInput=Bt;e.DateText=Pe;e.DisplayTypeComponent=ze;e.FileButtonSelect=sa;e.FileList=He;e.FileMulti=Ne;e.FileSelect=Ht;e.ImageList=Ye;e.ImageMulti=Gt;e.ImagePreview=Ge;e.ImageSelect=Zt;e.Label=et;e.Link=De;e.List=oa;e.ListController=da;e.MultiOmniFileInput=la;e.NavButton=ye;e.NavLink=xe;e.OmniFileInput=na;e.PasswordInput=Rt;e.PasswordStrength=Xe;e.PercentageInput=gt;e.RadioInput=zt;e.SelectInput=jt;e.SelectText=je;e.SignBuilder=ta;e.TextareaInput=Nt;e.Toggle=Oe;e.ToggleInput=Vt;e.Tooltip=Ie;e.Trusted=ke;e.createStamp=me;e.currencyStrToNumber=ft;e.dataURItoBlob=ae;e.dataUrlToFile=le;e.fileConstructor=ne;e.fileNameExtSplit=te;e.getOrientation=re;e.guid=_;e.iconMap=$e;e.joinClasses=y;e.linkAttrs=Te;e.linkIcon=Ce;e.numberToCurrencyStr=ht;e.numberToCurrencyTuple=pt;e.pxRatio=N;e.readArrayBuffer=oe;e.readOrientation=de;e.registerFunction=M;e.resizeImage=fe;e.scaleDataUrl=he;e.scaleRect=ue;e.textToImage=pe;e.theme=p;e.updateButtonContext=b;e.updateClasses=m;e.updateConfig=F;Object.defineProperty(e,"__esModule",{value:true})}));
