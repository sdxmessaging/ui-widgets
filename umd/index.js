/* @preserve built on: 2025-02-18T14:02:22.445Z */
(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?t(exports,require("lodash"),require("mithril"),require("mithril/stream"),require("luxon"),require("flatpickr"),require("signature_pad")):typeof define==="function"&&define.amd?define(["exports","lodash","mithril","mithril/stream","luxon","flatpickr","signature_pad"],t):(e=typeof globalThis!=="undefined"?globalThis:e||self,t(e.uiWidgets={},e._,e.m,e.m.stream,e.luxon,e.flatpickr,e.SignaturePad))})(this,(function(e,t,i,a,n,s,l){"use strict";const r={wrapper:"",label:"silver",inputWrapper:"ba br2 b--silver pa2 ma0 dark-gray",input:"dark-gray fw2",button:"pa2 bn br2",navButton:"dark-gray",textarea:"dark-gray fw2",fileInputWrapper:"ba bw1 br3 b--black-30 b--dashed dark-gray",fileHover:"blue b--blue",displayLabel:"silver",displayValue:"dark-gray",requiredLabel:"",requiredInputWrapper:"",readonlyInputWrapper:"",disabledWrapper:"o-40",disabledInputWrapper:"",invalidInputWrapper:"ba b--red",focusInputWrapper:"",altLabel:"ml1 o-70",floatLabelPlaceholder:"",invalidCheckboxWrapper:"red",tooltipWrapper:"dib relative mh2",tooltipIconBackground:"bg-black h2 w2 relative br-100 ",tooltipIcon:"white f6",tooltipMessage:"white bg-black w5 f6 pa2 absolute br2 z-max",redNumber:"red fw2",checkListOptionsWrapper:"ba br2 b--silver pa2 dark-gray bg-canvas w-100 max-h-img overflow-y-auto shadow-4",checkListOption:"pa2 hover-bg-light-gray",checkListOptionLabel:"mh1",checkListOptionIcon:"mh1",checkListOptionSingleSelected:"bg-light-blue fw6",checkListOptionMultiSelected:"fw6",checkListGroupHeaders:"fw6",checkListGroupChildren:"ml4",timeInputScrollerWrapper:"ba br2 b--silver pa2 dark-gray bg-canvas top-2 shadow-4",timeInputScrollerNumber:"pv1 mv2 w-100 mw-dd tc f6 fw6 bg-light-gray"};const o=r;function c(e){t.assign(r,e)}const u={default:"bg-light-blue dark-gray"};function d(e){t.assign(u,e)}function h(e="default"){if(e&&e in u){return u[e]}else{return""}}function p(e){return t.compact(e).join(" ")}function f(e,t={}){if(e in t){return t.merge===false?[t[e]]:[t[e],o[e]]}else{return[o[e]]}}function m(e,t){return p([...f("wrapper",e),t?o.disabledWrapper:""])}function g(e,t){return p([...f("label",e),t?o.requiredLabel:""])}function b({required:e,uiClass:t},i){return p([g(t,e),i?"f-07em cursor-default":`${o.floatLabelPlaceholder} cursor-text`])}function v({required:e,readonly:t,disabled:i,uiClass:a},n,s){return p([...f("inputWrapper",a),...n?f("invalidInputWrapper",a):[],e?o.requiredInputWrapper:null,t?o.readonlyInputWrapper:null,i?o.disabledInputWrapper:null,s?o.focusInputWrapper:null])}function y(e){return p(f("input",e))}function x({readonly:e,disabled:t,uiClass:i}){return p([y(i),I(t,e)])}function w({input:e,merge:t=true}){return p([e,t?o.textarea:null])}function k({inputWrapper:e,merge:t=true},i,a){return p([e,t?o.fileInputWrapper:null,a?o.invalidInputWrapper:null,i?o.fileHover:""])}function I(e,t){return e||t?undefined:"pointer"}const S={layoutType:"default",tooltipIcon:"fas fa-info",imageMaxSize:1280,addFileTxt:"Upload...",addFilesTxt:"Add file(s)...",remFileTtl:"Remove",openFileTxt:"Open file",showPassTxt:"Show Password",requiredLblPost:"",optionalLblPost:"",dateLocale:"default",datePickerIcn:"fas fa-calendar",timePickerIcn:"fas fa-clock",timeScrollerUpIcn:"fas fa-chevron-up",timeScrollerDownIcn:"fas fa-chevron-down",checkListIcn:"fas fa-chevron-down",checkListDropUp:false,signOpts:["draw","type","stamp"],signMaxSize:640,signHeightPct:25,signFont:"sans-serif",signDrawTxt:"Draw",signTypeTxt:"Type",signStampTxt:"Accept",stampTxt:"Accept",stampBtnClass:"",stampBtnContext:"default",stampSetTxt:"Accepted",applyTtl:"Apply",resetTtl:"Reset",cancelTtl:"Cancel",drawIcn:"fas fa-signature",typeIcn:"fas fa-keyboard",stampIcn:"fas fa-check",applyIcn:"fas fa-check",resetIcn:"fas fa-eraser",cancelIcn:"fas fa-times",badgePosition:"left",currencySymbol:"$",negativeStyle:"default",selectionLayout:["icon","label"],selectionOnLabel:"",selectionOffLabel:"",selectionOnActive:"",selectionOffActive:"",selectionOnInactive:"dn",selectionOffInactive:"dn",checkIcn:"far fa-check-square",uncheckIcn:"far fa-square",toggleOnWrapper:"br-pill bg-light-blue",toggleOffWrapper:"br-pill bg-silver",toggleOnIcn:"br-100 bg-white",toggleOffIcn:"br-100 bg-white",radioOnIcn:"fas fa-circle-dot",radioOffIcn:"fas fa-circle",showPassIcn:"fas fa-fw fa-eye",hidePassIcn:"fas fa-fw fa-eye-slash",uploadIcn:"fas fa-file-upload",downloadIcn:"fas fa-file-download",deleteIcn:"fas fa-trash-alt",cameraIcn:"fas fa-camera",imageIcn:"fas fa-image",emailIcn:"fas fa-envelope",telIcn:"fas fa-phone",linkIcn:"fas fa-link",wordDocIcn:"fas fa-file-word",videoFileIcn:"fas fa-file-video",pdfFileIcn:"fas fa-file-pdf",musicFileIcn:"fas fa-file-audio",excelFileIcn:"fas fa-file-excel",fileIcn:"fas fa-file",codeFileIcn:"fas fa-file-code"};const O=S;function L(e){t.assign(S,e)}function C(e,t){return t&&e in t?t[e]:O[e]}const T={};function $(e,t){if(e in T){throw new Error(`Function ${e} already registered.`)}T[e]=t}function D(e){if(!(e in T)){throw new Error(`Function ${e} not registered.`)}return T[e]}function P(e,t){if(typeof e==="string"){return i("i",{class:p([t,e])})}else{return D(e.name)(e.data,t)}}function F(e){return(e+256).toString(16).substring(1)}function q(){const e=new Uint8Array(16);const t=window.crypto;t.getRandomValues(e);return[F(e[0]),F(e[1]),F(e[2]),F(e[3]),"-",F(e[4]),F(e[5]),"-",F(e[6]),F(e[7]),"-",F(e[8]),F(e[9]),"-",F(e[10]),F(e[11]),F(e[12]),F(e[13]),F(e[14]),F(e[15])].join("")}function B(){return Math.max(window.devicePixelRatio,1)}function E(e){return e&&(typeof e==="string"?e:e.text)}function M(e,t){const i=typeof e==="string"?e:e.text;const a=t?O.requiredLblPost:O.optionalLblPost;return a?i+a:i}function R({alt:e}){return e?i("span",{class:o.altLabel},e):null}function _(e,t){return t?t:e}function A(e,t,a,n){return i(t,a,[e.icon?P(e.icon,""):null,i("span",M(e,n)),R(e),e.rightIcon?P(e.rightIcon,""):null,e.href?i("a.link.dim.pointer.ws-normal.mh1",{onclick:e.onclick},[i("i",{class:O.linkIcn}),e.href]):null])}function N(e,t="mr2 truncate"){if(e){if(typeof e==="string"){return i("span",{title:e,class:p([t,o.displayLabel])},e)}else{return A(e,"span",{title:e.text,class:p([t,o.displayLabel])})}}return null}function U(e,t,a,n){if(a){if(typeof a==="string"){return i("label.mb1.db",{title:a,for:e,class:g(t,n)},M(a,n))}else{return A(a,"label.mb1.db",{title:a.text,for:e,class:g(t,n)},n)}}return null}function W(e){return[e.icon&&P(e.icon,"fa-fw"),e.text&&i("span",e.text),e.rightIcon&&P(e.rightIcon,"fa-fw")]}function H(e){return function({target:{value:t}}){e(t)}}function V(e,t){return t!=null?function({target:{checked:i}}){e(i?t:false)}:function({target:{checked:t}}){e(t)}}function z(e,t){if(e()!==t){e(t)}}function j({target:e}){e.select()}function K({key:e}){if(e==="Enter"&&document.activeElement){document.activeElement.click()}}function Y(e){const t=e.lastIndexOf(".");if(t===-1){return[e,""]}else{return[e.substring(0,t),e.substring(t)]}}function G(e){const[t,i]=e.split(",");const a=t.indexOf("base64")>=0?atob(i):unescape(i);const n=t.substring(t.indexOf("data:")+5).split(";");const s=n[0];const l=a.length;const r=new Uint8Array(l);for(let e=0;e<l;e++){r[e]=a.charCodeAt(e)}return new Blob([r],{type:s})}function Z(e,t){return new File([e],t,{type:e.type})}function J(e,t,i){const a=Z(G(e),t);return{guid:q(),name:a.name,path:"not_set",file:a,dataUrl:e,metadata:i}}function Q(e){const[,t]=Y(e.name);switch(t.toLowerCase()){case".doc":case".docx":case".dot":case".wbk":case".docm":case".dotx":case".dotm":case".docb":case".txt":return O.wordDocIcn;case".webm":case".mkv":case".flv":case".vob":case".ogv":case".drc":case".gifv":case".mng":case".avi":case".mts":case".m2ts":case".mov":case".qt":case".wmv":case".yuv":case".rm":case".rmvb":case".viv":case".asf":case".amv":case".mp4":case".m4p":case".m4v":case".mpg":case".mp2":case".mpeg":case".mpe":case".mpv":case".m2v":case".svi":case".3gp":case".mxf":case".roq":case".nsv":case".f4v":case".f4p":case".f4a":case".f4b":return O.videoFileIcn;case".pdf":return O.pdfFileIcn;case".pcm":case".wav":case".aiff":case".mp3":case".aac":case".ogg":case".wma":case".flac":case".alac":return O.musicFileIcn;case".xls":case".xlt":case".xlm":case".xlsx":case".xlsm":case".xltx":case".xltm":case".xlsb":case".xla":case".xlam":case".xll":case".xlw":return O.excelFileIcn;case".html":case".js":case".css":case".scss":case".java":return O.codeFileIcn;case".jpg":case".jpeg":case".png":case".tiff":case".gif":case".svg":case".webp":return O.imageIcn;default:return O.fileIcn}}function X(e){return e&&e.includes("image")}function ee(e){const t=Math.min(e.byteLength,64*1024);const i=new DataView(e,0,t);if(i.getUint16(0,false)!==65496){return-2}const a=i.byteLength;let n=2;while(n<a){const e=i.getUint16(n,false);n+=2;if(e===65505){n+=2;if(i.getUint32(n,false)!==1165519206){return-1}n+=6;const e=i.getUint16(n,false)===18761;n+=i.getUint32(n+4,e);const t=i.getUint16(n,e);n+=2;for(let a=0;a<t;a++){if(i.getUint16(n+a*12,e)===274){return i.getUint16(n+a*12+8,e)}}}else if((e&65280)!==65280){break}else{n+=i.getUint16(n,false)}}return-1}function te(e){return new Promise((t=>{const i=new FileReader;i.onload=()=>{t(i.result)};i.readAsArrayBuffer(e)}))}function ie(e){return te(e).then(ee)}function ae(e,t,i,a){if(!a||a>8){return}switch(a){case 2:e.translate(t,0);e.scale(-1,1);return;case 3:e.translate(t,i);e.rotate(Math.PI);return;case 4:e.translate(0,i);e.scale(1,-1);return;case 5:e.rotate(.5*Math.PI);e.scale(1,-1);return;case 6:e.rotate(.5*Math.PI);e.translate(0,-i);return;case 7:e.rotate(.5*Math.PI);e.translate(t,-i);e.scale(-1,1);return;case 8:e.rotate(-.5*Math.PI);e.translate(-t,0);return}}function ne(e,t,i){if(e>t){if(e>i){return[i,Math.round(t*i/e)]}}else if(t>i){return[Math.round(e*i/t),i]}return[e,t]}function se(e,t,i){if(!e.type.match(/image.*/)){return Promise.reject(new Error("File must be an image"))}return ie(e).then((a=>new Promise((n=>{const s=new Image;s.onload=()=>{const e=document.createElement("canvas");const[l,r]=ne(s.width,s.height,t);if(a>4){e.width=r;e.height=l}else{e.width=l;e.height=r}const o=e.getContext("2d");ae(o,l,r,a);o.drawImage(s,0,0,l,r);n(e.toDataURL(i))};const l=new FileReader;l.onload=()=>s.src=l.result;l.readAsDataURL(e)}))))}function le(e,t){return new Promise((i=>{const a=new Image;a.onload=()=>{const e=document.createElement("canvas");const[n,s]=ne(a.width,a.height,t);e.width=n;e.height=s;const l=e.getContext("2d");l.drawImage(a,0,0,n,s);i(e.toDataURL())};a.src=e}))}function re(e,t,i,a){const n=document.createElement("canvas");n.width=t;n.height=i;const s=.56*n.height;const l=n.getContext("2d");l.textBaseline="middle";l.font=`${s}px ${a}`;l.fillText(e,n.height*.05,s);return n.toDataURL()}function oe(e,t,i){const a=C("signMaxSize",i);const n=.01*t*a;return re(e,a,n,C("signFont",i))}class ce{static format(e,t=false,i=false){const a=this.numtoStr(e,true);const n=i?e>0:e<0;if(a&&n){return t?`(${a})`:`-${a}`}else{return a}}static strToNum(e){const i=e.replace("(-","-").replace("(","-").replace(")","").replace(/[^\d.-]/g,"");let a;let n=0;if(i.indexOf(".")>-1){const e=i.indexOf(".");const s=i.substring(0,e);a=t.parseInt(t.padStart(s,1,"0"));const l=i.substring(e+1,Math.min(e+3,i.length));n=t.parseInt(t.padEnd(l,2,"0"))}else{a=t.parseInt(i)||0}return a<0?a*100-n:a*100+n}static numtoStr(e,i){const a=this.numToTuple(e);if(a){const e=i?this.formatter.format(a[0]):a[0];const n=t.padStart(String(a[1]),2,"0");return`${e}.${n}`}else{return undefined}}static numToTuple(e){if(!t.isFinite(e)){return undefined}const i=Math.abs(e);let a=0;let n;if(i>99){a=Math.trunc(i/100);n=i%100}else{n=i}return[a,n]}}ce.formatter=new Intl.NumberFormat;class ue{view({attrs:{label:e,classes:t="bg-red"},children:a}){return i(".relative.dib",[a,e?i("span.absolute.minw-65rem.ph1.nt1.nr1.top-0.right-0.br-pill.tc.f5.white.o-80",{class:t},e):null])}}class de{view({attrs:{label:e="",type:t="button",title:a=e,icon:n,rightIcon:s,context:l,classes:r="",style:c,disabled:u,onclick:d,tabindex:p}}){return i("button.button-reset",{type:t,title:a,disabled:u,class:`${r} ${u?o.disabledWrapper:"pointer"} ${h(l)} ${o.button}`,style:c,tabindex:p,onclick:d},W({text:e,icon:n,rightIcon:s}))}}class he{view({attrs:{label:e="",title:t=e,icon:a,rightIcon:n,href:s,rel:l,target:r,download:c,context:u,classes:d="",style:p}}){return i("a.link.flex.items-center",{href:s,rel:l,target:r,download:c,title:t,class:`${d} ${h(u)} ${o.button}`,style:p},W({text:e,icon:a,rightIcon:n}))}}class pe{view({attrs:{label:e="",title:t=e,icon:a,rightIcon:n,classes:s="",style:l,disabled:r,onclick:c}}){return i(".mh2.pa2.truncate",{title:t,disabled:r,class:`${s} ${r?o.disabledWrapper:"pointer"} ${o.navButton}`,style:l,onclick:c},W({text:e,icon:a,rightIcon:n}))}}class fe{view({attrs:{label:e="",title:t=e,icon:a,rightIcon:n,href:s,rel:l,target:r,download:c,classes:u="",style:d}}){return i("a.link.mh2.pa2.truncate",{href:s,rel:l,target:r,download:c,title:t,class:`${u} ${o.navButton}`,style:d},W({text:e,icon:a,rightIcon:n}))}}function me(e){switch(e){case"left":return{left:"initial",top:"initial",right:"calc(100% + 0.25rem)",bottom:"initial"};case"top":return{left:"initial",top:"initial",right:"initial",bottom:"calc(100% + 0.25rem)"};case"topRight":return{left:"calc(100%)",top:"initial",right:"initial",bottom:"calc(100%)"};case"topLeft":return{left:"initial",top:"initial",right:"calc(100%)",bottom:"calc(100%)"};case"bottom":return{left:"initial",top:"calc(100% + 0.25rem)",right:"initial",bottom:"initial"};case"bottomRight":return{left:"calc(100%)",top:"calc(100%)",right:"initial",bottom:"initial"};case"bottomLeft":return{left:"initial",top:"calc(100%)",right:"calc(100%)",bottom:"initial"};default:return{left:"calc(100% + 0.25rem)",top:"initial",right:"initial",bottom:"initial"}}}class ge{constructor(){this.show=false}view({attrs:{message:e,direction:t="right",icon:a=O.tooltipIcon}}){return i("div",{class:o.tooltipWrapper},[i(".flex.items-center.justify-center",{class:o.tooltipIconBackground,onmouseenter:()=>this.show=true,onmouseleave:()=>this.show=false},[i("i",{class:p([a,o.tooltipIcon])}),this.show&&i("div",{class:o.tooltipMessage,style:me(t)},e.map((e=>i("p.mv2",e))))])])}}class be{view({attrs:{value:e}}){return i(".pa2",{},i.trust(e()))}}class ve{view({attrs:{field:e,value:t}}){const{label:a,uiClass:n={}}=e;return i(".pa2.flex.flex-wrap",{class:m(n)},[N(a),i("span.ws-normal",{title:t(),class:o.displayValue},t())])}}class ye{formatter(e){return e?new Date(String(e)).toLocaleDateString():e}oninit({attrs:{value:e}}){this.formatted=e.map(this.formatter)}onremove(){this.formatted.end(true)}view({attrs:{field:e}}){return i(ve,{field:e,value:this.formatted})}}function xe(e,t){if(e==="email"){return{href:`mailto:${t}`,class:o.displayValue}}else if(e==="tel"){return{href:`tel:${t}`,class:o.displayValue}}else{return{href:t,target:"_blank",class:o.displayValue}}}const we={email:O.emailIcn,tel:O.telIcn};function ke(e,t){if(e==="email"){return C("emailIcn",t)}else if(e==="tel"){return C("telIcn",t)}else{return C("linkIcn",t)}}class Ie{view({attrs:{field:e,value:t}}){const{label:a,type:n="url",uiClass:s={},config:l}=e;return i(".pa2.flex.flex-wrap",{class:m(s)},[N(a),i("a.link.dim.pointer.ws-normal",xe(n,t()),i("i.mr2",{class:ke(n,l)}),t())])}}class Se{view({attrs:{selected:e,label:t,onIcon:a,offIcon:n,config:s}}){return i(".flex.items-center.h-100",C("selectionLayout",s).map((l=>{switch(l){case"label":return t;case"icon":return P(e?a:n,"mh1");case"on":return i("span.mh1",{class:C(e?"selectionOnActive":"selectionOnInactive",s)},C("selectionOnLabel",s));case"off":return i("span.mh1",{class:C(e?"selectionOffInactive":"selectionOffActive",s)},C("selectionOffLabel",s))}})))}}class Oe{constructor(){this.onIcon="checkIcn";this.offIcon="uncheckIcn"}view({attrs:{field:e,value:t}}){const{label:a,uiClass:n={},config:s}=e;return i(".pa2",{class:m(n)},i(Se,{selected:Boolean(t()),label:N(a,"mh1 truncate"),onIcon:C(this.onIcon,s),offIcon:C(this.offIcon,s),config:s}))}}class Le extends Oe{constructor(){super(...arguments);this.onIcon="toggleOnIcn";this.offIcon="toggleOffIcn"}}function Ce(e,t){if(e.required){return t.length<1}return false}function Te(e){return t=>{t.preventDefault();if(t.dataTransfer){t.dataTransfer.dropEffect="copy"}if(e()){t.redraw=false}e(true)}}function $e(e){return t=>{t.preventDefault();e(false)}}function De(e,t){return i=>{i.preventDefault();e(false);if(i.dataTransfer){t(i.dataTransfer.files)}}}function Pe(e){return({target:{files:t}})=>e(t)}class Fe{constructor(){this.showLabel=true}oncreate({dom:e,attrs:{value:t}}){t.map((t=>{if(t.length===0){e.firstChild.value=""}}))}view({attrs:{field:e,defaultAccept:t="*",multiple:a=true,dragging:n,onSet:s},children:l}){const{label:r,id:o,name:c=o,title:u=E(r),required:d,readonly:h,disabled:p,autofocus:f,tabindex:m="0",accept:g=t,uiClass:b={}}=e;const v=this.showLabel&&r?U(o,b,r,d):null;return i("label.db",Object.assign({for:o,title:u,class:I(p,h),tabindex:m,"aria-labelled-by":o,"data-input-id":o,onkeydown:e=>{var t;if(e.key===" "){((t=document.activeElement)===null||t===void 0?void 0:t.firstElementChild).click()}}},p||h?{}:{ondragover:Te(n),ondragleave:$e(n),ondrop:De(n,s)}),[i("input.clip[type=file].bg-transparent.bn.outline-0",{id:o,name:c,multiple:a,accept:g,required:d,autofocus:f,disabled:p||h,tabindex:-1,onchange:Pe(s)}),v,l])}}function qe(e,i=false){return a=>{const n=i?[]:e();t.each(a,(e=>{n.push({guid:q(),name:e.name,path:"not_set",file:e})}));e(n)}}function Be(e,i){return a=>{a.preventDefault();const n=e();t.remove(n,{guid:i});e(n)}}class Ee{constructor(){this.dragging=a(false)}view({attrs:{field:e,value:a}}){const{disabled:n,uiClass:s={},config:l,readonly:r}=e;return i("div",{class:m(s,n)},[i(Fe,{field:e,dragging:this.dragging,onSet:qe(a),value:a},i(".pa2",{class:k(s,this.dragging(),Ce(e,a()))},[P(C("uploadIcn",l),"db mr2"),i("span",C("addFilesTxt",l))])),i(".flex.flex-column.mt1.nb1",t.map(a(),(e=>i("span.pa2.mv1.ba.b--black-20.hide-child.dim.pointer",[P(C("downloadIcn",l),"db mr2"),e.name,!(r||n)&&i("i.child.fr",{title:`${C("remFileTtl",l)} ${e.name}`,onclick:Be(a,e.guid)},P(C("deleteIcn",l),"db"))]))))])}}class Me{view({children:e,attrs:t}){return i(".relative.w-third.w-25-m.w-20-l.pa1.tc.hide-child",{tabindex:0,onkeydown:({key:e})=>{var t;if(e==="Enter"&&document.activeElement){(t=document.activeElement.querySelector("button"))===null||t===void 0?void 0:t.click()}}},[t.src&&t.src!=="not_set"?i("img.contain",{src:t.src}):null,t.data&&t.data.file&&(t.src==="not_set"||!t.src)?i("div.contain.tc.br5.6rem",{class:`${Q(t.data)} fa-2x`,tooltip:t.data.file.type}):null,e])}}class Re{view({attrs:e}){return i("i.pa1",{class:Q(e),title:O.openFileTxt,onclick:e.path!=="not_set"?()=>window.open(e.path,"_blank"):undefined})}}class _e{view({attrs:{displayType:e="thumbnail",value:a,readonlyOrDisabled:n,config:s}}){return e==="thumbnail"?i(".flex.flex-row.flex-wrap.mt1.nr1.nb1.nl1.max-h-thumb",t.map(a(),(e=>i(Me,{src:_(e.path,e.dataUrl),data:e},!n&&i(".absolute.top-0.right-0.child",i(de,{title:`Remove ${e.name}`,icon:C("deleteIcn",s),onclick:Be(a,e.guid),tabindex:-1})))))):i(".pa2.flex.flex-column",t.map(a(),(e=>i(".flex.items-center.pa1.ba.b--black-20",[P(C("uploadIcn",s),"pa1"),i("span.ma1.flex-auto",{title:e.name},e.name),i(Re,e),!n&&i("i.pa1.pointer.dim",{title:`Remove ${e.name}`,class:C("cancelIcn",s),onclick:Be(a,e.guid)})]))))}}class Ae{view({attrs:{field:e,value:a}}){const{label:n,options:s,uiClass:l={}}=e;const r=t.find(s,{value:a()});const c=r?r.label||r.value:a();return i(".pa2.flex.flex-wrap",{class:m(l)},[N(n),i("span.ws-normal",{title:c,class:o.displayValue},c)])}}class Ne{view({attrs:{field:e,value:a}}){const{label:n,uiClass:s={},config:l}=e;return i(".pa2.flex.flex-column",{class:m(s)},[N(n),i(".flex.flex-column.mt1.nb1",t.map(a(),(({name:e,path:t})=>i("a.pa2.mv1.link.ba.b--black-20.dim.dib.pointer[target=_blank]",{class:o.displayValue,href:t},[P(C("downloadIcn",l),"db mr2"),e]))))])}}class Ue{view({attrs:{field:e,value:a}}){const{label:n,uiClass:s={}}=e;return i(".pa2.flex.flex-column",{class:m(s)},[N(n),i(".flex.flex-row.flex-wrap.mt1.nr1.nb1.nl1.max-h-thumb",t.map(a(),(({name:e,path:t,dataUrl:a})=>i(Me,{title:e,src:_(t,a)}))))])}}class We{view({attrs:{field:e,value:a}}){const{label:n,uiClass:s={},config:l}=e;const r=t.head(a());return i(".pa2.flex.flex-column",{class:m(s)},[N(n),r?i("img.img.h-100.max-h-img.mt2.contain.self-center",{title:r.name,src:_(r.path,r.dataUrl)}):i("i.mt2",{class:`${o.displayValue} ${C("imageIcn",l)}`})])}}function He(e,t){return(e.match(t)||[]).length}function Ve(e){let t=0;if(e.length>=8){t=1;if(e.length>=24){t=t+1}if(He(e,/[A-Z]/g)>1&&He(e,/[a-z]/g)>2){t=t+1}if(He(e,/\d/g)>1){t=t+1}if(He(e,/[!"£%^@#$&*]/g)>0){t=t+1}}return t}function ze(e){switch(e){case 0:{return"Invalid"}case 1:{return"Very Weak"}case 2:{return"Weak"}case 3:{return"Average"}case 4:{return"Strong"}case 5:{return"Very Strong"}}return""}const je=[{value:1,background:"bg-dark-red"},{value:2,background:"bg-orange"},{value:3,background:"bg-yellow"},{value:4,background:"bg-light-green"},{value:5,background:"bg-green"}];class Ke{oninit({attrs:{value:e}}){this.passwordScore=e.map((e=>Ve(String(e))))}onremove(){this.passwordScore.end()}view({attrs:{field:e}}){const{label:a}=e;return i(".flex.flex-column",[N(a),i(".flex.mt1",t.map(je,(e=>i(".h1.w-20",{class:this.passwordScore()>=e.value?e.background:"bg-transparent"})))),i("span.f5.truncate",ze(this.passwordScore()))])}}class Ye{view({attrs:{field:{label:e="",id:t,required:a,uiClass:n={}}}}){return i("div",{class:m(n)},U(t,n,e,a))}}class Ge{constructor(){this._focus=false;this._touch=true;this._valid=true;this.touch=this.unboundTouch.bind(this);this.boundFocus=this.unboundFocus.bind(this);this.selector="input"}unboundTouch(){this._touch=true;this._focus=false;i.redraw()}unboundFocus(){this._focus=true;i.redraw()}get inFocus(){return this._focus}get invalid(){return!this._valid}checkValidity(){if(this._touch){const e=this._inputElement.checkValidity();if(e!==this._valid){this._valid=e;i.redraw()}}}changeInput(e){this._inputElement.value=String(e());this._inputElement.dispatchEvent(new Event("change",{bubbles:true}))}oncreate({dom:e,attrs:{value:t}}){e.addEventListener("focusin",this.boundFocus);e.addEventListener("focusout",this.touch);this._inputElement=e.querySelector(this.selector);if(t()!=null){this._touch=true}this.checkValidity()}onupdate({attrs:{value:e}}){if(e()!=null&&this._touch===false){this.touch()}this.checkValidity()}onbeforeremove({dom:e}){e.removeEventListener("focusin",this.boundFocus);e.removeEventListener("focusout",this.touch)}}class Ze{view({attrs:e,children:t}){const{field:a,invalid:n,focus:s}=e;const{label:l,id:r,type:o="text",required:c,disabled:u,uiClass:d={}}=a;return i("div",{class:o==="hidden"?"clip":m(d,u)},[U(r,d,l,c),i("fieldset",{class:v(a,n,s)},t)])}}class Je{shouldFloat(e,t,i,a=false){return e==="floatAlways"||i||Boolean(t)||a}labelTranslateY(){return"calc(50% + 0.175ch - 1.5ex)"}labelContent(e,t){return typeof e==="string"?M(e,t):[M(e,t),R(e)]}view({attrs:e,children:t}){const{field:a,value:n,xform:s=n,invalid:l,focus:r}=e;const{label:o,id:c,type:u="text",placeholder:d,required:h,disabled:f,readonly:y,uiClass:x={},config:w,layout:k=C("layoutType",w)}=a;const I=this.shouldFloat(k,d||s()!=null&&String(s()),r,y);return i("div",{class:p([u==="hidden"?"clip":m(x,f),o?"pt2":null])},i("fieldset.relative.pa0.ma0.w-100",{class:v(a,l,r)},[o?[i("legend.db.hidden.h-05ch.transition-mw",{class:`${g(x,h)} ${I?"mw-100":"mw-001px"}`},i("span.f-07em",this.labelContent(o,h))),i(".absolute.h-100.top-0.transition-transform.pe-none",{style:{transform:`translateY(${I?"-1ch":this.labelTranslateY()})`}},i("label.db.transition-f",{for:c,title:typeof o==="string"?o:o.text,class:b(a,I)},this.labelContent(o,h)))]:null,t]))}}class Qe{constructor(){this.layout=Je}view({attrs:e,children:t}){const{field:{config:a,layout:n=C("layoutType",a)}}=e;return i(n==="default"?Ze:this.layout,e,t)}}class Xe extends Je{shouldFloat(){return true}}class et extends Qe{constructor(){super(...arguments);this.layout=Xe}}const tt=new Set(["date","datetime-local","time","color","range"]);class it extends Ge{view({attrs:e}){const{field:t,value:a,xform:n=a}=e;const{label:s,id:l,type:r="text",name:o=l,title:c=E(s),placeholder:u,max:d,maxlength:h,min:p,minlength:f,step:m,required:g,readonly:b,disabled:v,autofocus:x,autocomplete:w,tabindex:k,pattern:I,inputmode:S,spellcheck:O,instant:L,uiClass:C={}}=t;const T=tt.has(r)?et:Qe;return i(T,{field:t,value:a,xform:n,invalid:this.invalid,focus:this.inFocus},i("input.w-100.bg-transparent.bn.outline-0",{id:l,type:r,name:o,title:c,placeholder:u,max:d,maxlength:h,min:p,minlength:f,step:m,required:g,readonly:b,disabled:v,autofocus:x,autocomplete:w,tabindex:k,pattern:I,inputmode:S,spellcheck:O,class:y(C),value:n(),[L?"oninput":"onchange"]:H(a)}))}}class at extends Ge{view({attrs:e}){const{field:a,value:n,xform:s=n}=e;const{label:l,id:r,name:c=r,title:u=E(l),placeholder:d,max:h,maxlength:f,min:m,minlength:g,step:b,required:v,readonly:x,disabled:w,autofocus:k,autocomplete:I,tabindex:S,pattern:O,inputmode:L,spellcheck:T,uiClass:$={},config:D}=a;const P=C("currencySymbol",D);const F=C("negativeStyle",D);const q=C("badgePosition",D);const B=nt(s());const M=y($);const R=B<0;const _=F==="red";const A=_||F==="redParentheses";const N=F==="parentheses"||F==="redParentheses";return i(et,{field:a,value:n,invalid:this.invalid,focus:this.inFocus},i(".flex.w-100",[i("span.self-center",{class:p([q==="left"?"order-0 mr1":"order-last ml1",M])},P),i("input.absolute.pa0.w1.o-0.pe-none[type=number]",{name:c,value:B,max:h,maxlength:f,min:m,minlength:g,step:b,required:v,readonly:x,disabled:w,tabindex:-1,ariaHidden:"true"}),i("input.w-100.bg-transparent.bn.outline-0",{id:r,type:"text",name:`${c}-currency`,title:u,placeholder:d,required:v,readonly:x,disabled:w,autofocus:k,autocomplete:I,tabindex:S,pattern:O,inputmode:L,spellcheck:T,class:p([q==="right"?"tr":"",A&&R?o.redNumber:null,M]),onfocus:j,onblur:this.touch,value:t.isUndefined(s())?null:ce.format(B,N,_&&R),onchange:st(n)})]))}}function nt(e){return t.isString(e)?t.parseInt(e):Number(e)}function st(e){return({target:{value:t}})=>e(ce.strToNum(t))}function lt(e,t,i=false){const a=ot(e);const n=i?e>0:e<0;if(n){if(t.toLowerCase().includes("parentheses")){return`(${a})`}else if(t!=="red"){return`-${a}`}}return a}function rt(e){return ce.strToNum(e)}function ot(e){const t=ct(e);if(t){return`${t[0]}.${t[1]}`}else{return t}}function ct(e){if(!t.isFinite(e)){return undefined}const i=String(Math.abs(e));let a="0";let n="";if(i.length>2){const e=i.length-2;a=i.substring(0,e);n=i.substring(e)}else{n=t.padStart(i,2,"0")}return[a,n]}class ut extends Ge{view({attrs:e}){const{field:t,value:a,xform:n=a}=e;const{label:s,id:l,name:r=l,title:o=E(s),placeholder:c,max:u,maxlength:d,min:h,minlength:f,step:m,required:g,readonly:b,disabled:v,autofocus:x,autocomplete:w,tabindex:k,pattern:I,inputmode:S,spellcheck:O,instant:L,uiClass:T={},config:$}=t;const D=C("badgePosition",$);return i(et,{field:t,value:a,invalid:this.invalid,focus:this.inFocus},i(".flex.flex-row.w-100",[i("span.self-center",{class:p([D==="left"?"order-0 mr1":"order-last ml1",y(T)])},"%"),i("input.w-100.bg-transparent.bn.outline-0",{id:l,type:"number",name:r,title:o,placeholder:c,max:u,maxlength:d,min:h,minlength:f,step:m,required:g,readonly:b,disabled:v,autofocus:x,autocomplete:w,tabindex:k,pattern:I,inputmode:S,spellcheck:O,class:p([D==="right"?"tr":"",y(T)]),onfocus:j,value:n(),[L?"oninput":"onchange"]:H(a)})]))}}function dt(e){switch(e){case"day":return"dd";case"month":return"mm";case"year":return"yyyy"}}function ht(e,t,i){const a=e.querySelector(`#${t}-${i}`);a.focus()}function pt(e){const t=e?e.toLocaleLowerCase():"";if(t.includes("month")){return"mm"}else if(t.includes("day")){return"dd"}else if(t.includes("year")){return"yy"}else{return null}}function ft(e,t,i){const a=e.querySelector(`#${t}-${i}`);a.focus();a.select()}function mt(e){return parseInt(e.getAttribute("maxlength"))}function gt(e,t,i,a,n,s,{next:l,prev:r}){const o=a.querySelector(`#${e}-${t}`);const c=mt(o);if((n.key==="Backspace"||n.key==="Delete")&&i.length===0&&r){ft(a,e,r);n.preventDefault()}else if(s.charCodeAt(0)===n.key.charCodeAt(0)&&l&&i.length!==0&&i.length<c){ft(a,e,l);n.preventDefault()}}function bt(e,t,i,a,n,s){if(yt(i,a,n)&&e){s(t)}else{s("")}}function vt(e){const t=String(e());if(t.length===1&&t!=="0"){e(`0${t}`)}}function yt(e,t,i){const a=!i?2:4;return e.length===a&&t.length===2&&(!i||i.length===2)}function xt(e){if(e.includes("month")){return"month"}else if(e.includes("day")){return"day"}return"date"}function wt(e,t,i){if(e.invalidExplanation){if(i){return""}else{return`Please check the ${xt(e.invalidExplanation)}.`}}else if(!e.year||Number(t)<1900){return"Year must be greater than 1900."}return""}function kt(e,t,i){if(!i){if(!t&&!e){return""}else if(t.length!==2||Number(t)>12){return`Please check the month.`}else if(e.length!==2){return`Please check the year.`}}return""}function It(e,t){if(t){const i=pt(e);t.querySelectorAll("input").forEach((t=>{if(i&&t.id.substring(t.id.length-2)===i&&e){t.setCustomValidity(e)}else{t.setCustomValidity("")}}))}}function St(e,t,i,a){const n=t.length===2&&e.length===2&&Number(t)<=12&&Number(t)>0||!e&&!t&&!i;It(kt(e,t,n),a);return n}function Ot(e,t,i,a,s){const l=n.DateTime.fromObject({year:Number(e),month:Number(t),day:Number(i)});const r=!e&&!t&&!i;It(wt(l,e,r),s);const o=Number(e)>=1900;const c=a.min?l>=n.DateTime.fromISO(String(a.min)):true;const u=a.max?l<=n.DateTime.fromISO(String(a.max)):true;return l.isValid&&c&&u&&o||r&&!a.required}function Lt(e,t,i,a,n){const s=a.querySelector(`#${t}-${i}`);const l=e()||"";const r=s.value;const o=/^\d*$/.test(r);if((o||r==="")&&r.length<=4){e(r)}else{e(l)}if(String(e()).length===mt(s)&&n){ft(a,t,n)}}class Ct{constructor(){this.dom=a();this.valid=a();this.focusedInput=a("mm");this.month=a("");this.year=a("");this.date=a("")}buildDate(e,t){this.date(`${this.month()}/${this.year()}`);const i=St(this.year(),this.month(),e,this.dom());bt(i,this.date(),this.year(),this.month(),"",t)}oninit({attrs:{value:e,field:t}}){this.valid(!t.required);e.map((e=>{if(e){this.date("");const[t,i]=String(e).split("/");this.month(t);this.year(i)}else if(!this.date()){this.month("");this.year("")}this.valid(St(this.year(),this.month(),Boolean(t.required),this.dom()))}))}oncreate({dom:e}){z(this.dom,e)}onupdate({dom:e}){z(this.dom,e)}onremove(){this.date.end(true);this.year.end(true);this.month.end(true)}view({attrs:e}){const{field:a,value:n}=e;const{id:s,name:l=s,required:r,readonly:o,disabled:c,tabindex:u,uiClass:d={}}=a;const h=y(d);return i(et,{field:a,value:n,invalid:!this.valid(),focus:false},i(".flex.items-center",i(".relative.flex-auto.ph-2px.pv-1px",{onclick:()=>ht(this.dom(),s,this.focusedInput())},[i("input.absolute.pa0.w1.o-0.pe-none[type=text]",{id:s,value:n(),required:r,readonly:o,disabled:c,tabindex:-1,ariaHidden:"true"}),i("input.w-100.mw-mm.pa0.bg-transparent.bn.outline-0.tc",{id:`${s}-mm`,name:`${l}-mm`,type:"text",placeholder:"MM",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:r,readonly:o,disabled:c,tabindex:u,"aria-label":`${l}: Month`,value:this.month(),class:h,onfocus:t.partial(this.focusedInput,"mm"),oninput:()=>{Lt(this.month,s,"mm",this.dom(),"yy");this.buildDate(Boolean(a.required),e.value)},onkeydown:e=>{gt(s,"mm",this.month(),this.dom(),e,"/",{next:"yy"})},onblur:()=>{vt(this.month);this.buildDate(Boolean(a.required),e.value)}}),i(".di.mr-2px","/"),i("input.w-100.mw-yy.pa0.bg-transparent.bn.outline-0.tc",{id:`${s}-yy`,name:`${l}-yy`,type:"text",placeholder:"YY",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:r,readonly:o,disabled:c,tabindex:u,"aria-label":`${l}: Year`,value:this.year(),class:h,onfocus:t.partial(this.focusedInput,"yy"),onkeydown:e=>{gt(s,"yy",this.year(),this.dom(),e,"/",{prev:"mm"})},oninput:()=>{Lt(this.year,s,"yy",this.dom());this.buildDate(Boolean(a.required),e.value)}})])))}}function Tt(e){return[String(e.getFullYear()),t.padStart(String(1+e.getMonth()),2,"0"),t.padStart(String(e.getDate()),2,"0")]}class $t{oncreate({dom:e,attrs:{field:{max:t,min:a},value:n}}){const l=e.parentElement;const{left:r,right:o}=l.getBoundingClientRect();this.flatpickr=s(e,{positionElement:l,position:r+o<window.innerWidth?"below left":"below right",disableMobile:true,minDate:a,maxDate:t,onChange:([e])=>{if(e){n(Tt(e).join("-"));i.redraw()}}});this.valueChange=n.map((e=>{const t=new Date(String(e));if(isNaN(t.valueOf())){this.flatpickr.clear()}else{this.flatpickr.setDate(t,false)}}))}onremove(){this.flatpickr.destroy();this.valueChange.end(true)}view({attrs:{field:{config:e}}}){return P(C("datePickerIcn",e),"ph-2px pv-1px")}}class Dt{constructor(){this.dom=a();this.valid=a();this.focusedInput=a(undefined);this.locale=a(undefined);this.literalKey=a("/");this.day=a("");this.month=a("");this.year=a("");this.date=a()}buildDate(e,t){this.date(`${this.year()}-${this.month()}-${this.day()}`);const i=Ot(this.year(),this.month(),this.day(),t,this.dom());bt(i,this.date(),this.year(),this.month(),this.day(),e)}findNextInput(e){const t=this.dateInputAdvanceOrder.indexOf(e);return t!==this.dateInputAdvanceOrder.length&&dt(this.dateInputAdvanceOrder[this.dateInputAdvanceOrder.indexOf(e)+1])}findPrevInput(e){const t=this.dateInputAdvanceOrder.indexOf(e);return t!==0&&dt(this.dateInputAdvanceOrder[this.dateInputAdvanceOrder.indexOf(e)-1])}setDateInputs(e){const i=new Intl.DateTimeFormat(e).formatToParts();this.dateParts=i;const a=i[0].type;this.literalKey(i[1].value);const n=dt(a);this.focusedInput(n);this.dateInputAdvanceOrder=t(this.dateParts).map((({type:e})=>e)).filter((e=>e!=="literal")).value()}setLocale(e){const t=C("dateLocale",e);if(t!==this.locale()){this.locale(t)}}createDateInputs({type:e,value:a},{attrs:{field:n,value:s}}){const{id:l,name:r=l,required:o,readonly:c,disabled:u,tabindex:d,uiClass:h={}}=n;const p=y(h);switch(e){case"literal":return i(".di.mr-2px.tl",a);case"day":return i("input.w-100.mw-dd.pa0.bg-transparent.bn.outline-0.tc",{id:`${l}-dd`,name:`${r}-dd`,type:"text",placeholder:"DD",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:o,readonly:c,disabled:u,tabindex:d,value:this.day(),"aria-label":`${r}: Day`,class:`${p} maxw-dd p-0px`,onfocus:t.partial(this.focusedInput,"dd"),onkeydown:e=>{gt(l,"dd",this.day(),this.dom(),e,this.literalKey(),{next:this.findNextInput("day"),prev:this.findPrevInput("day")})},oninput:()=>{Lt(this.day,l,"dd",this.dom(),this.findNextInput("day"));this.buildDate(s,n)},onblur:()=>{vt(this.day);this.buildDate(s,n)}});case"month":return i("input.w-100.mw-mm.pa0.bg-transparent.bn.outline-0.tc",{id:`${l}-mm`,name:`${r}-mm`,type:"text",placeholder:"MM",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:o,readonly:c,disabled:u,tabindex:d,value:this.month(),"aria-label":`${r}: Month`,class:`${p} maxw-mm p-0px`,onkeydown:e=>{gt(l,"mm",this.month(),this.dom(),e,this.literalKey(),{next:this.findNextInput("month"),prev:this.findPrevInput("month")})},oninput:()=>{Lt(this.month,l,"mm",this.dom(),this.findNextInput("month"));this.buildDate(s,n)},onfocus:t.partial(this.focusedInput,"mm"),onblur:()=>{vt(this.month);this.buildDate(s,n)}});case"year":return i("input.w-100.mw-yyyy.pa0.bg-transparent.bn.outline-0.tc",{id:`${l}-yyyy`,name:`${r}-yyyy`,type:"text",placeholder:"YYYY",minlength:"4",maxlength:"4",pattern:"[0-9]*",inputmode:"numeric",required:o,readonly:c,disabled:u,tabindex:d,value:this.year(),"aria-label":`${r}: Year`,class:`${p} maxw-yyyy p-0px`,onfocus:t.partial(this.focusedInput,"yyyy"),onkeydown:e=>{gt(l,"yyyy",this.year(),this.dom(),e,this.literalKey(),{next:this.findNextInput("year"),prev:this.findPrevInput("year")})},oninput:()=>{Lt(this.year,l,"yyyy",this.dom(),this.findNextInput("year"));this.buildDate(s,n)}})}}resetDateParts(){this.day("");this.month("");this.year("")}oninit({attrs:{value:e,field:t}}){const{required:i,config:a}=t;this.valid(!i);this.valueChange=e.map((e=>{if(e){const t=new Date(String(e));this.date("");if(isNaN(t.valueOf())){this.resetDateParts()}else{const[e,i,a]=Tt(t);this.day(a);this.month(i);this.year(e)}}else if(!this.date()){this.resetDateParts()}this.valid(Ot(this.year(),this.month(),this.day(),t,this.dom()))}));this.locale.map((e=>this.setDateInputs(e)));this.setLocale(a)}oncreate({dom:e}){z(this.dom,e)}onbeforeupdate({attrs:{field:e}}){this.setLocale(e.config);this.valid(Ot(this.year(),this.month(),this.day(),e,this.dom()))}onupdate({dom:e}){z(this.dom,e)}onremove(){this.valueChange.end(true);this.date.end(true);this.year.end(true);this.month.end(true);this.day.end(true);this.locale.end(true)}view(e){const{attrs:{field:t,value:a}}=e;const{id:n,name:s=n,required:l,readonly:r,disabled:o,min:c,max:u}=t;return i(et,{field:t,value:a,invalid:!this.valid(),focus:false},i(".flex.items-center",[i(".relative.flex-auto.ph-2px.pv-1px",{onclick:()=>ht(this.dom(),n,this.focusedInput())},i("input.absolute.pa0.w1.o-0.pe-none[type=date]",{id:n,name:s,value:a(),required:l,readonly:r,disabled:o,min:c,max:u,tabindex:-1,ariaHidden:"true"}),this.dateParts.map((t=>this.createDateInputs(t,e)))),!(o||r)&&i($t,{field:t,value:a})]))}}class Pt{static formatValue(e){const t=e();return t!=null?t.padStart(2,"0").slice(0,2):"-"}static applyStep(e,t,i,a){const n=Number(Pt.formatValue(e));const s=isNaN(n)?i:n;const l=s+t;const r=l<i||l>a?s:l;e(r.toString())}view({attrs:{value:e,step:t=1,min:a,max:n,config:s}}){return i(".flex.flex-column.items-center",[i(".pointer",{onclick:()=>Pt.applyStep(e,t,a,n)},P(C("timeScrollerUpIcn",s),"")),i("span.mv2.w-100.mw-dd.tc.f6.fw6",{class:o.timeInputScrollerNumber},Pt.formatValue(e)),i(".pointer",{onclick:()=>Pt.applyStep(e,-t,a,n)},P(C("timeScrollerDownIcn",s),""))])}}class Ft{oncreate({dom:e,attrs:{onClose:t}}){this.dom=e;this.clickListener=e=>{if(e.target&&!this.dom.contains(e.target)){t();i.redraw()}};document.addEventListener("click",this.clickListener)}onremove(){document.removeEventListener("click",this.clickListener)}view({attrs:{hour:e,min:t,step:a,config:n}}){return i(".flex.items-center.absolute.z-max.us-none",{class:o.timeInputScrollerWrapper},[i(Pt,{value:e,min:0,max:23,config:n}),i("span.ph2.f6",":"),i(Pt,{value:t,min:0,max:59,step:a,config:n})])}}function qt(e){return e.replace(/[^0-9]/g,"").slice(0,2)}function Bt(e){return e.padStart(2,"0")}class Et extends Ge{constructor(){super(...arguments);this.showPicker=false;this.focus=0;this.hour=a();this.cleanHour=this.hour.map(qt);this.padHour=this.cleanHour.map(Bt);this.min=a();this.cleanMin=this.min.map(qt);this.padMin=this.cleanMin.map(Bt);this.time=a.lift(((e,t)=>e&&t?`${e}:${t}`:""),this.padHour,this.padMin)}syncTime(e){const t=e();if(t!==this.time()){const[e,i=""]=String(t).split(":");this.hour(e);this.min(i)}}oninit({attrs:{value:e}}){this.time.map((t=>e(t)));this.syncTime(e)}onbeforeupdate({attrs:{value:e}}){this.syncTime(e)}onremove(){this.time.end(true);this.min.end(true);this.hour.end(true)}view({attrs:e}){const{field:t,value:a}=e;const{id:n,name:s=n,step:l,required:r,readonly:o,disabled:c,uiClass:u={},config:d}=t;const h=y(u);return i(et,{field:t,value:a,invalid:this.invalid,focus:this.inFocus},i(".flex.items-center",[i(".relative.flex-auto.ph-2px.pv-1px",{},[i("input.absolute.pa0.w1.o-0.pe-none[type=text]",{name:s,value:a(),required:r,readonly:o,disabled:c,tabindex:-1,ariaHidden:"true"}),i("input.di.w-100.mw-tt.pa0.bg-transparent.bn.outline-0.tc",{id:`${n}-hh`,name:`${s}-hh`,type:"number",placeholder:"--",min:0,max:23,required:r,readonly:o,disabled:c,"aria-label":`${s}: Hour`,value:this.focus===1?this.cleanHour():this.padHour(),class:h,oninput:H(this.hour),onfocus:()=>this.focus=1,onblur:()=>{this.focus=0;this.touch()}}),i(".di.mr-2px",":"),i("input.di.w-100.mw-tt.pa0.bg-transparent.bn.outline-0.tc",{id:`${n}-mm`,name:`${s}-mm`,type:"number",placeholder:"--",min:0,max:59,step:l,required:r,readonly:o,disabled:c,"aria-label":`${s}: Minute`,value:this.focus===2?this.cleanMin():this.padMin(),class:h,oninput:H(this.min),onfocus:()=>this.focus=2,onblur:()=>this.focus=0}),this.showPicker&&i(Ft,{hour:this.hour,min:this.min,step:l==="any"?1:l,config:d,onClose:()=>this.showPicker=false})]),!(c||o)&&i(".pointer",{onclick:()=>this.showPicker=true},P(C("timePickerIcn",d),"ph-2px pv-1px"))]))}}class Mt extends Ge{constructor(){super(...arguments);this.showPassword=a(false)}view({attrs:e}){const{field:t,value:a}=e;const{label:n,id:s,name:l=s,title:r=E(n),placeholder:o,maxlength:c,minlength:u,required:d,readonly:h,disabled:p,autofocus:f,autocomplete:m,tabindex:g,pattern:b,inputmode:v,instant:x,uiClass:w={},config:k}=t;return i(Qe,{field:t,value:a,invalid:this.invalid,focus:this.inFocus},i(".flex.flex-row.w-100",[i("input.w-100.bg-transparent.bn.outline-0",{id:s,name:l,title:r,placeholder:o,type:this.showPassword()?"text":"password",maxlength:c,minlength:u,required:d,readonly:h,disabled:p,autofocus:f,autocomplete:m,tabindex:g,pattern:b,inputmode:v,class:y(w),value:a(),autocorrect:"off",[x?"oninput":"onchange"]:H(a)}),i(".ml1.pointer.dim",{title:C("showPassTxt",k),onclick:()=>this.showPassword(!this.showPassword()),tabindex:0,onkeydown:K},P(C(this.showPassword()?"hidePassIcn":"showPassIcn",k),"db pa1"))]))}}class Rt extends Je{labelTranslateY(){return"0.5ex"}}class _t extends Qe{constructor(){super(...arguments);this.layout=Rt}}class At extends Ge{constructor(){super(...arguments);this.selector="textarea"}view({attrs:e}){const{field:t,value:a,xform:n=a}=e;const{label:s,id:l,name:r=l,title:o=E(s),placeholder:c,required:u,readonly:d,disabled:h,autofocus:p,autocomplete:f,minlength:m,maxlength:g,tabindex:b,spellcheck:v,rows:y,cols:x,wrap:k,instant:I,uiClass:S={}}=e.field;return i(_t,{field:t,value:a,xform:n,invalid:this.invalid,focus:this.inFocus},i("textarea.w-100.bg-transparent.bn.outline-0.h-100.resize-none",{id:l,name:r,title:o,placeholder:c,required:u,readonly:d,disabled:h,autofocus:p,autocomplete:f,minlength:m,maxlength:g,tabindex:b,spellcheck:v,rows:y,cols:x,wrap:k,class:w(S),value:a(),[I?"oninput":"onchange"]:H(a)}))}}class Nt extends Ge{constructor(){super(...arguments);this.onIcon="checkIcn";this.offIcon="uncheckIcn"}view({attrs:{field:e,value:t}}){const{label:a,id:n,name:s=n,value:l,title:r=E(a),required:c,readonly:u,disabled:d,autocomplete:h,tabindex:f="0",uiClass:g={},config:b}=e;return i("div",{class:m(g,d)},i("fieldset.w-100.bn",{class:v(e)},[i("input.clip[type=checkbox]",{id:n,name:s,value:l,checked:t(),required:c,autocomplete:h,disabled:d||u,tabindex:-1,"aria-hidden":"true",onchange:V(t,l)}),i("label.db",{class:p([x(e),this.invalid?o.invalidCheckboxWrapper:""]),for:n,title:r,"data-input-id":n,"aria-label":a,tabindex:f,onkeydown:e=>{if(e.key===" "){t(!t())}}},i(Se,{selected:Boolean(t()),label:a?i("span.mh1",M(a,c)):null,onIcon:C(this.onIcon,b),offIcon:C(this.offIcon,b),config:b}))]))}}class Ut extends Ge{constructor(){super(...arguments);this.onIcon="toggleOnIcn";this.offIcon="toggleOffIcn"}toggle(e,t,a){const n=Boolean(t());const{label:s,id:l,name:r=l,value:c,title:u=E(s),required:d,readonly:h,disabled:f,autocomplete:m,tabindex:g="0",config:b}=e;return[i("input.clip[type=checkbox]",{id:l,name:r,value:c,checked:t(),required:d,autocomplete:m,disabled:f||h,tabindex:-1,"aria-hidden":"true",onchange:V(t,c)}),i("label.db.flex.justify-content.items-center",{class:p([x(e),this.invalid?o.invalidCheckboxWrapper:""]),for:l,title:u,"data-input-id":l,"aria-label":s,tabindex:g,onkeydown:e=>{if(e.key===" "){t(!t())}}},[i(".toggle-outer.relative.dib.transition-bg",{class:n?C("toggleOnWrapper",b):C("toggleOffWrapper",b)},P(C(n?this.onIcon:this.offIcon,b),p(["toggle-inner absolute tc transition-transform",n?"toggle-on":null]))),a])]}view({attrs:{field:e,value:t}}){const{label:a,required:n,disabled:s,uiClass:l,layout:r}=e;return r?i(Qe,{field:e,value:t,invalid:this.invalid,focus:false},this.toggle(e,t,null)):i("div",{class:m(l,s)},i("fieldset.w-100.bn",{class:v(e)},this.toggle(e,t,[a?i("span.mh1",M(a,n)):null])))}}class Wt extends Ge{view({attrs:e}){const{field:t,value:a}=e;const{label:n,id:s,name:l,value:r,title:o=E(n),required:c,readonly:u,disabled:d,autocomplete:h,tabindex:p="0",uiClass:f={},config:g}=t;const b=a()===r;return i("div",{class:m(f,d)},i("fieldset.w-100.bn",{class:v(t)},[i("input.clip[type=radio]",{id:s,name:l,value:r,checked:b,required:c,autocomplete:h,disabled:d||u,tabindex:-1,"aria-hidden":"true",onchange:H(a)}),i("label.db",{class:x(t),for:s,title:o,"data-input-id":s,"aria-label":n,tabindex:p,onkeydown:e=>{var t;if(e.key===" "){((t=document.activeElement)===null||t===void 0?void 0:t.firstElementChild).click()}}},i(Se,{selected:b,label:n?i("span.mh1",M(n,c)):null,onIcon:C("radioOnIcn",g),offIcon:C("radioOffIcn",g),config:g}))]))}}class Ht extends Ge{constructor(){super(...arguments);this.selector="select"}view({attrs:e}){const{field:a,value:n}=e;const{label:s,id:l,name:r=l,title:c=s,required:u,readonly:d,disabled:h,multiple:f,autofocus:m,autocomplete:g,tabindex:b,uiClass:v={},placeholder:x="Select",options:w=[]}=a;const k=n();return i(et,{field:a,value:n,invalid:this.invalid,focus:this.inFocus},[s?null:i("legend.screenreader",{id:`${l}-legend`},"Select"),i("select.w-100.bg-transparent.bn.outline-0",{id:l,name:r,title:c,required:u,multiple:f,autofocus:m,autocomplete:g,tabindex:b,disabled:h||d,class:p([y(v),k?"":o.floatLabelPlaceholder]),value:k!==null&&k!==void 0?k:"",onchange:H(n),"aria-labelledby":`${l}-legend`},[t.some(w,(({value:e})=>!e))?null:i("option",{value:"",disabled:true},x),t.map(w,(({value:e,label:t=e})=>i("option",{value:e,disabled:!e||h||d},t)))])])}}class Vt{oncreate({dom:e}){this.container=e}onbeforeupdate({attrs:{visible:e}},{attrs:{visible:t}}){if(e===t){return e}else{this.container.style.height=e?"auto":this.container.getBoundingClientRect().height+"px";return true}}view({attrs:{items:e,idx:t,visible:a,component:n,fragment:s}}){return i("div",{"data-idx":t},a?e.map((e=>i.fragment(s(e),[i(n,e)]))):null)}}class zt{constructor(){this.scrollHandler=t.throttle((e=>{const t=e.scrollTop/e.scrollHeight||0;this.controller.updateScroll(t)}),50,{leading:false})}static fragment(){return{}}oninit({attrs:{controller:e}}){this.controller=e}view({attrs:{component:e,classes:t="overflow-y-auto",fragment:a=zt.fragment}}){return i("div",{class:t,onscroll:e=>{e.redraw=false;this.scrollHandler(e.target)}},this.controller.render((({items:t,idx:n,visible:s})=>i(Vt,{items:t,idx:n,visible:s,component:e,fragment:a}))))}}class jt{static clampRange(e,t,i){return Math.max(e,Math.min(t,i))}static single(e){const t=new jt((()=>e().then((e=>{t.updateDataStore(e);t.applySort();i.redraw()}))));return t}static paging(e){const t=jt.BLOCK_SIZE*4;const a=new jt((n=>e(n,t+1).then((e=>{if(e.length>t){a.updateDataStore(e.slice(0,t),true)}else{a.updateDataStore(e)}i.redraw()}))));return a}get data(){return this.dataStore}get sortedData(){return this.sortedDataStore}get filteredData(){return this.filteredDataStore}get availableBlocks(){return Math.ceil(this.filteredDataStore.length/jt.BLOCK_SIZE)}get loading(){return this.isLoading}setSort(e){this.sortFn=e}applySort(){this.sortedDataStore=this.sortFn(this.dataStore);this.applyFilter()}setFilter(e){this.filterFn=e}applyFilter(){this.filteredDataStore=this.filterFn(this.sortedDataStore);this.invalidate();this.updateBlockRange()}reload(){this.bufferReload=this.loading;if(!this.bufferReload){this.dataStore.splice(0,this.dataStore.length);this.invalidate();this.load()}}updateScroll(e){if(this.dataStore.length>0){this.scrollPct=e;this.updateBlockRange()}}updateDataStore(e,t=false){this.loadMore=t;this.dataStore.push(...e);this.updateBlockRange()}render(e){return this.blockStore.map(((t,i)=>e({items:t,idx:i,visible:i>=this.startBlock&&i<this.endBlock})))}debug(){return{data:this.data.length,filtered:this.filteredData.length,blocks:this.blockStore.length,start:this.startBlock,end:this.endBlock}}constructor(e){this.dataLoader=e;this.dataStore=[];this.sortFn=t.identity;this.sortedDataStore=this.dataStore;this.filterFn=t.identity;this.filteredDataStore=this.sortedDataStore;this.blockStore=[];this.scrollPct=0;this.startBlock=-1;this.endBlock=-1;this.loadMore=false;this.isLoading=false;this.bufferReload=false;this.load()}invalidate(){this.startBlock=-1;this.endBlock=-1;this.blockStore.splice(0,this.blockStore.length)}load(){if(!this.loading){this.isLoading=true;i.redraw();this.dataLoader(this.data.length).catch(console.error).then((()=>{this.isLoading=false;if(this.bufferReload){this.reload()}}))}}updateBlockRange(){const e=jt.clampRange(0,Math.floor(this.scrollPct*this.blockStore.length)-1,this.availableBlocks-jt.BLOCK_RANGE);if(e!==this.startBlock){this.startBlock=e;this.endBlock=e+jt.BLOCK_RANGE;this.ensureBlockStore();i.redraw()}}ensureBlockStore(){let e=this.blockStore.length*jt.BLOCK_SIZE;const t=Math.min(this.endBlock,this.availableBlocks)*jt.BLOCK_SIZE;while(e<t){const t=e+jt.BLOCK_SIZE;this.blockStore.push(this.filteredDataStore.slice(e,t));e=t}if(this.loadMore&&t>=this.dataStore.length){this.load()}}}jt.BLOCK_SIZE=25;jt.BLOCK_RANGE=3;class Kt extends Ge{constructor(){super(...arguments);this.onIcon="checkIcn";this.offIcon="uncheckIcn";this.opts=[];this.selected=new Set;this.open=false;this.openTs=0;this._focusOption=null;this.keySearch=""}get focusOption(){return this._focusOption}set focusOption(e){this.open=e!=null;this._focusOption=e;if(!this.open){this.applyFilter("")}}toggleOpen(){const e=Date.now();if(e-this.openTs>333){this.open=!this.open;this.openTs=e}}toggleSelection(e,t,i){if(!i){this.selected.clear();this.focusOption=null}if(this.selected.has(e)){this.selected.delete(e)}else{this.selected.add(e)}t(Array.from(this.selected).join(","));this.changeInput(t)}moveFocus(e){const i=this.list.filteredData;const a=t.findIndex(i,(({value:e})=>e===this.focusOption));const n=t.clamp(a+e,0,i.length-1);this.focusOption=i[n].value}applyFilter(e){this.keySearch=e;this.list.applyFilter()}keyNav(e,t,i){if(e.altKey||e.ctrlKey||e.metaKey){return}switch(e.key){case"ArrowDown":{e.preventDefault();this.moveFocus(1);break}case"ArrowUp":{e.preventDefault();this.moveFocus(-1);break}case" ":case"Enter":{e.preventDefault();if(this.focusOption!=null){this.toggleSelection(String(this.focusOption),t,i)}else{this.toggleOpen()}break}case"Escape":{e.preventDefault();this.focusOption=null;break}case"Delete":{e.preventDefault();this.applyFilter("");break}case"Backspace":{e.preventDefault();this.applyFilter(this.keySearch.slice(0,-1));break}default:if(e.key.length===1){e.preventDefault();this.applyFilter(this.keySearch+e.key.toLowerCase())}}}placeHolder(e,t){var i;const a=e.filter((({value:e})=>this.selected.has(String(e))));if(a.length>1){return`${a.length} Selected`}else if(a.length===1){return(i=a[0].label)!==null&&i!==void 0?i:t}else{return t}}syncSelection(e){if(e()!=null){const i=String(e());const a=i===""?[]:i.split(",");const n=new Set(a);if(!t.isEqual(this.selected,n)){this.selected=n}}}oninit({attrs:{field:{options:e=[]},value:t}}){this.opts=e;this.list=jt.single((()=>Promise.resolve(this.opts)));this.list.setFilter((e=>e.filter((({value:e,label:t=e})=>String(t).toLowerCase().includes(this.keySearch)))));this.syncSelection(t)}onbeforeupdate({attrs:{field:{options:e=[]},value:i}}){this.syncSelection(i);if(!t.isEqual(e,this.opts)){this.opts=e;this.list.reload()}}view({attrs:e}){const{field:t,value:a}=e;const{label:n,id:s,name:l=s,title:r=n,required:c,readonly:u,disabled:d,multiple:h,uiClass:f={},placeholder:m="Select",options:g=[],config:b}=t;const v=!(d||u);return i(et,{field:t,value:a,invalid:this.invalid,focus:this.inFocus},[i("input.clip[type=text]",{name:l,value:a(),required:c,tabindex:-1,ariaHidden:"true"}),i(".relative.cursor-default",{id:s,title:r,disabled:!v,tabindex:v?0:-1,role:"listbox",onclick:()=>v?this.toggleOpen():undefined,onfocusin:()=>v?this.toggleOpen():undefined,onfocusout:()=>this.focusOption=null,"aria-activedescendant":`${s}-${this.focusOption}`,onkeydown:v?e=>this.keyNav(e,a,h):undefined},[i(".flex.items-center.ph-2px.pv-1px",{class:y(f)},[this.keySearch?i(".flex-auto",this.keySearch):i(".flex-auto",{class:this.selected.size?undefined:o.floatLabelPlaceholder},this.placeHolder(g,m)),P(C("checkListIcn",b),p(["transition-transform",this.open?"rotate-180":null]))]),this.open&&i(zt,{controller:this.list,classes:p(["absolute z-max us-none",o.checkListOptionsWrapper,C("checkListDropUp",b)?"bottom-0":"mt3"]),component:h?{view:({attrs:e})=>this.multiSelectionRow(a,s,e,b)}:{view:({attrs:e})=>this.singleSelectionRow(a,s,e)}})])])}singleSelectionRow(e,t,a){const{value:n,label:s=n}=a;const l=this.selected.has(String(n));const r=n===this.focusOption?"true":undefined;return i(".ui-widgets-option.cursor-default",{id:`${t}-${n}`,class:p([o.checkListOption,l?o.checkListOptionSingleSelected:null]),role:"option",ariaSelected:l,"aria-activedescendant":r,onclick:t=>{t.stopPropagation();this.toggleSelection(String(n),e)}},i("span",{class:o.checkListOptionLabel},s))}multiSelectionRow(e,t,a,n){const{value:s,label:l=s}=a;const r=this.selected.has(String(s));const c=r?C(this.onIcon,n):C(this.offIcon,n);const u=s===this.focusOption?"true":undefined;return i(".ui-widgets-option.cursor-default",{id:`${t}-${s}`,class:p([o.checkListOption,r?o.checkListOptionMultiSelected:null]),role:"option",ariaSelected:r,"aria-activedescendant":u,onclick:t=>{t.stopPropagation();this.toggleSelection(String(s),e,true)}},[P(c,o.checkListOptionIcon),i("span",{class:o.checkListOptionLabel},l)])}}class Yt extends Ge{constructor(){super(...arguments);this.onIcon="checkIcn";this.offIcon="uncheckIcn";this.opts=[];this.selected=new Set;this.open=false;this.openTs=0;this.focusOption=null;this._focusOptionValue=null;this.keySearch=""}static flattenOpts(e){return t.flatMap(e,(({groupLabel:e,groupId:t,options:i=[]})=>[{groupId:t,value:t,label:e,header:true},...i.map((e=>Object.assign({groupId:t},e)))]))}get focusOptionValue(){return this._focusOptionValue}set focusOptionValue(e){this.open=e!=null;this._focusOptionValue=e;if(!this.open){this.applyFilter("")}}toggleOpen(){const e=Date.now();if(e-this.openTs>333){this.open=!this.open;this.openTs=e}}selectGroup(e){const t=this.opts.filter((t=>t.groupId===e&&t.header!==true));const i=t.filter((e=>this.selected.has(String(e.value))));if(t.length===i.length){this.selected.add(e)}}toggleSelection(e,t){const{value:i,groupId:a,header:n=false}=e;const s=String(i);const l=this.selected.has(s);if(n){this.opts.forEach((e=>{if(e.groupId===a){if(l){this.selected.delete(String(e.value))}else{this.selected.add(String(e.value))}}}))}if(l){this.selected.delete(s);this.selected.delete(a)}else{this.selected.add(s);this.selectGroup(a)}t(this.opts.filter((({value:e,header:t})=>t!==true&&this.selected.has(String(e)))).map((({value:e})=>e)).join(","));this.changeInput(t)}moveFocus(e){const i=this.list.filteredData;const a=t.findIndex(i,(({value:e})=>e===this.focusOptionValue));const n=t.clamp(a+e,0,i.length-1);this.focusOptionValue=i[n].value;this.focusOption=i[n]}applyFilter(e){this.keySearch=e;this.list.applyFilter()}keyNav(e,t){if(e.altKey||e.ctrlKey||e.metaKey){return}switch(e.key){case"ArrowDown":{e.preventDefault();this.moveFocus(1);break}case"ArrowUp":{e.preventDefault();this.moveFocus(-1);break}case" ":case"Enter":{e.preventDefault();if(this.focusOptionValue!=null&&this.focusOption!=null){this.toggleSelection(this.focusOption,t)}else{this.toggleOpen()}break}case"Escape":{e.preventDefault();this.focusOptionValue=null;break}case"Delete":{e.preventDefault();this.applyFilter("");break}case"Backspace":{e.preventDefault();this.applyFilter(this.keySearch.slice(0,-1));break}default:if(e.key.length===1){e.preventDefault();this.applyFilter(this.keySearch+e.key.toLowerCase())}}}placeHolder(e){var t;const i=this.opts.filter((({value:e,header:t})=>t!==true&&this.selected.has(String(e))));if(i.length>1){return`${i.length} Selected`}else if(i.length===1){return(t=i[0].label)!==null&&t!==void 0?t:e}else{return e}}syncSelection(e){if(e()!=null){const i=String(e());const a=i===""?[]:i.split(",");const n=new Set(a);if(!t.isEqual(this.selected,n)){this.selected=n;this.opts.filter((({header:e})=>e)).forEach((({groupId:e})=>this.selectGroup(e)))}}}oninit({attrs:{field:{groups:e=[]},value:t}}){this.opts=Yt.flattenOpts(e);this.list=jt.single((()=>Promise.resolve(this.opts)));this.list.setFilter((e=>e.filter((({value:e,label:t=e})=>String(t).toLowerCase().includes(this.keySearch)))));this.syncSelection(t)}onbeforeupdate({attrs:{field:{groups:e=[]},value:i}}){this.syncSelection(i);const a=Yt.flattenOpts(e);if(!t.isEqual(a,this.opts)){this.opts=a;this.list.reload()}}view({attrs:e}){const{field:t,value:a}=e;const{label:n,id:s,name:l=s,title:r=n,required:c,readonly:u,disabled:d,uiClass:h={},placeholder:f="Select",config:m}=t;const g=!(d||u);return i(et,{field:t,value:a,invalid:this.invalid,focus:this.inFocus},[i("input.clip[type=text]",{name:l,value:a(),required:c,tabindex:-1,ariaHidden:"true"}),i(".relative.cursor-default",{id:s,title:r,disabled:!g,tabindex:g?0:-1,role:"listbox",class:y(h),onclick:()=>g?this.toggleOpen():undefined,onfocusin:()=>g?this.toggleOpen():undefined,onfocusout:()=>this.focusOptionValue=null,"aria-activedescendant":`${s}-${this.focusOptionValue}`,onkeydown:g?e=>this.keyNav(e,a):undefined},[i(".flex.items-center.ph-2px.pv-1px",{class:y(h)},[this.keySearch?i(".flex-auto",this.keySearch):i(".flex-auto",{class:this.selected.size?undefined:o.floatLabelPlaceholder},this.placeHolder(f)),P(C("checkListIcn",m),p(["transition-transform",this.open?"rotate-180":null]))]),this.open&&i(zt,{controller:this.list,classes:p(["absolute z-max us-none",o.checkListOptionsWrapper,C("checkListDropUp",m)?"bottom-0":"mt3"]),component:{view:({attrs:e})=>this.multiSelectionRow(a,s,e)}})])])}multiSelectionRow(e,t,a,n){const{value:s,label:l=s,header:r}=a;const c=this.selected.has(String(s));const u=c?C(this.onIcon,n):C(this.offIcon,n);const d=s===this.focusOptionValue?"true":undefined;return i(".ui-widgets-option.cursor-default",{id:`${t}-${s}`,class:p([o.checkListOption,r?o.checkListGroupHeaders:o.checkListGroupChildren]),role:"option",ariaSelected:c,"aria-activedescendant":d,onclick:t=>{t.stopPropagation();this.toggleSelection(a,e)}},[P(u,o.checkListOptionIcon),i("span",{class:o.checkListOptionLabel},l)])}}class Gt{constructor(){this.dragging=a(false)}view({attrs:{field:e,value:a,displayType:n}}){const s=t.head(a());const{disabled:l,uiClass:r={},config:o,readonly:c}=e;const u=n==="none"||!s?C("addFileTxt",o):s.name;return i("div",{class:m(r,l)},i(Fe,{field:e,multiple:false,dragging:this.dragging,onSet:qe(a,true),value:a},i(".flex.items-center.pa1",{class:k(r,this.dragging(),Ce(e,a()))},[P(C("uploadIcn",o),"pa1"),i("span.ma1.flex-auto",u),s&&n!=="none"?[i(Re,s),!(c||l)&&i("i.pa1.pointer.dim",{title:`Remove ${s.name}`,class:C("cancelIcn",o),onclick:Be(a,s.guid)})]:null])))}}function Zt(e,a,n=false){return s=>{const l=n?[]:e();return Promise.all(t.map(s,(e=>se(e,a,e.type).then((t=>{const i=Z(G(t),e.name);l.push({guid:q(),name:i.name,path:"not_set",file:i,dataUrl:t})}))))).then((()=>{e(l);i.redraw()}))}}class Jt{constructor(){this.dragging=a(false)}view({attrs:{field:e,value:a}}){const{disabled:n,uiClass:s={},config:l,readonly:r}=e;return i("div",{class:m(s,n)},[i(Fe,{field:e,defaultAccept:"image/*",dragging:this.dragging,onSet:Zt(a,C("imageMaxSize",l)),value:a},i(".w-100.pa1.dt.tc",{class:k(s,this.dragging(),Ce(e,a()))},i("i.fa-2x.dtc.v-mid",{class:C("cameraIcn",l)}))),i(".flex.flex-row.flex-wrap.mt1.nr1.nb1.nl1.max-h-thumb",t.map(a(),(e=>i(Me,{src:_(e.path,e.dataUrl)},!(r||n)&&i(".absolute.top-0.right-0.child",i(de,{title:`Remove ${e.name}`,icon:C("deleteIcn",l),onclick:Be(a,e.guid)}))))))])}}class Qt{constructor(){this.dragging=a(false)}view({attrs:{field:e,value:a}}){const n=t.head(a());const{disabled:s,uiClass:l={},config:r,readonly:o}=e;return i("div",{class:m(l,s)},i(Fe,{field:e,defaultAccept:"image/*",multiple:false,dragging:this.dragging,onSet:Zt(a,C("imageMaxSize",r),true),value:a},i(".pa1",{class:k(l,this.dragging(),Ce(e,a()))},i(".relative.w-100.dt.tc",n?[i("img.img.contain.max-h-img",{title:n.name,src:_(n.path,n.dataUrl)}),!(o||s)&&i(".absolute.top-0.right-0.pa1.pointer.dim",{title:`Remove ${n.name}`,onclick:Be(a,n.guid)},i("i.pa1",{class:C("cancelIcn",r)}))]:i("i.fa-2x.dtc.v-mid",{class:C("cameraIcn",r)})))))}}class Xt{oncreate({dom:e}){const i=e.children[0];const a=B();this.signaturePad=new l(i,{minWidth:.5*a,maxWidth:1.5*a});const n=()=>{const e=B();i.width=i.offsetWidth*e;i.height=i.offsetHeight*e;const t=i.getContext("2d");t.scale(e,e);this.resetCanvas()};this.resizeHandler=t.debounce(n,250);window.addEventListener("resize",this.resizeHandler);window.addEventListener("orientationchange",this.resizeHandler);n()}onremove(){this.resizeHandler.cancel();window.removeEventListener("resize",this.resizeHandler);window.removeEventListener("orientationchange",this.resizeHandler)}view({attrs:{style:e,config:t,onSet:a,onCancel:n}}){return[i(".aspect-ratio.bg-white.ba.bw1.br3.b--dashed.b--black-30",{style:e},i("canvas.aspect-ratio--object")),i(".absolute.top-0.right-0.z-999.translate-up-100",[i(de,{title:C("applyTtl",t),icon:C("applyIcn",t),classes:"ma1",onclick:()=>{if(!this.signaturePad.isEmpty()){a(this.signaturePad.toDataURL("image/png"))}}}),i(de,{title:C("resetTtl",t),icon:C("resetIcn",t),classes:"ma1",onclick:()=>this.resetCanvas()}),i(de,{title:C("cancelTtl",t),icon:C("cancelIcn",t),classes:"ma1",onclick:n})])]}resetCanvas(){this.signaturePad.clear()}}class ei{constructor(){this.text=a("")}oncreate({dom:e}){const t=e.children[0];t.focus({preventScroll:false});this.scaleText(e)}onupdate({dom:e}){this.scaleText(e)}view({attrs:{heightPct:e,style:a,config:n,onSet:s,onCancel:l}}){const r=t.flow([t.partial(oe,this.text(),e,n),t.partialRight(s,{text:this.text(),heightPct:e}),t.stubFalse]);return[i("form.aspect-ratio.ba.bw1.br3.b--dashed.b--black-30",{style:a,onsubmit:r},i("input.aspect-ratio--object.pa2.ba.bw0[type=text]",{oninput:H(this.text),style:{fontFamily:C("signFont",n)},value:this.text()})),i(".absolute.top-0.right-0.z-999.translate-up-100",[i(de,{title:C("applyTtl",n),icon:C("applyIcn",n),classes:"ma1",onclick:r}),i(de,{title:C("resetTtl",n),icon:C("resetIcn",n),classes:"ma1",onclick:()=>this.text("")}),i(de,{title:C("cancelTtl",n),icon:C("cancelIcn",n),classes:"ma1",onclick:l})])]}scaleText(e){const t=e.clientHeight;e.style.fontSize=`${.56*t}px`}}class ti{view({attrs:{heightPct:e,stampTxt:a,stampSetTxt:n,config:s,onSet:l}}){return[i("span.clip",{style:{fontFamily:C("signFont",s)}},n),i(".flex",i(de,{label:a,classes:`flex-auto ${C("stampBtnClass",s)}`,context:C("stampBtnContext",s),onclick:t.flow([t.partial(oe,n,e,s),t.partialRight(l,{text:n,heightPct:e})])}))]}}const ii={["draw"]:Xt,["type"]:ei,["stamp"]:ti};function ai(e,t,a){return(n,s)=>le(n,a).then((a=>{e([J(a,`sign-${t}.png`,s)]);i.redraw()}))}class ni{oninit({attrs:{value:e}}){this.valUpdate=e.map((()=>this.setSignType()))}onremove(){this.valUpdate.end()}view({attrs:{field:e,value:a}}){const{label:n,id:s,readonly:l,disabled:r,tabindex:c="0",uiClass:u={},config:d,options:h,heightPct:p=C("signHeightPct",d),stampTxt:f=C("stampTxt",d),stampSetTxt:g=C("stampSetTxt",d)}=e;const b={paddingBottom:`${p}%`};const v=t.head(a());const y=h?t(h).map((({value:e})=>String(e)in ii?e:null)).compact().value():C("signOpts",d);const x=t.map(y,(e=>{switch(e){case"draw":return{type:e,icon:C("drawIcn",d),label:C("signDrawTxt",d)};case"type":return{type:e,icon:C("typeIcn",d),label:C("signTypeTxt",d)};case"stamp":return{type:e,icon:C("stampIcn",d),label:C("signStampTxt",d)}}}));if(x.length===1&&!v){this.setSignType(x[0].type)}return i("div.relative",{class:m(u,r)},[U(s,u,n),l||r?i(".aspect-ratio",{id:s,style:b},v?i(".aspect-ratio--object",{class:"pe-none"},i("img.img.w-100.absolute",{src:_(v.path,v.dataUrl)})):null):this.signType?i(ii[this.signType],{heightPct:p,stampTxt:f,stampSetTxt:g,style:b,config:d,onSet:ai(a,s,C("signMaxSize",d)),onCancel:t.bind(this.setSignType,this,undefined)}):i(".aspect-ratio.pointer",{id:s,class:o.fileInputWrapper,style:b},v?i(".aspect-ratio--object.dim",{onclick:t.bind(a,this,[])},[i("img.img.w-100.absolute",{src:_(v.path,v.dataUrl)}),i(".absolute.top-1.right-1",i("i.fa-2x",{class:C("resetIcn",d),tabindex:0,onkeydown:K}))]):i(".aspect-ratio--object.flex",t.map(x,(({type:e,icon:a,label:n})=>i(".flex-auto.flex.items-center.justify-center.dim",{title:n,tabindex:c,onkeydown:K,onclick:t.bind(this.setSignType,this,e)},P(a,"fa-2x ma1"),i("span.ma1.dn.db-ns.truncate",n))))))])}setSignType(e){this.signType=e}}function si(e,a){return n=>{const s=a?[]:e();return Promise.all(t.map(n,(e=>{if(X(e.type)){return se(e,O.imageMaxSize,e.type).then((t=>{const i=Z(G(t),e.name);s.push({guid:q(),name:i.name,path:"not_set",file:i,dataUrl:t})}))}else{s.push({guid:q(),name:e.name,path:"not_set",file:e});return Promise.resolve()}}))).then((()=>{e(s);i.redraw()}))}}class li{constructor(){this.dragging=a(false)}view({attrs:e}){const{field:t,value:a}=e;const{disabled:n,uiClass:s={}}=t;return i("div",{class:m(s,n)},i(Fe,{field:t,value:a,multiple:false,dragging:this.dragging,onSet:si(a,true)},i(".flex.items-center.pa1",{class:k(s,this.dragging(),Ce(t,a()))},this.innerComponent(e))))}innerComponent({field:{disabled:e,config:a,readonly:n},value:s}){const l=t.head(s());if(l){if(l.dataUrl){return i(".relative.w-100.dt.tc",i("img.img.contain.max-h-img",{title:l.name,src:_(l.path,l.dataUrl)}),!(n||e)&&i(".absolute.top-0.right-0.pa1.pointer.dim",{title:`Remove ${l.name}`,onclick:Be(s,l.guid)},i("i.pa1",{class:C("cancelIcn",a)})))}else{return[i(Re,l),i("span.ma1.flex-auto",{title:l.name},l.name),!(n||e)&&i("i.pa1.pointer.dim",{title:`Remove ${l.name}`,class:C("cancelIcn",a),onclick:Be(s,l.guid),onkeydown:K,tabindex:0})]}}else{return[P(C("uploadIcn",a),"pa1"),i("span.ma1",C("addFileTxt",a))]}}}class ri{constructor(){this.dragging=a(false)}view({attrs:{field:e,value:t,displayType:a,showDisplay:n=true}}){const{disabled:s,uiClass:l={},config:r,readonly:o}=e;return i("div",{class:m(l,s)},[i(Fe,{field:e,value:t,dragging:this.dragging,onSet:si(t,false)},i(".flex.items-center.pa1.dt",{class:k(l,this.dragging(),Ce(e,t()))},[P(C("uploadIcn",r),"pa1"),i("span.ma1.flex-auto",C("addFileTxt",r))])),n?i(_e,{displayType:a,value:t,readonlyOrDisabled:s||o,config:r}):null])}}class oi extends Fe{constructor(){super(...arguments);this.showLabel=false}}class ci{constructor(){this.dragging=a(false)}view({attrs:{field:e,value:t}}){const{id:a,required:n,uiClass:s={},config:l,label:r={text:"Add File",icon:C("uploadIcn",l)}}=e;return[U(a,s,r,n),i("div",{class:`${k(s,this.dragging(),Ce(e,t()))} ${h()} ${o.button}`},i(oi,{field:e,multiple:false,dragging:this.dragging,onSet:qe(t,true),value:t},i(".flex.items-center",typeof r==="string"?W({text:r,icon:C("uploadIcn",l)}):W(r))))]}}class ui extends jt{constructor(){super(...arguments);this.pageStride=ui.PAGE_STRIDE;this.page=0}static single(e){const t=new ui((()=>e().then((e=>{t.updateDataStore(e);t.applySort();i.redraw()}))));return t}static paging(e){const t=jt.BLOCK_SIZE*4;const a=new ui((n=>e(n,t+1).then((e=>{if(e.length>t){a.updateDataStore(e.slice(0,t),true)}else{a.updateDataStore(e)}i.redraw()}))));return a}set blockStride(e){this.pageStride=e;this.updatePage(0)}updatePage(e){this.page=jt.clampRange(0,e,this.lastPage);this.startBlock=this.page*this.pageStride;this.endBlock=this.startBlock+this.pageStride;this.ensureBlockStore();i.redraw()}get currentPage(){return this.page+1}get lastPage(){return Math.ceil(this.availableBlocks/this.pageStride)}get canPageForward(){return!this.loading&&this.currentPage<this.lastPage}get canPageBackward(){return!this.loading&&this.page>0}get rowsPerPage(){return this.pageStride*jt.BLOCK_SIZE}setPage(e){this.updatePage(e-1)}pageRelative(e){this.updatePage(this.page+e)}render(e){return this.blockStore.slice(this.startBlock,this.endBlock).map(((t,i)=>e({items:t,idx:i,visible:true})))}debug(){return Object.assign(Object.assign({},super.debug()),{blockStride:this.pageStride,page:this.page})}updateBlockRange(){if(this.startBlock===-1){this.updatePage(0)}if(this.endBlock>=this.blockStore.length){this.ensureBlockStore()}}}ui.PAGE_STRIDE=4;e.Badge=ue;e.BaseInput=it;e.BaseText=ve;e.Button=de;e.ButtonLink=he;e.CardDateInput=Ct;e.CheckList=Kt;e.CheckListGroup=Yt;e.Checkbox=Oe;e.CheckboxInput=Nt;e.Currency=ce;e.CurrencyInput=at;e.DateInput=Dt;e.DateText=ye;e.DisplayTypeComponent=_e;e.FileButtonSelect=ci;e.FileList=Ne;e.FileMulti=Ee;e.FileSelect=Gt;e.ImageList=Ue;e.ImageMulti=Jt;e.ImagePreview=We;e.ImageSelect=Qt;e.Label=Ye;e.Link=Ie;e.List=zt;e.ListController=jt;e.MultiOmniFileInput=ri;e.NavButton=pe;e.NavLink=fe;e.OmniFileInput=li;e.PageController=ui;e.PasswordInput=Mt;e.PasswordStrength=Ke;e.PercentageInput=ut;e.RadioInput=Wt;e.SelectInput=Ht;e.SelectText=Ae;e.SignBuilder=ni;e.TextareaInput=At;e.TimeInput=Et;e.Toggle=Le;e.ToggleInput=Ut;e.Tooltip=ge;e.Trusted=be;e.createStamp=oe;e.currencyStrToNumber=rt;e.dataURItoBlob=G;e.dataUrlToFile=J;e.fileConstructor=Z;e.fileNameExtSplit=Y;e.formatCurrency=lt;e.getOrientation=ee;e.guid=q;e.iconMap=we;e.joinClasses=p;e.linkAttrs=xe;e.linkIcon=ke;e.numberToCurrencyStr=ot;e.numberToCurrencyTuple=ct;e.pxRatio=B;e.readArrayBuffer=te;e.readOrientation=ie;e.registerFunction=$;e.resizeImage=se;e.scaleDataUrl=le;e.scaleRect=ne;e.textToImage=re;e.theme=o;e.updateButtonContext=d;e.updateClasses=c;e.updateConfig=L}));
