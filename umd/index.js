/* @preserve built on: 2022-02-15T09:27:01.037Z */
(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?t(exports,require("lodash"),require("mithril"),require("mithril/stream"),require("luxon"),require("signature_pad")):typeof define==="function"&&define.amd?define(["exports","lodash","mithril","mithril/stream","luxon","signature_pad"],t):(e=typeof globalThis!=="undefined"?globalThis:e||self,t(e.uiWidgets={},e._,e.m,e.m.stream,e.luxon,e.SignaturePad))})(this,(function(e,t,a,n,l,i){"use strict";function s(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}var r=s(t);var u=s(a);var d=s(n);var c=s(i);const o={layoutType:"default",imageMaxSize:1280,imageDispHeight:"16rem",thumbDispHeight:"6rem",addFileTxt:"Upload...",addFilesTxt:"Add file(s)...",remFileTtl:"Remove",openFileTxt:"Open file",showPassTxt:"Show Password",requiredLblPost:"",signOpts:[{label:"",value:"draw"},{label:"",value:"type"},{label:"",value:"stamp"}],signMaxSize:640,signHeightPct:25,signFont:"sans-serif",signDrawTxt:"Draw",signTypeTxt:"Type",signStampTxt:"Accept",stampTxt:"Accept",stampBtnClass:"",stampBtnContext:"default",stampSetTxt:"Accepted",applyTtl:"Apply",resetTtl:"Reset",cancelTtl:"Cancel",drawIcn:"fas fa-signature",typeIcn:"fas fa-keyboard",stampIcn:"fas fa-check",applyIcn:"fas fa-check",resetIcn:"fas fa-eraser",cancelIcn:"fas fa-times",checkIcn:"far fa-check-square",uncheckIcn:"far fa-square",toggleOnIcn:"fas fa-toggle-on",toggleOffIcn:"fas fa-toggle-off",showPassIcn:"fas fa-eye",hidePassIcn:"fas fa-eye-slash",uploadIcn:"fas fa-file-upload",downloadIcn:"fas fa-file-download",deleteIcn:"fas fa-trash-alt",cameraIcn:"fas fa-camera",imageIcn:"fas fa-image",emailIcn:"fas fa-envelope",telIcn:"fas fa-phone",linkIcn:"fas fa-link",wordDocIcn:"fas fa-file-word",videoFileIcn:"fas fa-file-video",pdfFileIcn:"fas fa-file-pdf",musicFileIcn:"fas fa-file-audio",excelFileIcn:"fas fa-file-excel",fileIcn:"fas fa-file",codeFileIcn:"fas fa-file-code",currencyFormat:"default",toggleFormat:"default"};const f=o;function p(e){r["default"].assign(o,e)}function h(e,t){return t&&e in t?t[e]:f[e]}const m={wrapper:"",label:"silver",inputWrapper:"ba br2 b--silver pa2 ma0 dark-gray",input:"dark-gray fw2",button:"pa2 bn br2",navButton:"dark-gray",textarea:"dark-gray fw2",radio:"dark-gray pa2 br2",radioChecked:"bg-light-blue",radioUnchecked:"o-60",fileInputWrapper:"ba bw1 br3 b--black-30 b--dashed dark-gray",fileHover:"blue b--blue",displayLabel:"silver",displayValue:"dark-gray",requiredLabel:"",disabledWrapper:"o-40",invalidInputWrapper:"ba b--red",altLabel:"alt-label",floatLabelPlaceholder:""};const g=m;function b(e){r["default"].assign(m,e)}const v={default:"bg-light-blue dark-gray"};function y(e){r["default"].assign(v,e)}function x(e="default"){if(e&&e in v){return v[e]}else{return""}}function w({wrapper:e="",merge:t=true},a){return`${e} ${t?g.wrapper:""} ${a?g.disabledWrapper:""}`}function I({label:e="",merge:t=true},a){return`${e} ${t?g.label:""} ${a?g.requiredLabel:""}`}function k(e,t,a){return`${I(e,a)} ${t?"f-07em cursor-default":`${g.floatLabelPlaceholder} cursor-text`}`}function $({inputWrapper:e="",merge:t=true},a){return`${e} ${t?g.inputWrapper:""} ${a?g.invalidInputWrapper:""}`}function T({input:e="",merge:t=true}){return`${e} ${t?g.input:""}`}function S(e,t,a){return`${T(e)} ${F(t,a)}`}function C({input:e="",merge:t=true}){return`${e} ${t?g.textarea:""}`}function q({input:e="",merge:t=true},a,n,l){return`${e} ${t?g.radio:""} ${a?g.radioChecked:g.radioUnchecked} ${F(n,l)}`}function P(e){return`${e?g.fileHover:""}`}function D({inputWrapper:e="",merge:t=true},a,n){return`${e} ${t?g.fileInputWrapper:""} ${n?g.invalidInputWrapper:""} ${P(a)}`}function F(e,t){return e||t?"":"pointer"}function L(e){return(e+256).toString(16).substr(1)}function U(){const e=new Uint8Array(16);const t=window.crypto;t.getRandomValues(e);return[L(e[0]),L(e[1]),L(e[2]),L(e[3]),"-",L(e[4]),L(e[5]),"-",L(e[6]),L(e[7]),"-",L(e[8]),L(e[9]),"-",L(e[10]),L(e[11]),L(e[12]),L(e[13]),L(e[14]),L(e[15])].join("")}function A(){return Math.max(window.devicePixelRatio,1)}function O(e,t){if(typeof e==="string"){return t?`${e}${f.requiredLblPost}`:e}else{return t?`${e.text}${f.requiredLblPost}`:e.text}}function M(e){return u["default"]("div",{class:g.altLabel},e.alt?e.alt:"")}function B(e,t){return t?t:e}function E(e,t,a,n){return[e.icon?u["default"]("i.fa-fw",{class:`${e?"mr2":""} ${e.icon}`}):null,u["default"](t,a,[O(e,n)," ",M(e)]),e.rightIcon?u["default"]("i.fa-fw",{class:`${e?"ml2":""} ${e.rightIcon}`}):null,e.href?u["default"]("a.link.dim.pointer.ws-normal",{onclick:e.onclick},u["default"]("i.mr2",{class:f.linkIcn}),e.href):null]}function H(e){if(e){if(typeof e==="string"){return u["default"]("span.mr2.truncate",{title:e,class:g.displayLabel},e)}else{return E(e,"span.mr2.truncate",{title:e.text,class:g.displayLabel})}}return null}function R(e,t,a,n){if(a){if(typeof a==="string"){return u["default"]("label.mb1.db",{title:a,for:e,class:I(t,n)},O(a,n))}else{return E(a,"label.mb1.db",{title:a.text,for:e,class:I(t,n)},n)}}return null}function W(e){return[e.icon?u["default"]("i.fa-fw",{class:`${e?"mr2":""} ${e.icon}`}):null,e.text,e.rightIcon?u["default"]("i.fa-fw",{class:`${e?"ml2":""} ${e.rightIcon}`}):null]}function N(e){return function({target:{value:t}}){e(t)}}function z(e){return function({target:{checked:t}}){e(t)}}function j(e,t){if(e()!==t){e(t)}}function V({target:e}){e.select()}function _({key:e}){if(e==="Enter"&&document.activeElement){document.activeElement.click()}}function Y(e){const t=e.lastIndexOf(".");if(t===-1){return[e,""]}else{return[e.substr(0,t),e.substr(t)]}}function K(e){const t=e.split(",");const a=t[0].indexOf("base64")>=0?atob(t[1]):unescape(t[1]);const n=t[0].split(":")[1].split(";")[0];const l=a.length;const i=new Uint8Array(l);for(let e=0;e<l;e++){i[e]=a.charCodeAt(e)}return new Blob([i],{type:n})}function X(e,t){const a=(new Date).valueOf();const n=e;n.name=t;n.lastModified=a;return e}function Z(e,t,a){const n=X(K(e),t);return{guid:U(),name:n.name,path:"not_set",file:n,dataUrl:e,metadata:a}}function G(e){const[,t]=Y(e.name);switch(t.toLowerCase()){case".doc":case".docx":case".dot":case".wbk":case".docm":case".dotx":case".dotm":case".docb":case".txt":return f.wordDocIcn;case".webm":case".mkv":case".flv":case".vob":case".ogv":case".drc":case".gifv":case".mng":case".avi":case".mts":case".m2ts":case".mov":case".qt":case".wmv":case".yuv":case".rm":case".rmvb":case".viv":case".asf":case".amv":case".mp4":case".m4p":case".m4v":case".mpg":case".mp2":case".mpeg":case".mpe":case".mpv":case".m2v":case".svi":case".3gp":case".mxf":case".roq":case".nsv":case".f4v":case".f4p":case".f4a":case".f4b":return f.videoFileIcn;case".pdf":return f.pdfFileIcn;case".pcm":case".wav":case".aiff":case".mp3":case".aac":case".ogg":case".wma":case".flac":case".alac":return f.musicFileIcn;case".xls":case".xlt":case".xlm":case".xlsx":case".xlsm":case".xltx":case".xltm":case".xlsb":case".xla":case".xlam":case".xll":case".xlw":return f.excelFileIcn;case".html":case".js":case".css":case".scss":case".java":return f.codeFileIcn;case".jpg":case".jpeg":case".png":case".tiff":case".gif":case".svg":case".webp":return f.imageIcn;default:return f.fileIcn}}function J(e){return e&&e.includes("image")}function Q(e){const t=Math.min(e.byteLength,64*1024);const a=new DataView(e,0,t);if(a.getUint16(0,false)!==65496){return-2}const n=a.byteLength;let l=2;while(l<n){const e=a.getUint16(l,false);l+=2;if(e===65505){l+=2;if(a.getUint32(l,false)!==1165519206){return-1}l+=6;const e=a.getUint16(l,false)===18761;l+=a.getUint32(l+4,e);const t=a.getUint16(l,e);l+=2;for(let n=0;n<t;n++){if(a.getUint16(l+n*12,e)===274){return a.getUint16(l+n*12+8,e)}}}else if((e&65280)!==65280){break}else{l+=a.getUint16(l,false)}}return-1}function ee(e){return new Promise(t=>{const a=new FileReader;a.onload=()=>{t(a.result)};a.readAsArrayBuffer(e)})}function te(e){return ee(e).then(Q)}function ae(e,t,a,n){if(!n||n>8){return}switch(n){case 2:e.translate(t,0);e.scale(-1,1);return;case 3:e.translate(t,a);e.rotate(Math.PI);return;case 4:e.translate(0,a);e.scale(1,-1);return;case 5:e.rotate(.5*Math.PI);e.scale(1,-1);return;case 6:e.rotate(.5*Math.PI);e.translate(0,-a);return;case 7:e.rotate(.5*Math.PI);e.translate(t,-a);e.scale(-1,1);return;case 8:e.rotate(-.5*Math.PI);e.translate(-t,0);return}}function ne(e,t,a){if(e>t){if(e>a){return[a,Math.round(t*a/e)]}}else if(t>a){return[Math.round(e*a/t),a]}return[e,t]}function le(e,t,a){if(!e.type.match(/image.*/)){return Promise.reject(new Error("File must be an image"))}return te(e).then(n=>new Promise(l=>{const i=new Image;i.onload=()=>{const e=document.createElement("canvas");const[s,r]=ne(i.width,i.height,t);if(n>4){e.width=r;e.height=s}else{e.width=s;e.height=r}const u=e.getContext("2d");ae(u,s,r,n);u.drawImage(i,0,0,s,r);l(e.toDataURL(a))};const s=new FileReader;s.onload=()=>i.src=s.result;s.readAsDataURL(e)}))}function ie(e,t){return new Promise(a=>{const n=new Image;n.onload=()=>{const e=document.createElement("canvas");const[l,i]=ne(n.width,n.height,t);e.width=l;e.height=i;const s=e.getContext("2d");s.drawImage(n,0,0,l,i);a(e.toDataURL())};n.src=e})}function se(e,t,a,n){const l=document.createElement("canvas");l.width=t;l.height=a;const i=.56*l.height;const s=l.getContext("2d");s.textBaseline="middle";s.font=`${i}px ${n}`;s.fillText(e,l.height*.05,i);return l.toDataURL()}function re(e,t){const a=f.signMaxSize;const n=.01*t*a;return se(e,a,n,f.signFont)}class ue{view({attrs:{label:e,classes:t="bg-red"},children:a}){return u["default"](".relative.dib",[a,e?u["default"]("span.absolute.minw-65rem.ph1.nt1.nr1.top-0.right-0.br-pill.tc.f5.white.o-80",{class:t},e):null])}}class de{view({attrs:{label:e="",type:t="button",title:a=e,icon:n,rightIcon:l,context:i,classes:s="",style:r,disabled:d,onclick:c,tabindex:o}}){return u["default"]("button.button-reset",{type:t,title:a,disabled:d,class:`${s} ${d?g.disabledWrapper:"pointer"} ${x(i)} ${g.button}`,style:r,tabindex:o,onclick:c},W({text:e,icon:n,rightIcon:l}))}}class ce{view({attrs:{label:e="",title:t=e,icon:a,rightIcon:n,href:l,rel:i,target:s,download:r,context:d,classes:c="",style:o}}){return u["default"]("a.link.flex.items-center",{href:l,rel:i,target:s,download:r,title:t,class:`${c} ${x(d)} ${g.button}`,style:o},W({text:e,icon:a,rightIcon:n}))}}class oe{view({attrs:{label:e="",title:t=e,icon:a,rightIcon:n,classes:l="",style:i,disabled:s,onclick:r}}){return u["default"](".mh2.pa2.truncate",{title:t,disabled:s,class:`${l} ${s?g.disabledWrapper:"pointer"} ${g.navButton}`,style:i,onclick:r},W({text:e,icon:a,rightIcon:n}))}}class fe{view({attrs:{label:e="",title:t=e,icon:a,rightIcon:n,href:l,rel:i,target:s,download:r,classes:d="",style:c}}){return u["default"]("a.link.mh2.pa2.truncate",{href:l,rel:i,target:s,download:r,title:t,class:`${d} ${g.navButton}`,style:c},W({text:e,icon:a,rightIcon:n}))}}class pe{view({attrs:{value:e}}){return u["default"](".pa2",{},u["default"].trust(e()))}}class he{view({attrs:{field:e,value:t}}){const{label:a,uiClass:n={}}=e;return u["default"](".pa2.flex.flex-wrap",{class:w(n)},[H(a),u["default"]("span.ws-normal",{title:t(),class:g.displayValue},t())])}}class me{formatter(e){return e?new Date(String(e)).toLocaleDateString():e}oninit({attrs:{value:e}}){this.formatted=e.map(this.formatter)}onremove(){this.formatted.end(true)}view({attrs:{field:e}}){return u["default"](he,{field:e,value:this.formatted})}}function ge(e,t){if(e==="email"){return{href:`mailto:${t}`,class:g.displayValue}}else if(e==="tel"){return{href:`tel:${t}`,class:g.displayValue}}else{return{href:t,target:"_blank",class:g.displayValue}}}const be={email:f.emailIcn,tel:f.telIcn};function ve(e,t){if(e==="email"){return h("emailIcn",t)}else if(e==="tel"){return h("telIcn",t)}else{return h("linkIcn",t)}}class ye{view({attrs:{field:e,value:t}}){const{label:a,type:n="url",uiClass:l={},config:i}=e;return u["default"](".pa2.flex.flex-wrap",{class:w(l)},[H(a),u["default"]("a.link.dim.pointer.ws-normal",ge(n,t()),u["default"]("i.mr2",{class:ve(n,i)}),t())])}}class xe{view({attrs:{field:e,value:t,left:a=false}}){const{options:n=[],config:l}=e;const i=h("toggleFormat",l)==="double";const s=r["default"].find(n,r["default"].matches({value:(!i?t():!a)||false}));const d=Boolean(t())&&!a||!t()&&a||!i;return s&&s.label?u["default"](`span${a?".mr2":".ml2"}${d?"":".o-40"}`,s.label):null}}class we{constructor(){this.onIcon="checkIcn";this.offIcon="uncheckIcn"}view({attrs:{field:e,value:t}}){const{label:a,uiClass:n={},config:l}=e;return u["default"](".pa2.flex.items-center",{class:w(n)},[H(a),u["default"]("i",{class:`${g.displayValue} ${h(t()?this.onIcon:this.offIcon,l)}`}),u["default"](xe,{field:e,value:t})])}}class Ie extends we{constructor(){super(...arguments);this.onIcon="toggleOnIcn";this.offIcon="toggleOffIcn"}}function ke(e,t){if(!e.required&&!t||e.disabled){return false}if(e.required&&!t){return true}if(e.pattern!=null){if(Te(e.pattern,String(t)))return true}if($e(e,t))return true;return false}function $e(e,t){let a=false;let n=false;if(e.min!=null){n=Number.parseInt(String(t))<e.min}if(e.max!=null){a=Number.parseInt(String(t))>e.max}if(e.minlength!=null){n=String(t).length<e.minlength}if(e.maxlength!=null){a=String(t).length>e.maxlength}return n||a}function Te(e,t){return!new RegExp(e).test(t)}function Se(e,t){if(e.required){return t.length<1}return false}function Ce(e){return t=>{t.preventDefault();if(t.dataTransfer){t.dataTransfer.dropEffect="copy"}if(e()){t.redraw=false}e(true)}}function qe(e){return t=>{t.preventDefault();e(false)}}function Pe(e,t){return a=>{a.preventDefault();e(false);if(a.dataTransfer){t(a.dataTransfer.files)}}}function De(e){return({target:{files:t}})=>e(t)}class Fe{constructor(){this.showLabel=true}oncreate({dom:e,attrs:{value:t}}){t.map(t=>{if(t.length===0){e.firstChild.value=""}})}view({attrs:{field:e,defaultAccept:t="*",multiple:a=true,dragging:n,onSet:l},children:i}){const{label:s,id:d,name:c=d,title:o=s,required:f,readonly:p,disabled:h,autofocus:m,tabindex:g="0",accept:b=t,uiClass:v={}}=e;const y=this.showLabel&&s?R(d,v,s,f):null;return u["default"]("label.db",r["default"].extend({for:d,title:o,"aria-labelled-by":d,class:F(h,p),"data-input-id":d,tabindex:g,onkeydown:e=>{var t;if(e.key===" "){((t=document.activeElement)===null||t===void 0?void 0:t.firstElementChild).click()}}},h||p?{}:{ondragover:Ce(n),ondragleave:qe(n),ondrop:Pe(n,l)}),[u["default"]("input.clip[type=file].bg-transparent.bn.outline-0",{id:d,name:c,multiple:a,accept:b,required:f,autofocus:m,disabled:h||p,tabindex:-1,onchange:De(l)}),y,i])}}function Le(e,t=false){return a=>{const n=t?[]:e();r["default"].each(a,e=>{n.push({guid:U(),name:e.name,path:"not_set",file:e})});e(n)}}function Ue(e,t){return a=>{a.preventDefault();const n=e();r["default"].remove(n,{guid:t});e(n)}}class Ae{constructor(){this.dragging=d["default"](false)}view({attrs:{field:e,value:t}}){const{disabled:a,uiClass:n={},config:l}=e;return u["default"]("div",{class:w(n,a)},[u["default"](Fe,{field:e,dragging:this.dragging,onSet:Le(t),value:t},u["default"](".pa2",{class:D(n,this.dragging(),Se(e,t()))},[u["default"]("i.mr2",{class:h("uploadIcn",l)}),u["default"]("span",h("addFilesTxt",l))])),u["default"](".flex.flex-column.mt1.nb1",r["default"].map(t(),e=>u["default"]("span.pa2.mv1.ba.b--black-20.hide-child.dim.pointer",[u["default"]("i.mr2",{class:h("downloadIcn",l)}),e.name,u["default"]("i.child.fr",{title:`${h("remFileTtl",l)} ${e.name}`,class:h("deleteIcn",l),onclick:Ue(t,e.guid)})])))])}}class Oe{view({children:e,attrs:t}){return u["default"](".relative.w-third.w-25-m.w-20-l.pa1.tc.hide-child",{tabindex:0,onkeydown:({key:e})=>{var t;if(e==="Enter"&&document.activeElement){(t=document.activeElement.querySelector("button"))===null||t===void 0?void 0:t.click()}}},[t.src&&t.src!=="not_set"?u["default"]("img.contain",{src:t.src}):null,t.data&&t.data.file&&(t.src==="not_set"||!t.src)?u["default"]("div.contain.tc.br5.6rem",{class:`${G(t.data)} fa-2x`,tooltip:t.data.file.type}):null,e])}}class Me{view({attrs:e}){return u["default"]("i.pa1",{class:G(e),title:f.openFileTxt,onclick:e.path!=="not_set"?()=>window.open(e.path,"_blank"):undefined})}}class Be{view({attrs:{displayType:e="thumbnail",value:t}}){return e==="thumbnail"?u["default"](".flex.flex-row.flex-wrap.mt1.nr1.nb1.nl1.max-h-thumb",r["default"].map(t(),e=>u["default"](Oe,{src:B(e.path,e.dataUrl),data:e},u["default"](".absolute.top-0.right-0.child",u["default"](de,{title:`Remove ${e.name}`,icon:f.deleteIcn,onclick:Ue(t,e.guid),tabindex:-1}))))):u["default"](".pa2.flex.flex-column",r["default"].map(t(),e=>u["default"](".flex.items-center.pa1.ba.b--black-20",[u["default"]("i.pa1",{class:f.uploadIcn}),u["default"]("span.ma1.flex-auto",{title:e.name},e.name),u["default"](Me,e),u["default"]("i.pa1.pointer.dim",{title:`Remove ${e.name}`,class:f.cancelIcn,onclick:Ue(t,e.guid)})])))}}class Ee{view({attrs:{field:e,value:t}}){const{label:a,uiClass:n={}}=e;const l=r["default"].find(e.options,{value:t()});const i=l?l.label||l.value:t();return u["default"](".pa2.flex.flex-wrap",{class:w(n)},[H(a),u["default"]("span.ws-normal",{title:i,class:g.displayValue},i)])}}class He{view({attrs:{field:e,value:t}}){const{label:a,uiClass:n={},config:l}=e;return u["default"](".pa2.flex.flex-column",{class:w(n)},[H(a),u["default"](".flex.flex-column.mt1.nb1",r["default"].map(t(),({name:e,path:t})=>u["default"]("a.pa2.mv1.link.ba.b--black-20.dim.dib.pointer[target=_blank]",{class:g.displayValue,href:t},u["default"]("i.mr2",{class:h("downloadIcn",l)}),e)))])}}class Re{view({attrs:{field:e,value:t}}){const{label:a,uiClass:n={}}=e;return u["default"](".pa2.flex.flex-column",{class:w(n)},[H(a),u["default"](".flex.flex-row.flex-wrap.mt1.nr1.nb1.nl1.max-h-thumb",r["default"].map(t(),({name:e,path:t,dataUrl:a})=>u["default"](Oe,{title:e,src:B(t,a)})))])}}class We{view({attrs:{field:e,value:t}}){const{label:a,uiClass:n={},config:l}=e;const i=r["default"].head(t());return u["default"](".pa2.flex.flex-column",{class:w(n)},[H(a),i?u["default"]("img.img.h-100.max-h-img.mt2.contain.self-center",{title:i.name,src:B(i.path,i.dataUrl)}):u["default"]("i.mt2",{class:`${g.displayValue} ${h("imageIcn",l)}`})])}}function Ne(e,t){return(e.match(t)||[]).length}function ze(e){let t=0;if(e.length>=8){t=1;if(e.length>=24){t=t+1}if(Ne(e,/[A-Z]/g)>1&&Ne(e,/[a-z]/g)>2){t=t+1}if(Ne(e,/[\d]/g)>1){t=t+1}if(Ne(e,/[!"£%^@#$&*]/g)>0){t=t+1}}return t}function je(e){switch(e){case 0:{return"Invalid"}case 1:{return"Very Weak"}case 2:{return"Weak"}case 3:{return"Average"}case 4:{return"Strong"}case 5:{return"Very Strong"}}return""}const Ve=[{value:1,background:"bg-dark-red"},{value:2,background:"bg-orange"},{value:3,background:"bg-yellow"},{value:4,background:"bg-light-green"},{value:5,background:"bg-green"}];class _e{oninit({attrs:{value:e}}){this.passwordScore=e.map(e=>ze(String(e)))}onremove(){this.passwordScore.end()}view({attrs:{field:e}}){const{label:t}=e;return u["default"](".flex.flex-column",[H(t),u["default"](".flex.mt1",r["default"].map(Ve,e=>u["default"](".h1.w-20",{class:this.passwordScore()>=e.value?e.background:"bg-transparent"}))),u["default"]("span.f5.truncate",je(this.passwordScore()))])}}class Ye{view({attrs:{field:{label:e="",id:t,required:a,uiClass:n={}}}}){return u["default"]("div",{class:w(n)},R(t,n,e,a))}}class Ke{constructor(){this.invalid=false;this.selector="input"}onupdate({dom:e,attrs:{field:t,value:a}}){const n=e.querySelector(this.selector);const l=ke(t,a())||(n?!n.checkValidity():false);if(l!==this.invalid){this.invalid=l;u["default"].redraw()}}}class Xe{view({attrs:e,children:t}){const{field:a,invalid:n}=e;const{label:l,id:i,type:s="text",required:r,disabled:d,uiClass:c={}}=a;return u["default"]("div",{class:s==="hidden"?"clip":w(c,d)},[R(i,c,l,r),u["default"]("fieldset.bn",{class:$(c,n)},t)])}}class Ze{constructor(){this.focus=false;this.focusIn=()=>{this.focus=true};this.focusOut=()=>{this.focus=false};this.wrapperHeight=0}oncreate({dom:e}){this.inputWrapper=e.firstElementChild;this.calcHeight()}onupdate(){this.calcHeight()}calcHeight(){if(this.inputWrapper.clientHeight!==this.wrapperHeight){this.wrapperHeight=this.inputWrapper.clientHeight;u["default"].redraw()}}shouldFloat(e,t){return e==="floatAlways"||this.focus||Boolean(t)}labelTranslateY(){return`calc(${this.wrapperHeight*.5}px - 1.5ex)`}view({attrs:e,children:t}){const{field:a,invalid:n,value:l,xform:i=l}=e;const{label:s,id:r,type:d="text",placeholder:c,required:o,disabled:f,uiClass:p={},config:m,layout:g=h("layoutType",m)}=a;const b=this.shouldFloat(g,c||i());const v=typeof s==="string";return u["default"]("div",{class:`${d==="hidden"?"clip":w(p,f)} ${s?"pt2":""}`,onfocusin:this.focusIn,onfocusout:this.focusOut},u["default"]("fieldset.relative.pa0.ma0.flex.w-100",{class:$(p,n)},[s&&this.wrapperHeight?[u["default"]("legend.db.hidden.h-05ch.transition-mw",{class:`${I(p,o)} ${b?"mw-100":"mw-001px"}`},u["default"]("span.f-07em",v?O(s,o):[O(s,o)," ",M(s)])),u["default"](".absolute.top-0.transition-transform",{class:I(p,o),style:{transform:`translateY(${b?"-1ch":this.labelTranslateY()})`}},u["default"]("label.db.transition-f",{for:r,title:v?s:s.text,class:k(p,b,o)},v?O(s,o):[O(s,o)," ",M(s)]))]:null,t]))}}class Ge{constructor(){this.layout=Ze}view({attrs:e,children:t}){const{field:{config:a,layout:n=h("layoutType",a)}}=e;return u["default"](n==="default"?Xe:this.layout,e,t)}}class Je extends Ze{shouldFloat(){return true}}class Qe extends Ge{constructor(){super(...arguments);this.layout=Je}}const et=new Set(["date","datetime-local","color","range"]);class tt extends Ke{view({attrs:e}){const{field:t,value:a,xform:n=a}=e;const{label:l,id:i,type:s="text",name:r=i,title:d=l,placeholder:c,max:o,maxlength:f,min:p,minlength:h,step:m,required:g,readonly:b,disabled:v,autofocus:y,autocomplete:x,tabindex:w,pattern:I,inputmode:k,spellcheck:$,instant:S,uiClass:C={}}=t;const q=et.has(s)?Qe:Ge;return u["default"](q,{field:t,value:a,xform:n,invalid:this.invalid},u["default"]("input.w-100.bg-transparent.bn.outline-0",{id:i,type:s,name:r,title:d,placeholder:c,max:o,maxlength:f,min:p,minlength:h,step:m,required:g,readonly:b,disabled:v,autofocus:y,autocomplete:x,tabindex:w,pattern:I,inputmode:k,spellcheck:$,class:T(C),value:n(),[S?"oninput":"onchange"]:N(a)}))}}class at{view({attrs:e}){const{field:t,value:a,xform:n=a}=e;const{label:l,id:i,name:s=i,title:d=l,placeholder:c,max:o,maxlength:f,min:p,minlength:m,step:g,required:b,readonly:v,disabled:y,autofocus:x,autocomplete:w,tabindex:I,pattern:k,inputmode:$,spellcheck:S,instant:C,uiClass:q={},config:P,options:D}=t;const F=D&&D.length?D[0].value:"$";const L=h("currencyFormat",P);return u["default"](Qe,{field:t,value:a,invalid:ke(t,a())},u["default"](".flex.flex-row.w-100",u["default"]("span.mr1.self-center",{class:T(q)},F),u["default"]("input.w-100.bg-transparent.bn.outline-0",{id:i,type:"text",name:s,title:d,placeholder:c,max:o,maxlength:f,min:p,minlength:m,step:g,required:b,readonly:v,disabled:y,autofocus:x,autocomplete:w,tabindex:I,pattern:k,inputmode:$,spellcheck:S,class:T(q),onfocus:V,value:r["default"].isUndefined(n())?null:nt(lt(n()),L),[C?"oninput":"onchange"]:ut(a)})))}}function nt(e,t){const a=st(e);if(t==="accounting"&&e<0){return`(${a})`}else{return a}}function lt(e){return r["default"].isString(e)?r["default"].parseInt(e):Number(e)}function it(e){const t=e.replace(/[^\d.]/g,"");let a;let n=0;if(t.indexOf(".")>-1){const e=t.indexOf(".");const l=t.substring(0,e);a=r["default"].parseInt(r["default"].padStart(l,1,"0"));const i=t.substring(e+1,Math.min(e+3,t.length));n=r["default"].parseInt(r["default"].padEnd(i,2,"0"))}else{a=r["default"].parseInt(t)||0}return a*100+n}function st(e){const t=rt(e);if(t){return`${t[0]}.${t[1]}`}else{return t}}function rt(e){if(!r["default"].isFinite(e)){return undefined}const t=String(Math.abs(e));let a="0";let n="";if(t.length>2){const e=t.length-2;a=t.substring(0,e);n=t.substring(e)}else{n=r["default"].padStart(t,2,"0")}return[a,n]}function ut(e){return({target:{value:t}})=>e(it(t))}class dt{view({attrs:e}){const{field:t,value:a,xform:n=a}=e;const{label:l,id:i,name:s=i,title:r=l,placeholder:d,max:c,maxlength:o,min:f,minlength:p,step:h,required:m,readonly:g,disabled:b,autofocus:v,autocomplete:y,tabindex:x,pattern:w,inputmode:I,spellcheck:k,instant:$,uiClass:S={}}=t;return u["default"](Qe,{field:t,value:a,invalid:ke(t,a())},u["default"](".flex.flex-row.w-100",[u["default"]("input.w-100.bg-transparent.bn.outline-0",{id:i,type:"text",name:s,title:r,placeholder:d,max:c,maxlength:o,min:f,minlength:p,step:h,required:m,readonly:g,disabled:b,autofocus:v,autocomplete:y,tabindex:x,pattern:w,inputmode:I,spellcheck:k,class:T(S),onfocus:V,value:n(),[$?"oninput":"onchange"]:N(a)}),u["default"]("span.mr1.self-center",{class:T(S)},"%")]))}}function ct(e){switch(e){case"day":return"dd";case"month":return"mm";case"year":return"yyyy"}}function ot(e,t,a){const n=e.querySelector(`#${t}-${a}`);n.focus()}function ft(e){const t=e?e.toLocaleLowerCase():"";if(t.includes("month")){return"mm"}else if(t.includes("day")){return"dd"}else if(t.includes("year")){return"yy"}else{return null}}function pt(e,t,a){const n=e.querySelector(`#${t}-${a}`);n.focus();n.select()}function ht(e){return parseInt(e.getAttribute("maxlength"))}function mt(e,t,a,n,l,i,{next:s,prev:r}){const u=n.querySelector(`#${e}-${t}`);const d=ht(u);if((l.key==="Backspace"||l.key==="Delete")&&a.length===0&&r){pt(n,e,r);l.preventDefault()}else if(i.charCodeAt(0)===l.key.charCodeAt(0)&&s&&a.length!==0&&a.length<d){pt(n,e,s);l.preventDefault()}}function gt(e,t,a,n,l,i){if(vt(a,n,l)&&e){i(t)}else{i("")}}function bt(e){const t=String(e());if(t.length===1&&t!=="0"){e(`0${t}`)}}function vt(e,t,a){const n=!a?2:4;return e.length===n&&t.length===2&&(!a||a.length===2)}function yt(e){if(e.includes("month")){return"month"}else if(e.includes("day")){return"day"}return"date"}function xt(e,t,a){if(e.invalidExplanation){if(a){return""}else{return`Please check the ${yt(e.invalidExplanation)}.`}}else if(!e.year||Number(t)<1900){return"Year must be greater than 1900."}return""}function wt(e,t,a){if(!a){if(!t&&!e){return""}else if(t.length!==2||Number(t)>12){return`Please check the month.`}else if(e.length!==2){return`Please check the year.`}}return""}function It(e,t){if(t){const a=ft(e);t.querySelectorAll("input").forEach(t=>{if(a&&t.id.substr(-2)===a&&e){t.setCustomValidity(e)}else{t.setCustomValidity("")}})}}function kt(e,t,a,n){const l=t.length===2&&e.length===2&&Number(t)<=12&&Number(t)>0||!e&&!t&&!a;It(wt(e,t,l),n);return l}function $t(e,t,a,n,i){const s=l.DateTime.fromObject({year:Number(e),month:Number(t),day:Number(a)});const r=!e&&!t&&!a;It(xt(s,e,r),i);return s.isValid&&Number(e)>=1900||r&&!n}function Tt(e,t,a,n,l){const i=n.querySelector(`#${t}-${a}`);const s=e()||"";const r=i.value;const u=/^\d*$/.test(r);if((u||r==="")&&r.length<=4){e(r)}else{e(s)}if(String(e()).length===ht(i)&&l){pt(n,t,l)}}class St{view({attrs:e}){const{id:t}=e.field;return u["default"]("input.dn",{id:t})}}class Ct{constructor(){this.dom=d["default"]();this.valid=d["default"]();this.focusedInput=d["default"]("mm");this.month=d["default"]("");this.year=d["default"]("");this.date=d["default"]("")}buildDate(e,t){this.date(`${this.month()}/${this.year()}`);const a=kt(this.year(),this.month(),e,this.dom());gt(a,this.date(),this.year(),this.month(),"",t)}oninit({attrs:{value:e,field:t}}){this.valid(!t.required);e.map(e=>{if(e){this.date("");const[t,a]=String(e).split("/");this.month(t);this.year(a)}else if(!this.date()){this.month("");this.year("")}this.valid(kt(this.year(),this.month(),Boolean(t.required),this.dom()))})}oncreate({dom:e}){j(this.dom,e)}onupdate({dom:e}){j(this.dom,e)}onremove(){this.date.end(true);this.year.end(true);this.month.end(true)}view({attrs:e}){const{field:t,value:a}=e;const{id:n,name:l=n,required:i,readonly:s,disabled:d,tabindex:c,uiClass:o={}}=t;const f=T(o);return u["default"](Qe,{value:a,field:t,invalid:!this.valid()},u["default"](".flex.ph-2px.pv-1px",{onclick:()=>ot(this.dom(),n,this.focusedInput())},u["default"]("span",[u["default"]("input.w-100.mw-mm.pa0.bg-transparent.bn.outline-0.tc",{id:`${n}-mm`,name:`${l}-mm`,type:"text",placeholder:"MM",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:i,readonly:s,disabled:d,tabindex:c,"aria-label":`${l}: Month`,value:this.month(),class:f,onfocus:r["default"].partial(this.focusedInput,"mm"),oninput:()=>{Tt(this.month,n,"mm",this.dom(),"yy");this.buildDate(Boolean(t.required),e.value)},onkeydown:e=>{mt(n,"mm",this.month(),this.dom(),e,"/",{next:"yy"})},onblur:()=>{bt(this.month);this.buildDate(Boolean(t.required),e.value)}})]),u["default"]("span.pa0.mr-2px","/"),u["default"]("span",[u["default"]("input.w-100.mw-yy.pa0.bg-transparent.bn.outline-0.tc",{id:`${n}-yy`,name:`${l}-yy`,type:"text",placeholder:"YY",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:i,readonly:s,disabled:d,tabindex:c,"aria-label":`${l}: Year`,value:this.year(),class:f,onfocus:r["default"].partial(this.focusedInput,"yy"),onkeydown:e=>{mt(n,"yy",this.year(),this.dom(),e,"/",{prev:"mm"})},oninput:()=>{Tt(this.year,n,"yy",this.dom());this.buildDate(Boolean(t.required),e.value)}}),u["default"](St,e)])))}}class qt{constructor(){this.dom=d["default"]();this.valid=d["default"]();this.focusedInput=d["default"](undefined);this.locale=d["default"](undefined);this.literalKey=d["default"]("/");this.day=d["default"]("");this.month=d["default"]("");this.year=d["default"]("");this.date=d["default"]()}buildDate(e,t=false){this.date(`${this.year()}-${this.month()}-${this.day()}`);const a=$t(this.year(),this.month(),this.day(),t,this.dom());gt(a,this.date(),this.year(),this.month(),this.day(),e)}findNextInput(e){const t=this.dateInputAdvanceOrder.indexOf(e);return t!==this.dateInputAdvanceOrder.length&&ct(this.dateInputAdvanceOrder[this.dateInputAdvanceOrder.indexOf(e)+1])}findPrevInput(e){const t=this.dateInputAdvanceOrder.indexOf(e);return t!==0&&ct(this.dateInputAdvanceOrder[this.dateInputAdvanceOrder.indexOf(e)-1])}setDateInputs(e){const t=new Intl.DateTimeFormat(e).formatToParts();this.dateParts=t;const a=t[0].type;this.literalKey(t[1].value);const n=ct(a);this.focusedInput(n);this.dateInputAdvanceOrder=r["default"](this.dateParts).map(({type:e})=>e).filter(e=>e!=="literal").value()}setLocale(e){const{options:t}=e;const a=t&&t.length?t[0].value:undefined;if(a!==this.locale()){this.locale(a)}}createDateInputs({type:e,value:t},{attrs:{field:{id:a,name:n=a,required:l,readonly:i,disabled:s,tabindex:d,uiClass:c={}},value:o}}){const f=T(c);switch(e){case"literal":return u["default"]("span.pa0.mr-2px",t);case"day":return u["default"]("span",u["default"]("input.w-100.mw-dd.pa0.bg-transparent.bn.outline-0.tc",{id:`${a}-dd`,name:`${n}-dd`,type:"text",placeholder:"DD",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:l,readonly:i,disabled:s,tabindex:d,value:this.day(),"aria-label":`${n}: Day`,class:`${f} maxw-dd p-0px`,onfocus:r["default"].partial(this.focusedInput,"dd"),onkeydown:e=>{mt(a,"dd",this.day(),this.dom(),e,this.literalKey(),{next:this.findNextInput("day"),prev:this.findPrevInput("day")})},oninput:()=>{Tt(this.day,a,"dd",this.dom(),this.findNextInput("day"));this.buildDate(o,l)},onblur:()=>{bt(this.day);this.buildDate(o,l)}}));case"month":return u["default"]("span",u["default"]("input.w-100.mw-mm.pa0.bg-transparent.bn.outline-0.tc",{id:`${a}-mm`,name:`${n}-mm`,type:"text",placeholder:"MM",minlength:"2",maxlength:"2",pattern:"[0-9]*",inputmode:"numeric",required:l,readonly:i,disabled:s,tabindex:d,value:this.month(),"aria-label":`${n}: Month`,class:`${f} maxw-mm p-0px`,onkeydown:e=>{mt(a,"mm",this.month(),this.dom(),e,this.literalKey(),{next:this.findNextInput("month"),prev:this.findPrevInput("month")})},oninput:()=>{Tt(this.month,a,"mm",this.dom(),this.findNextInput("month"));this.buildDate(o,l)},onfocus:r["default"].partial(this.focusedInput,"mm"),onblur:()=>{bt(this.month);this.buildDate(o,l)}}));case"year":return u["default"]("span",u["default"]("input.w-100.mw-yyyy.pa0.bg-transparent.bn.outline-0.tc",{id:`${a}-yyyy`,name:`${n}-yyyy`,type:"text",placeholder:"YYYY",minlength:"4",maxlength:"4",pattern:"[0-9]*",inputmode:"numeric",required:l,readonly:i,disabled:s,tabindex:d,value:this.year(),"aria-label":`${n}: Year`,class:`${f} maxw-yyyy p-0px`,onfocus:r["default"].partial(this.focusedInput,"yyyy"),onkeydown:e=>{mt(a,"yyyy",this.year(),this.dom(),e,this.literalKey(),{next:this.findNextInput("year"),prev:this.findPrevInput("year")})},oninput:()=>{Tt(this.year,a,"yyyy",this.dom(),this.findNextInput("year"));this.buildDate(o,l)}}))}}oninit({attrs:{value:e,field:t}}){this.valid(!t.required);e.map(e=>{if(e){const t=new Date(String(e));this.date("");const a=r["default"].padStart(String(t.getDate()),2,"0");const n=r["default"].padStart(String(1+t.getMonth()),2,"0");const l=String(t.getFullYear());this.day(a);this.month(n);this.year(l)}else if(!this.date()){this.day("");this.month("");this.year("")}this.valid($t(this.year(),this.month(),this.day(),Boolean(t.required),this.dom()))});this.locale.map(e=>{this.setDateInputs(e)});this.setLocale(t)}oncreate({dom:e}){j(this.dom,e)}onbeforeupdate({attrs:{field:e}}){this.setLocale(e)}onupdate({dom:e}){j(this.dom,e)}onremove(){this.date.end(true);this.year.end(true);this.month.end(true);this.day.end(true)}view(e){const{attrs:{field:t,value:a}}=e;const{id:n}=t;return u["default"](Qe,{value:a,field:t,invalid:!this.valid()},u["default"](".flex.ph-2px.pv-1px",{onclick:()=>ot(this.dom(),n,this.focusedInput())},this.dateParts.map(t=>this.createDateInputs(t,e)),u["default"](St,e.attrs)))}}class Pt{constructor(){this.showPassword=d["default"](false)}view({attrs:e}){const{field:t,value:a}=e;const{label:n,id:l,name:i=l,title:s=n,placeholder:r,maxlength:d,minlength:c,required:o,readonly:f,disabled:p,autofocus:m,autocomplete:g,tabindex:b,pattern:v,inputmode:y,instant:x,uiClass:w={},config:I}=t;return u["default"](Ge,{field:t,value:a,invalid:ke(t,a())},u["default"](".flex.flex-row.w-100",[u["default"]("input.w-100.bg-transparent.bn.outline-0",{id:l,name:i,title:s,placeholder:r,type:this.showPassword()?"text":"password",maxlength:d,minlength:c,required:o,readonly:f,disabled:p,autofocus:m,autocomplete:g,tabindex:b,pattern:v,inputmode:y,class:T(w),value:a(),autocorrect:"off",[x?"oninput":"onchange"]:N(a)}),u["default"]("i.ml1.pa1.fa-fw.pointer.dim",{title:h("showPassTxt",I),class:h(this.showPassword()?"hidePassIcn":"showPassIcn",I),onclick:()=>this.showPassword(!this.showPassword()),tabindex:0,onkeydown:_})]))}}class Dt extends Ze{labelTranslateY(){return"0.5ex"}}class Ft extends Ge{constructor(){super(...arguments);this.layout=Dt}}class Lt extends Ke{constructor(){super(...arguments);this.selector="textarea"}view({attrs:e}){const{field:t,value:a,xform:n=a}=e;const{label:l,id:i,name:s=i,title:r=l,placeholder:d,required:c,readonly:o,disabled:f,autofocus:p,autocomplete:h,tabindex:m,spellcheck:g,instant:b,uiClass:v={}}=e.field;return u["default"](Ft,{field:t,value:a,xform:n,invalid:this.invalid},u["default"]("textarea.w-100.bg-transparent.bn.outline-0.h-100.resize-none",{id:i,name:s,title:r,placeholder:d,required:c,readonly:o,disabled:f,autofocus:p,autocomplete:h,tabindex:m,spellcheck:g,class:C(v),value:a(),[b?"oninput":"onchange"]:N(a)}))}}class Ut{constructor(){this.onIcon="checkIcn";this.offIcon="uncheckIcn"}view({attrs:{field:e,value:t}}){const{label:a="",id:n,name:l=n,title:i=a,required:s,readonly:r,disabled:d,autocomplete:c,tabindex:o="0",uiClass:p={},config:m}=e;const g=h("toggleFormat",m)==="double";return u["default"]("div",{class:w(p,d)},u["default"]("fieldset.w-100.bn",{class:$(p)},[u["default"](".flex",u["default"]("input.clip[type=checkbox]",{id:n,name:l,checked:t(),required:s,autocomplete:c,disabled:d||r,tabindex:-1,"aria-hidden":"true",onchange:z(t)}),u["default"]("label.flex.flex-start.items-center",{tabindex:o,class:S(p,d,r),for:n,title:i,"data-input-id":n,"aria-label":a,onkeydown:e=>{if(e.key===" "){t(!t())}}},[g&&u["default"](xe,{field:e,value:t,left:true}),u["default"]("i",{class:f[t()?this.onIcon:g?this.onIcon:this.offIcon],style:{transform:!t()&&g?"scaleX(-1)":""}}),a&&!g&&u["default"]("span.ml2",O(a,s)),u["default"](xe,{field:e,value:t,left:false})]))]))}}class At extends Ut{constructor(){super(...arguments);this.onIcon="toggleOnIcn";this.offIcon="toggleOffIcn"}}class Ot{view({attrs:e}){const{field:t,value:a}=e;const{id:n,name:l=n,required:i,readonly:s,disabled:d,autocomplete:c,tabindex:o="0",uiClass:f={},options:p}=t;return u["default"](Qe,{field:t,value:a,invalid:ke(t,a())},u["default"](".flex.justify-center.w-100.ph-2px.pv-1px",{onchange:N(a)},r["default"].map(p,({value:e,label:t=e,icon:r})=>{const p=a()===e;return u["default"]("label.dib",{title:t,class:q(f,p,d,s),"data-input-id":n,tabindex:o,onkeydown:e=>{var t;if(e.key===" "){((t=document.activeElement)===null||t===void 0?void 0:t.firstElementChild).click()}}},u["default"]("input.clip[type=radio]",{name:l,value:e,checked:p,required:i,autocomplete:c,tabindex:-1,disabled:d||s}),r?u["default"]("i.fa-fw",{class:r}):t)})))}}class Mt{view({attrs:e}){const{field:t,value:a}=e;const{label:n,id:l,name:i=l,title:s=n,required:d,readonly:c,disabled:o,autofocus:f,autocomplete:p,tabindex:h,uiClass:m={},placeholder:g="--- Select one ---",options:b}=t;return u["default"](Qe,{field:t,value:a,invalid:ke(t,a())},[n?null:u["default"]("legend.screenreader",{id:`${l}-legend`},"Select one"),u["default"]("select.w-100.bg-transparent.bn.outline-0",{id:l,name:i,title:s,required:d,readonly:c,disabled:o,autofocus:f,autocomplete:p,tabindex:h,class:T(m),value:a()?a():"",onchange:N(a),"aria-labelledby":`${l}-legend`},u["default"]("option",{disabled:true,value:""},g),r["default"].map(b,({value:e,label:t=e})=>u["default"]("option",{value:e,disabled:o||c},t)))])}}class Bt{constructor(){this.dragging=d["default"](false)}view({attrs:{field:e,value:t,displayType:a}}){const n=r["default"].head(t());const{disabled:l,uiClass:i={},config:s}=e;const d=a==="none"||!n?h("addFileTxt",s):n.name;return u["default"]("div",{class:w(i,l)},u["default"](Fe,{field:e,multiple:false,dragging:this.dragging,onSet:Le(t,true),value:t},u["default"](".flex.items-center.pa1",{class:D(i,this.dragging(),Se(e,t()))},[u["default"]("i.pa1",{class:h("uploadIcn",s)}),u["default"]("span.ma1.flex-auto",d),n&&a!=="none"?[u["default"](Me,n),u["default"]("i.pa1.pointer.dim",{title:`Remove ${n.name}`,class:h("cancelIcn",s),onclick:Ue(t,n.guid)})]:null])))}}function Et(e,t,a=false){return n=>{const l=a?[]:e();return Promise.all(r["default"].map(n,e=>le(e,t,e.type).then(t=>{const a=X(K(t),e.name);l.push({guid:U(),name:a.name,path:"not_set",file:a,dataUrl:t})}))).then(()=>{e(l);u["default"].redraw()})}}class Ht{constructor(){this.dragging=d["default"](false)}view({attrs:{field:e,value:t}}){const{disabled:a,uiClass:n={},config:l}=e;return u["default"]("div",{class:w(n,a)},[u["default"](Fe,{field:e,defaultAccept:"image/*",dragging:this.dragging,onSet:Et(t,h("imageMaxSize",l)),value:t},u["default"](".w-100.pa1.dt.tc",{class:D(n,this.dragging(),Se(e,t()))},u["default"]("i.fa-2x.dtc.v-mid",{class:h("cameraIcn",l)}))),u["default"](".flex.flex-row.flex-wrap.mt1.nr1.nb1.nl1.max-h-thumb",r["default"].map(t(),e=>u["default"](Oe,{src:B(e.path,e.dataUrl)},u["default"](".absolute.top-0.right-0.child",u["default"](de,{title:`Remove ${e.name}`,icon:h("deleteIcn",l),onclick:Ue(t,e.guid)})))))])}}class Rt{constructor(){this.dragging=d["default"](false)}view({attrs:{field:e,value:t}}){const a=r["default"].head(t());const{disabled:n,uiClass:l={},config:i}=e;return u["default"]("div",{class:w(l,n)},u["default"](Fe,{field:e,defaultAccept:"image/*",multiple:false,dragging:this.dragging,onSet:Et(t,h("imageMaxSize",i),true),value:t},u["default"](".pa1",{class:D(l,this.dragging(),Se(e,t()))},u["default"](".relative.w-100.dt.tc",a?[u["default"]("img.img.contain.max-h-img",{title:a.name,src:B(a.path,a.dataUrl)}),u["default"](".absolute.top-0.right-0.pa1.pointer.dim",{title:`Remove ${a.name}`,onclick:Ue(t,a.guid)},u["default"]("i.pa1",{class:h("cancelIcn",i)}))]:u["default"]("i.fa-2x.dtc.v-mid",{class:h("cameraIcn",i)})))))}}class Wt{oncreate({dom:e}){const t=e.children[0];const a=A();this.signaturePad=new c["default"](t,{minWidth:.5*a,maxWidth:1.5*a});const n=()=>{const e=A();t.width=t.offsetWidth*e;t.height=t.offsetHeight*e;const a=t.getContext("2d");a.scale(e,e);this.resetCanvas()};this.resizeHandler=r["default"].debounce(n,250);window.addEventListener("resize",this.resizeHandler);window.addEventListener("orientationchange",this.resizeHandler);n()}onremove(){this.resizeHandler.cancel();window.removeEventListener("resize",this.resizeHandler);window.removeEventListener("orientationchange",this.resizeHandler)}view({attrs:{style:e,onSet:t,onCancel:a}}){return[u["default"](".aspect-ratio.bg-white.ba.bw1.br3.b--dashed.b--black-30",{style:e},u["default"]("canvas.aspect-ratio--object")),u["default"](".absolute.top-0.right-0.z-999.translate-up-100",[u["default"](de,{title:f.applyTtl,icon:f.applyIcn,classes:"ma1",onclick:()=>{if(!this.signaturePad.isEmpty()){t(this.signaturePad.toDataURL("image/png"))}}}),u["default"](de,{title:f.resetTtl,icon:f.resetIcn,classes:"ma1",onclick:()=>this.resetCanvas()}),u["default"](de,{title:f.cancelTtl,icon:f.cancelIcn,classes:"ma1",onclick:a})])]}resetCanvas(){this.signaturePad.clear()}}function Nt(e,t,a){return()=>{if(e()){a(re(e(),t),{text:e(),heightPct:t})}return false}}class zt{constructor(){this.text=d["default"]("")}oncreate({dom:e}){const t=e.children[0];t.focus({preventScroll:false});this.scaleText(e)}onupdate({dom:e}){this.scaleText(e)}view({attrs:{heightPct:e,style:t,onSet:a,onCancel:n}}){return[u["default"]("form.aspect-ratio.ba.bw1.br3.b--dashed.b--black-30",{style:t,onsubmit:Nt(this.text,e,a)},u["default"]("input.aspect-ratio--object.pa2.ba.bw0[type=text]",{oninput:N(this.text),style:{fontFamily:f.signFont},value:this.text()})),u["default"](".absolute.top-0.right-0.z-999.translate-up-100",[u["default"](de,{title:f.applyTtl,icon:f.applyIcn,classes:"ma1",onclick:Nt(this.text,e,a)}),u["default"](de,{title:f.resetTtl,icon:f.resetIcn,classes:"ma1",onclick:()=>this.text("")}),u["default"](de,{title:f.cancelTtl,icon:f.cancelIcn,classes:"ma1",onclick:n})])]}scaleText(e){const t=e.clientHeight;e.style.fontSize=`${.56*t}px`}}function jt(e,t,a){return()=>a(re(t,e),{text:t,heightPct:e})}class Vt{view({attrs:{heightPct:e,stampTxt:t,stampSetTxt:a,onSet:n}}){return[u["default"]("span.clip",{style:{fontFamily:f.signFont}},a),u["default"](".flex",u["default"](de,{label:t,classes:`flex-auto ${f.stampBtnClass}`,context:f.stampBtnContext,onclick:jt(e,a,n)}))]}}const _t={["draw"]:Wt,["type"]:zt,["stamp"]:Vt};function Yt(e,t,a){return(n,l)=>ie(n,a).then(a=>{e([Z(a,`sign-${t}.png`,l)]);u["default"].redraw()})}class Kt{oninit({attrs:{value:e}}){this.valUpdate=e.map(()=>this.setSignType())}onremove(){this.valUpdate.end()}view({attrs:{field:e,value:t}}){const{label:a,id:n,readonly:l,disabled:i,tabindex:s="0",uiClass:d={},config:c,options:o=h("signOpts",c),heightPct:f=h("signHeightPct",c),stampTxt:p=h("stampTxt",c),stampSetTxt:m=h("stampSetTxt",c)}=e;const b={paddingBottom:`${f}%`};const v=r["default"].head(t());const y=r["default"](o).map(({value:e})=>{if(e==="draw"){return{type:e,icon:h("drawIcn",c),label:h("signDrawTxt",c)}}else if(e==="type"){return{type:e,icon:h("typeIcn",c),label:h("signTypeTxt",c)}}else if(e==="stamp"){return{type:e,icon:h("stampIcn",c),label:h("signStampTxt",c)}}return null}).compact().value();if(y.length===1&&!v){this.setSignType(y[0].type)}return u["default"]("div.relative",{class:w(d,i)},[R(n,d,a),l||i?u["default"](".aspect-ratio",{id:n,style:b},v?u["default"](".aspect-ratio--object",{class:"pe-none"},u["default"]("img.img.w-100.absolute",{src:B(v.path,v.dataUrl)})):null):this.signType?u["default"](_t[this.signType],{heightPct:f,stampTxt:p,stampSetTxt:m,style:b,onSet:Yt(t,n,h("signMaxSize",c)),onCancel:r["default"].bind(this.setSignType,this,undefined)}):u["default"](".aspect-ratio.pointer",{id:n,class:g.fileInputWrapper,style:b},v?u["default"](".aspect-ratio--object.dim",{onclick:r["default"].bind(t,this,[])},[u["default"]("img.img.w-100.absolute",{src:B(v.path,v.dataUrl)}),u["default"](".pa3.absolute.top-0.right-0.child",u["default"]("i.fa-2x",{class:h("resetIcn",c),tabindex:0,onkeydown:_}))]):u["default"](".aspect-ratio--object.flex",r["default"].map(y,({type:e,icon:t,label:a})=>u["default"](".flex-auto.flex.items-center.justify-center.dim",{title:a,tabindex:s,onkeydown:_,onclick:r["default"].bind(this.setSignType,this,e)},u["default"]("i.fa-2x.ma1",{class:t}),u["default"]("span.ma1.dn.db-ns.truncate",a)))))])}setSignType(e){this.signType=e}}function Xt(e,t){return a=>{const n=t?[]:e();return Promise.all(r["default"].map(a,e=>{if(J(e.type)){return le(e,f.imageMaxSize,e.type).then(t=>{const a=X(K(t),e.name);n.push({guid:U(),name:a.name,path:"not_set",file:a,dataUrl:t})})}else{n.push({guid:U(),name:e.name,path:"not_set",file:e});return Promise.resolve()}})).then(()=>{e(n);u["default"].redraw()})}}class Zt{constructor(){this.dragging=d["default"](false)}view({attrs:{field:e,value:t}}){const a=r["default"].head(t());const{disabled:n,uiClass:l={},config:i}=e;return u["default"]("div",{class:w(l,n)},u["default"](Fe,{field:e,defaultAccept:"*",multiple:false,dragging:this.dragging,onSet:Xt(t,true),value:t},u["default"](".flex.items-center.pa1",{class:D(l,this.dragging(),Se(e,t()))},a?a.dataUrl?[u["default"](".relative.w-100.dt.tc",u["default"]("img.img.contain.max-h-img",{title:a.name,src:B(a.path,a.dataUrl)}),u["default"](".absolute.top-0.right-0.pa1.pointer.dim",{title:`Remove ${a.name}`,onclick:Ue(t,a.guid)},u["default"]("i.pa1",{class:h("cancelIcn",i)})))]:[u["default"](Me,a),u["default"]("span.ma1.flex-auto",{title:a.name},a.name),u["default"]("i.pa1.pointer.dim",{title:`Remove ${a.name}`,class:h("cancelIcn",i),onclick:Ue(t,a.guid),onkeydown:_,tabindex:0})]:[u["default"]("i.pa1",{class:h("uploadIcn",i)}),u["default"]("span.ma1",h("addFileTxt",i))])))}}class Gt{constructor(){this.dragging=d["default"](false)}view({attrs:{field:e,value:t,displayType:a,showDisplay:n=true}}){const{disabled:l,uiClass:i={},config:s}=e;return u["default"]("div",{class:w(i,l)},[u["default"](Fe,{field:e,defaultAccept:"*",dragging:this.dragging,onSet:Xt(t,false),value:t},u["default"](".flex.items-center.pa1.dt",{class:D(i,this.dragging(),Se(e,t()))},[u["default"]("i.pa1",{class:h("uploadIcn",s)}),u["default"]("span.ma1.flex-auto",h("addFileTxt",s))])),n?u["default"](Be,{displayType:a,value:t}):null])}}class Jt extends Fe{constructor(){super(...arguments);this.showLabel=false}}class Qt{constructor(){this.dragging=d["default"](false)}view({attrs:{field:e,value:t}}){const{id:a,required:n,uiClass:l={},config:i,label:s={text:"Add File",icon:h("uploadIcn",i)}}=e;return[R(a,l,s,n),u["default"]("div",{class:`${D(l,this.dragging(),Se(e,t()))} ${x()} ${g.button}`},u["default"](Jt,{field:e,multiple:false,dragging:this.dragging,onSet:Le(t,true),value:t},u["default"](".flex.items-center",typeof s==="string"?W({text:s,icon:h("uploadIcn",i)}):W(s))))]}}e.Badge=ue;e.BaseInput=tt;e.BaseText=he;e.Button=de;e.ButtonLink=ce;e.CardDateInput=Ct;e.Checkbox=we;e.CheckboxInput=Ut;e.CurrencyInput=at;e.DateInput=qt;e.DateText=me;e.DisplayTypeComponent=Be;e.FileButtonSelect=Qt;e.FileList=He;e.FileMulti=Ae;e.FileSelect=Bt;e.ImageList=Re;e.ImageMulti=Ht;e.ImagePreview=We;e.ImageSelect=Rt;e.Label=Ye;e.Link=ye;e.MultiOmniFileInput=Gt;e.NavButton=oe;e.NavLink=fe;e.OmniFileInput=Zt;e.PasswordInput=Pt;e.PasswordStrength=_e;e.PercentageInput=dt;e.RadioInput=Ot;e.SelectInput=Mt;e.SelectText=Ee;e.SignBuilder=Kt;e.TextareaInput=Lt;e.Toggle=Ie;e.ToggleInput=At;e.Trusted=pe;e.createStamp=re;e.currencyStrToNumber=it;e.dataURItoBlob=K;e.dataUrlToFile=Z;e.fileConstructor=X;e.fileNameExtSplit=Y;e.getOrientation=Q;e.guid=U;e.iconMap=be;e.linkAttrs=ge;e.linkIcon=ve;e.numberToCurrencyStr=st;e.numberToCurrencyTuple=rt;e.pxRatio=A;e.readArrayBuffer=ee;e.readOrientation=te;e.resizeImage=le;e.scaleDataUrl=ie;e.scaleRect=ne;e.textToImage=se;e.theme=g;e.updateButtonContext=y;e.updateClasses=b;e.updateConfig=p;Object.defineProperty(e,"__esModule",{value:true})}));
